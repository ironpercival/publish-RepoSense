[{"path":"kmaooad-functions/pom.xml","fileType":"xml","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"\u003c?xml version\u003d\"1.0\" encoding\u003d\"UTF-8\" ?\u003e"},{"lineNumber":2,"author":{"gitId":"-"},"content":"\u003cproject xmlns\u003d\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi\u003d\"http://www.w3.org/2001/XMLSchema-instance\""},{"lineNumber":3,"author":{"gitId":"-"},"content":"         xsi:schemaLocation\u003d\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"\u003e"},{"lineNumber":4,"author":{"gitId":"-"},"content":"    \u003cmodelVersion\u003e4.0.0\u003c/modelVersion\u003e"},{"lineNumber":5,"author":{"gitId":"-"},"content":""},{"lineNumber":6,"author":{"gitId":"-"},"content":"    \u003cgroupId\u003eedu.kmaooad\u003c/groupId\u003e"},{"lineNumber":7,"author":{"gitId":"-"},"content":"    \u003cartifactId\u003ekmaooad-functions\u003c/artifactId\u003e"},{"lineNumber":8,"author":{"gitId":"-"},"content":"    \u003cversion\u003e1.0-SNAPSHOT\u003c/version\u003e"},{"lineNumber":9,"author":{"gitId":"-"},"content":"    \u003cpackaging\u003ejar\u003c/packaging\u003e"},{"lineNumber":10,"author":{"gitId":"-"},"content":""},{"lineNumber":11,"author":{"gitId":"-"},"content":"    \u003cname\u003eAzure Java Functions\u003c/name\u003e"},{"lineNumber":12,"author":{"gitId":"-"},"content":""},{"lineNumber":13,"author":{"gitId":"-"},"content":"    \u003cparent\u003e"},{"lineNumber":14,"author":{"gitId":"-"},"content":"        \u003cgroupId\u003eorg.springframework.boot\u003c/groupId\u003e"},{"lineNumber":15,"author":{"gitId":"-"},"content":"        \u003cartifactId\u003espring-boot-starter-parent\u003c/artifactId\u003e"},{"lineNumber":16,"author":{"gitId":"-"},"content":"        \u003cversion\u003e2.6.6\u003c/version\u003e"},{"lineNumber":17,"author":{"gitId":"-"},"content":"        \u003crelativePath/\u003e \u003c!-- lookup parent from repository --\u003e"},{"lineNumber":18,"author":{"gitId":"-"},"content":"    \u003c/parent\u003e"},{"lineNumber":19,"author":{"gitId":"-"},"content":""},{"lineNumber":20,"author":{"gitId":"-"},"content":"    \u003cproperties\u003e"},{"lineNumber":21,"author":{"gitId":"-"},"content":"        \u003cproject.build.sourceEncoding\u003eUTF-8\u003c/project.build.sourceEncoding\u003e"},{"lineNumber":22,"author":{"gitId":"-"},"content":"        \u003cjava.version\u003e19\u003c/java.version\u003e"},{"lineNumber":23,"author":{"gitId":"-"},"content":"        \u003cazure.functions.maven.plugin.version\u003e1.20.0\u003c/azure.functions.maven.plugin.version\u003e"},{"lineNumber":24,"author":{"gitId":"-"},"content":"        \u003cazure.functions.java.library.version\u003e2.1.0\u003c/azure.functions.java.library.version\u003e"},{"lineNumber":25,"author":{"gitId":"-"},"content":"        \u003cfunctionAppName\u003ekmaooad-functions-20220927162321908\u003c/functionAppName\u003e"},{"lineNumber":26,"author":{"gitId":"-"},"content":"        \u003cstart-class\u003eedu.kmaooad.Application\u003c/start-class\u003e"},{"lineNumber":27,"author":{"gitId":"-"},"content":"    \u003c/properties\u003e"},{"lineNumber":28,"author":{"gitId":"-"},"content":""},{"lineNumber":29,"author":{"gitId":"-"},"content":"    \u003cdependencyManagement\u003e"},{"lineNumber":30,"author":{"gitId":"-"},"content":"        \u003cdependencies\u003e"},{"lineNumber":31,"author":{"gitId":"-"},"content":"            \u003cdependency\u003e"},{"lineNumber":32,"author":{"gitId":"-"},"content":"                \u003cgroupId\u003eorg.springframework.cloud\u003c/groupId\u003e"},{"lineNumber":33,"author":{"gitId":"-"},"content":"                \u003cartifactId\u003espring-cloud-function-dependencies\u003c/artifactId\u003e"},{"lineNumber":34,"author":{"gitId":"-"},"content":"                \u003cversion\u003e3.2.3\u003c/version\u003e"},{"lineNumber":35,"author":{"gitId":"-"},"content":"                \u003ctype\u003epom\u003c/type\u003e"},{"lineNumber":36,"author":{"gitId":"-"},"content":"                \u003cscope\u003eimport\u003c/scope\u003e"},{"lineNumber":37,"author":{"gitId":"-"},"content":"            \u003c/dependency\u003e"},{"lineNumber":38,"author":{"gitId":"-"},"content":"        \u003c/dependencies\u003e"},{"lineNumber":39,"author":{"gitId":"-"},"content":"    \u003c/dependencyManagement\u003e"},{"lineNumber":40,"author":{"gitId":"-"},"content":""},{"lineNumber":41,"author":{"gitId":"-"},"content":"    \u003cdependencies\u003e"},{"lineNumber":42,"author":{"gitId":"-"},"content":"        \u003c!--region Spring deps--\u003e"},{"lineNumber":43,"author":{"gitId":"-"},"content":"        \u003cdependency\u003e"},{"lineNumber":44,"author":{"gitId":"-"},"content":"            \u003cgroupId\u003eorg.springframework.cloud\u003c/groupId\u003e"},{"lineNumber":45,"author":{"gitId":"-"},"content":"            \u003cartifactId\u003espring-cloud-function-adapter-azure\u003c/artifactId\u003e"},{"lineNumber":46,"author":{"gitId":"-"},"content":"        \u003c/dependency\u003e"},{"lineNumber":47,"author":{"gitId":"-"},"content":""},{"lineNumber":48,"author":{"gitId":"-"},"content":"        \u003cdependency\u003e"},{"lineNumber":49,"author":{"gitId":"-"},"content":"            \u003cgroupId\u003eorg.springframework.cloud\u003c/groupId\u003e"},{"lineNumber":50,"author":{"gitId":"-"},"content":"            \u003cartifactId\u003espring-cloud-starter-function-webflux\u003c/artifactId\u003e"},{"lineNumber":51,"author":{"gitId":"-"},"content":"            \u003cscope\u003eprovided\u003c/scope\u003e"},{"lineNumber":52,"author":{"gitId":"-"},"content":"        \u003c/dependency\u003e"},{"lineNumber":53,"author":{"gitId":"-"},"content":""},{"lineNumber":54,"author":{"gitId":"-"},"content":"        \u003cdependency\u003e"},{"lineNumber":55,"author":{"gitId":"-"},"content":"            \u003cgroupId\u003eorg.springframework.boot\u003c/groupId\u003e"},{"lineNumber":56,"author":{"gitId":"-"},"content":"            \u003cartifactId\u003espring-boot-starter-data-mongodb\u003c/artifactId\u003e"},{"lineNumber":57,"author":{"gitId":"-"},"content":"            \u003cversion\u003e2.7.5\u003c/version\u003e"},{"lineNumber":58,"author":{"gitId":"-"},"content":"        \u003c/dependency\u003e"},{"lineNumber":59,"author":{"gitId":"-"},"content":"        \u003c!--endregion--\u003e"},{"lineNumber":60,"author":{"gitId":"-"},"content":""},{"lineNumber":61,"author":{"gitId":"-"},"content":"        \u003c!--region Azure deps--\u003e"},{"lineNumber":62,"author":{"gitId":"-"},"content":"        \u003cdependency\u003e"},{"lineNumber":63,"author":{"gitId":"-"},"content":"            \u003cgroupId\u003ecom.microsoft.azure.functions\u003c/groupId\u003e"},{"lineNumber":64,"author":{"gitId":"-"},"content":"            \u003cartifactId\u003eazure-functions-java-library\u003c/artifactId\u003e"},{"lineNumber":65,"author":{"gitId":"-"},"content":"            \u003cversion\u003e${azure.functions.java.library.version}\u003c/version\u003e"},{"lineNumber":66,"author":{"gitId":"-"},"content":"        \u003c/dependency\u003e"},{"lineNumber":67,"author":{"gitId":"-"},"content":"        \u003c!--endregion--\u003e"},{"lineNumber":68,"author":{"gitId":"-"},"content":""},{"lineNumber":69,"author":{"gitId":"-"},"content":"        \u003c!--region Util deps--\u003e"},{"lineNumber":70,"author":{"gitId":"VladKozyr"},"content":"        \u003cdependency\u003e"},{"lineNumber":71,"author":{"gitId":"VladKozyr"},"content":"            \u003cgroupId\u003eorg.telegram\u003c/groupId\u003e"},{"lineNumber":72,"author":{"gitId":"VladKozyr"},"content":"            \u003cartifactId\u003etelegrambots\u003c/artifactId\u003e"},{"lineNumber":73,"author":{"gitId":"VladKozyr"},"content":"            \u003cversion\u003e6.3.0\u003c/version\u003e"},{"lineNumber":74,"author":{"gitId":"VladKozyr"},"content":"        \u003c/dependency\u003e"},{"lineNumber":75,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":76,"author":{"gitId":"-"},"content":"        \u003cdependency\u003e"},{"lineNumber":77,"author":{"gitId":"-"},"content":"            \u003cgroupId\u003eorg.json\u003c/groupId\u003e"},{"lineNumber":78,"author":{"gitId":"-"},"content":"            \u003cartifactId\u003ejson\u003c/artifactId\u003e"},{"lineNumber":79,"author":{"gitId":"-"},"content":"            \u003cversion\u003e20220924\u003c/version\u003e"},{"lineNumber":80,"author":{"gitId":"-"},"content":"        \u003c/dependency\u003e"},{"lineNumber":81,"author":{"gitId":"-"},"content":""},{"lineNumber":82,"author":{"gitId":"-"},"content":"        \u003cdependency\u003e"},{"lineNumber":83,"author":{"gitId":"-"},"content":"            \u003cgroupId\u003eorg.projectlombok\u003c/groupId\u003e"},{"lineNumber":84,"author":{"gitId":"-"},"content":"            \u003cartifactId\u003elombok\u003c/artifactId\u003e"},{"lineNumber":85,"author":{"gitId":"-"},"content":"        \u003c/dependency\u003e"},{"lineNumber":86,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":87,"author":{"gitId":"Danylo Makarenko"},"content":"        \u003cdependency\u003e"},{"lineNumber":88,"author":{"gitId":"Danylo Makarenko"},"content":"            \u003cgroupId\u003ecom.opencsv\u003c/groupId\u003e"},{"lineNumber":89,"author":{"gitId":"Danylo Makarenko"},"content":"            \u003cartifactId\u003eopencsv\u003c/artifactId\u003e"},{"lineNumber":90,"author":{"gitId":"Danylo Makarenko"},"content":"            \u003cversion\u003e5.3\u003c/version\u003e"},{"lineNumber":91,"author":{"gitId":"Danylo Makarenko"},"content":"        \u003c/dependency\u003e"},{"lineNumber":92,"author":{"gitId":"-"},"content":"        \u003c!--endregion--\u003e"},{"lineNumber":93,"author":{"gitId":"-"},"content":""},{"lineNumber":94,"author":{"gitId":"-"},"content":"        \u003c!--region Test deps--\u003e"},{"lineNumber":95,"author":{"gitId":"-"},"content":"        \u003cdependency\u003e"},{"lineNumber":96,"author":{"gitId":"-"},"content":"            \u003cgroupId\u003eorg.junit.jupiter\u003c/groupId\u003e"},{"lineNumber":97,"author":{"gitId":"-"},"content":"            \u003cartifactId\u003ejunit-jupiter\u003c/artifactId\u003e"},{"lineNumber":98,"author":{"gitId":"-"},"content":"            \u003cversion\u003e5.9.0\u003c/version\u003e"},{"lineNumber":99,"author":{"gitId":"-"},"content":"            \u003cscope\u003etest\u003c/scope\u003e"},{"lineNumber":100,"author":{"gitId":"-"},"content":"        \u003c/dependency\u003e"},{"lineNumber":101,"author":{"gitId":"-"},"content":""},{"lineNumber":102,"author":{"gitId":"-"},"content":"        \u003cdependency\u003e"},{"lineNumber":103,"author":{"gitId":"-"},"content":"            \u003cgroupId\u003eorg.mockito\u003c/groupId\u003e"},{"lineNumber":104,"author":{"gitId":"-"},"content":"            \u003cartifactId\u003emockito-core\u003c/artifactId\u003e"},{"lineNumber":105,"author":{"gitId":"-"},"content":"            \u003cversion\u003e2.23.4\u003c/version\u003e"},{"lineNumber":106,"author":{"gitId":"-"},"content":"            \u003cscope\u003etest\u003c/scope\u003e"},{"lineNumber":107,"author":{"gitId":"-"},"content":"        \u003c/dependency\u003e"},{"lineNumber":108,"author":{"gitId":"-"},"content":""},{"lineNumber":109,"author":{"gitId":"-"},"content":"        \u003cdependency\u003e"},{"lineNumber":110,"author":{"gitId":"-"},"content":"            \u003cgroupId\u003eorg.springframework.boot\u003c/groupId\u003e"},{"lineNumber":111,"author":{"gitId":"-"},"content":"            \u003cartifactId\u003espring-boot-starter-test\u003c/artifactId\u003e"},{"lineNumber":112,"author":{"gitId":"-"},"content":"            \u003cversion\u003e2.7.5\u003c/version\u003e"},{"lineNumber":113,"author":{"gitId":"-"},"content":"            \u003cscope\u003etest\u003c/scope\u003e"},{"lineNumber":114,"author":{"gitId":"-"},"content":"        \u003c/dependency\u003e"},{"lineNumber":115,"author":{"gitId":"-"},"content":"        \u003c!--endregion--\u003e"},{"lineNumber":116,"author":{"gitId":"-"},"content":"    \u003c/dependencies\u003e"},{"lineNumber":117,"author":{"gitId":"-"},"content":""},{"lineNumber":118,"author":{"gitId":"-"},"content":"    \u003cbuild\u003e"},{"lineNumber":119,"author":{"gitId":"-"},"content":"        \u003cplugins\u003e"},{"lineNumber":120,"author":{"gitId":"-"},"content":"            \u003cplugin\u003e"},{"lineNumber":121,"author":{"gitId":"-"},"content":"                \u003cgroupId\u003eorg.apache.maven.plugins\u003c/groupId\u003e"},{"lineNumber":122,"author":{"gitId":"-"},"content":"                \u003cartifactId\u003emaven-compiler-plugin\u003c/artifactId\u003e"},{"lineNumber":123,"author":{"gitId":"-"},"content":"                \u003cversion\u003e3.8.1\u003c/version\u003e"},{"lineNumber":124,"author":{"gitId":"-"},"content":"                \u003cconfiguration\u003e"},{"lineNumber":125,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    \u003csource\u003e18\u003c/source\u003e"},{"lineNumber":126,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    \u003ctarget\u003e18\u003c/target\u003e"},{"lineNumber":127,"author":{"gitId":"-"},"content":"                    \u003cencoding\u003e${project.build.sourceEncoding}\u003c/encoding\u003e"},{"lineNumber":128,"author":{"gitId":"-"},"content":"                \u003c/configuration\u003e"},{"lineNumber":129,"author":{"gitId":"-"},"content":"            \u003c/plugin\u003e"},{"lineNumber":130,"author":{"gitId":"-"},"content":"            \u003cplugin\u003e"},{"lineNumber":131,"author":{"gitId":"-"},"content":"                \u003cgroupId\u003ecom.microsoft.azure\u003c/groupId\u003e"},{"lineNumber":132,"author":{"gitId":"-"},"content":"                \u003cartifactId\u003eazure-functions-maven-plugin\u003c/artifactId\u003e"},{"lineNumber":133,"author":{"gitId":"-"},"content":"                \u003cversion\u003e${azure.functions.maven.plugin.version}\u003c/version\u003e"},{"lineNumber":134,"author":{"gitId":"-"},"content":"                \u003cconfiguration\u003e"},{"lineNumber":135,"author":{"gitId":"-"},"content":"                    \u003c!-- function app name --\u003e"},{"lineNumber":136,"author":{"gitId":"-"},"content":"                    \u003cappName\u003e${functionAppName}\u003c/appName\u003e"},{"lineNumber":137,"author":{"gitId":"-"},"content":"                    \u003c!-- function app resource group --\u003e"},{"lineNumber":138,"author":{"gitId":"-"},"content":"                    \u003cresourceGroup\u003ejava-functions-group\u003c/resourceGroup\u003e"},{"lineNumber":139,"author":{"gitId":"-"},"content":"                    \u003c!-- function app service plan name --\u003e"},{"lineNumber":140,"author":{"gitId":"-"},"content":"                    \u003cappServicePlanName\u003ejava-functions-app-service-plan\u003c/appServicePlanName\u003e"},{"lineNumber":141,"author":{"gitId":"-"},"content":"                    \u003c!-- function app region--\u003e"},{"lineNumber":142,"author":{"gitId":"-"},"content":"                    \u003c!-- refers https://github.com/microsoft/azure-maven-plugins/wiki/Azure-Functions:-Configuration-Details#supported-regions for all valid values --\u003e"},{"lineNumber":143,"author":{"gitId":"-"},"content":"                    \u003cregion\u003ewestus\u003c/region\u003e"},{"lineNumber":144,"author":{"gitId":"-"},"content":"                    \u003c!-- function pricingTier, default to be consumption if not specified --\u003e"},{"lineNumber":145,"author":{"gitId":"-"},"content":"                    \u003c!-- refers https://github.com/microsoft/azure-maven-plugins/wiki/Azure-Functions:-Configuration-Details#supported-pricing-tiers for all valid values --\u003e"},{"lineNumber":146,"author":{"gitId":"-"},"content":"                    \u003c!-- \u003cpricingTier\u003e\u003c/pricingTier\u003e --\u003e"},{"lineNumber":147,"author":{"gitId":"-"},"content":"                    \u003c!-- Whether to disable application insights, default is false --\u003e"},{"lineNumber":148,"author":{"gitId":"-"},"content":"                    \u003c!-- refers https://github.com/microsoft/azure-maven-plugins/wiki/Azure-Functions:-Configuration-Details for all valid configurations for application insights--\u003e"},{"lineNumber":149,"author":{"gitId":"-"},"content":"                    \u003c!-- \u003cdisableAppInsights\u003e\u003c/disableAppInsights\u003e --\u003e"},{"lineNumber":150,"author":{"gitId":"-"},"content":"                    \u003cruntime\u003e"},{"lineNumber":151,"author":{"gitId":"-"},"content":"                        \u003c!-- runtime os, could be windows, linux or docker--\u003e"},{"lineNumber":152,"author":{"gitId":"-"},"content":"                        \u003cos\u003ewindows\u003c/os\u003e"},{"lineNumber":153,"author":{"gitId":"-"},"content":"                        \u003cjavaVersion\u003e19\u003c/javaVersion\u003e"},{"lineNumber":154,"author":{"gitId":"-"},"content":"                    \u003c/runtime\u003e"},{"lineNumber":155,"author":{"gitId":"-"},"content":"                    \u003cappSettings\u003e"},{"lineNumber":156,"author":{"gitId":"-"},"content":"                        \u003cproperty\u003e"},{"lineNumber":157,"author":{"gitId":"-"},"content":"                            \u003cname\u003eFUNCTIONS_EXTENSION_VERSION\u003c/name\u003e"},{"lineNumber":158,"author":{"gitId":"-"},"content":"                            \u003cvalue\u003e~4\u003c/value\u003e"},{"lineNumber":159,"author":{"gitId":"-"},"content":"                        \u003c/property\u003e"},{"lineNumber":160,"author":{"gitId":"-"},"content":"                    \u003c/appSettings\u003e"},{"lineNumber":161,"author":{"gitId":"-"},"content":"                \u003c/configuration\u003e"},{"lineNumber":162,"author":{"gitId":"-"},"content":"                \u003cexecutions\u003e"},{"lineNumber":163,"author":{"gitId":"-"},"content":"                    \u003cexecution\u003e"},{"lineNumber":164,"author":{"gitId":"-"},"content":"                        \u003cid\u003epackage-functions\u003c/id\u003e"},{"lineNumber":165,"author":{"gitId":"-"},"content":"                        \u003cgoals\u003e"},{"lineNumber":166,"author":{"gitId":"-"},"content":"                            \u003cgoal\u003epackage\u003c/goal\u003e"},{"lineNumber":167,"author":{"gitId":"-"},"content":"                        \u003c/goals\u003e"},{"lineNumber":168,"author":{"gitId":"-"},"content":"                    \u003c/execution\u003e"},{"lineNumber":169,"author":{"gitId":"-"},"content":"                \u003c/executions\u003e"},{"lineNumber":170,"author":{"gitId":"-"},"content":"            \u003c/plugin\u003e"},{"lineNumber":171,"author":{"gitId":"-"},"content":"            \u003cplugin\u003e"},{"lineNumber":172,"author":{"gitId":"-"},"content":"                \u003cgroupId\u003eorg.jacoco\u003c/groupId\u003e"},{"lineNumber":173,"author":{"gitId":"-"},"content":"                \u003cartifactId\u003ejacoco-maven-plugin\u003c/artifactId\u003e"},{"lineNumber":174,"author":{"gitId":"-"},"content":"                \u003cversion\u003e0.8.8\u003c/version\u003e"},{"lineNumber":175,"author":{"gitId":"-"},"content":"                \u003cexecutions\u003e"},{"lineNumber":176,"author":{"gitId":"-"},"content":"                    \u003cexecution\u003e"},{"lineNumber":177,"author":{"gitId":"-"},"content":"                        \u003cid\u003eprepare-agent\u003c/id\u003e"},{"lineNumber":178,"author":{"gitId":"-"},"content":"                        \u003cgoals\u003e"},{"lineNumber":179,"author":{"gitId":"-"},"content":"                            \u003cgoal\u003eprepare-agent\u003c/goal\u003e"},{"lineNumber":180,"author":{"gitId":"-"},"content":"                        \u003c/goals\u003e"},{"lineNumber":181,"author":{"gitId":"-"},"content":"                    \u003c/execution\u003e"},{"lineNumber":182,"author":{"gitId":"-"},"content":"                    \u003cexecution\u003e"},{"lineNumber":183,"author":{"gitId":"-"},"content":"                        \u003cid\u003ereport\u003c/id\u003e"},{"lineNumber":184,"author":{"gitId":"-"},"content":"                        \u003cphase\u003etest\u003c/phase\u003e"},{"lineNumber":185,"author":{"gitId":"-"},"content":"                        \u003cgoals\u003e"},{"lineNumber":186,"author":{"gitId":"-"},"content":"                            \u003cgoal\u003ereport\u003c/goal\u003e"},{"lineNumber":187,"author":{"gitId":"-"},"content":"                        \u003c/goals\u003e"},{"lineNumber":188,"author":{"gitId":"-"},"content":"                    \u003c/execution\u003e"},{"lineNumber":189,"author":{"gitId":"-"},"content":"                \u003c/executions\u003e"},{"lineNumber":190,"author":{"gitId":"-"},"content":"            \u003c/plugin\u003e"},{"lineNumber":191,"author":{"gitId":"-"},"content":"            \u003cplugin\u003e"},{"lineNumber":192,"author":{"gitId":"-"},"content":"                \u003cgroupId\u003eorg.apache.maven.plugins\u003c/groupId\u003e"},{"lineNumber":193,"author":{"gitId":"-"},"content":"                \u003cartifactId\u003emaven-surefire-plugin\u003c/artifactId\u003e"},{"lineNumber":194,"author":{"gitId":"-"},"content":"                \u003cversion\u003e3.0.0-M7\u003c/version\u003e"},{"lineNumber":195,"author":{"gitId":"-"},"content":"                \u003cconfiguration\u003e"},{"lineNumber":196,"author":{"gitId":"-"},"content":"                    \u003cfailIfNoTests\u003etrue\u003c/failIfNoTests\u003e"},{"lineNumber":197,"author":{"gitId":"-"},"content":"                \u003c/configuration\u003e"},{"lineNumber":198,"author":{"gitId":"-"},"content":"            \u003c/plugin\u003e"},{"lineNumber":199,"author":{"gitId":"-"},"content":"            \u003c!--Remove obj folder generated by .NET SDK in maven clean--\u003e"},{"lineNumber":200,"author":{"gitId":"-"},"content":"            \u003cplugin\u003e"},{"lineNumber":201,"author":{"gitId":"-"},"content":"                \u003cgroupId\u003eorg.apache.maven.plugins\u003c/groupId\u003e"},{"lineNumber":202,"author":{"gitId":"-"},"content":"                \u003cartifactId\u003emaven-clean-plugin\u003c/artifactId\u003e"},{"lineNumber":203,"author":{"gitId":"-"},"content":"                \u003cversion\u003e3.2.0\u003c/version\u003e"},{"lineNumber":204,"author":{"gitId":"-"},"content":"                \u003cconfiguration\u003e"},{"lineNumber":205,"author":{"gitId":"-"},"content":"                    \u003cfilesets\u003e"},{"lineNumber":206,"author":{"gitId":"-"},"content":"                        \u003cfileset\u003e"},{"lineNumber":207,"author":{"gitId":"-"},"content":"                            \u003cdirectory\u003eobj\u003c/directory\u003e"},{"lineNumber":208,"author":{"gitId":"-"},"content":"                        \u003c/fileset\u003e"},{"lineNumber":209,"author":{"gitId":"-"},"content":"                    \u003c/filesets\u003e"},{"lineNumber":210,"author":{"gitId":"-"},"content":"                \u003c/configuration\u003e"},{"lineNumber":211,"author":{"gitId":"-"},"content":"            \u003c/plugin\u003e"},{"lineNumber":212,"author":{"gitId":"-"},"content":""},{"lineNumber":213,"author":{"gitId":"-"},"content":"            \u003cplugin\u003e"},{"lineNumber":214,"author":{"gitId":"-"},"content":"                \u003cgroupId\u003eorg.springframework.boot\u003c/groupId\u003e"},{"lineNumber":215,"author":{"gitId":"-"},"content":"                \u003cartifactId\u003espring-boot-maven-plugin\u003c/artifactId\u003e"},{"lineNumber":216,"author":{"gitId":"-"},"content":"                \u003cversion\u003e2.7.5\u003c/version\u003e"},{"lineNumber":217,"author":{"gitId":"-"},"content":"            \u003c/plugin\u003e"},{"lineNumber":218,"author":{"gitId":"-"},"content":"        \u003c/plugins\u003e"},{"lineNumber":219,"author":{"gitId":"-"},"content":"    \u003c/build\u003e"},{"lineNumber":220,"author":{"gitId":"-"},"content":""},{"lineNumber":221,"author":{"gitId":"-"},"content":"    \u003crepositories\u003e"},{"lineNumber":222,"author":{"gitId":"-"},"content":"        \u003crepository\u003e"},{"lineNumber":223,"author":{"gitId":"-"},"content":"            \u003cid\u003espring-snapshots\u003c/id\u003e"},{"lineNumber":224,"author":{"gitId":"-"},"content":"            \u003cname\u003eSpring Snapshots\u003c/name\u003e"},{"lineNumber":225,"author":{"gitId":"-"},"content":"            \u003curl\u003ehttps://repo.spring.io/libs-snapshot-local\u003c/url\u003e"},{"lineNumber":226,"author":{"gitId":"-"},"content":"            \u003csnapshots\u003e"},{"lineNumber":227,"author":{"gitId":"-"},"content":"                \u003cenabled\u003etrue\u003c/enabled\u003e"},{"lineNumber":228,"author":{"gitId":"-"},"content":"            \u003c/snapshots\u003e"},{"lineNumber":229,"author":{"gitId":"-"},"content":"            \u003creleases\u003e"},{"lineNumber":230,"author":{"gitId":"-"},"content":"                \u003cenabled\u003efalse\u003c/enabled\u003e"},{"lineNumber":231,"author":{"gitId":"-"},"content":"            \u003c/releases\u003e"},{"lineNumber":232,"author":{"gitId":"-"},"content":"        \u003c/repository\u003e"},{"lineNumber":233,"author":{"gitId":"-"},"content":"        \u003crepository\u003e"},{"lineNumber":234,"author":{"gitId":"-"},"content":"            \u003cid\u003espring-milestones\u003c/id\u003e"},{"lineNumber":235,"author":{"gitId":"-"},"content":"            \u003cname\u003eSpring Milestones\u003c/name\u003e"},{"lineNumber":236,"author":{"gitId":"-"},"content":"            \u003curl\u003ehttps://repo.spring.io/libs-milestone-local\u003c/url\u003e"},{"lineNumber":237,"author":{"gitId":"-"},"content":"            \u003csnapshots\u003e"},{"lineNumber":238,"author":{"gitId":"-"},"content":"                \u003cenabled\u003efalse\u003c/enabled\u003e"},{"lineNumber":239,"author":{"gitId":"-"},"content":"            \u003c/snapshots\u003e"},{"lineNumber":240,"author":{"gitId":"-"},"content":"        \u003c/repository\u003e"},{"lineNumber":241,"author":{"gitId":"-"},"content":"        \u003crepository\u003e"},{"lineNumber":242,"author":{"gitId":"-"},"content":"            \u003cid\u003espring-releases\u003c/id\u003e"},{"lineNumber":243,"author":{"gitId":"-"},"content":"            \u003cname\u003eSpring Releases\u003c/name\u003e"},{"lineNumber":244,"author":{"gitId":"-"},"content":"            \u003curl\u003ehttps://repo.spring.io/release\u003c/url\u003e"},{"lineNumber":245,"author":{"gitId":"-"},"content":"            \u003csnapshots\u003e"},{"lineNumber":246,"author":{"gitId":"-"},"content":"                \u003cenabled\u003efalse\u003c/enabled\u003e"},{"lineNumber":247,"author":{"gitId":"-"},"content":"            \u003c/snapshots\u003e"},{"lineNumber":248,"author":{"gitId":"-"},"content":"        \u003c/repository\u003e"},{"lineNumber":249,"author":{"gitId":"-"},"content":"    \u003c/repositories\u003e"},{"lineNumber":250,"author":{"gitId":"-"},"content":"\u003c/project\u003e"}],"authorContributionMap":{"VladKozyr":6,"Dmytro Zhornyk":2,"-":236,"Danylo Makarenko":6}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/Application.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"package edu.kmaooad;"},{"lineNumber":2,"author":{"gitId":"-"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.Dispatcher;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.session.ISessionService;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"-"},"content":"import org.springframework.boot.SpringApplication;"},{"lineNumber":7,"author":{"gitId":"-"},"content":"import org.springframework.boot.autoconfigure.SpringBootApplication;"},{"lineNumber":8,"author":{"gitId":"-"},"content":"import org.springframework.context.annotation.Bean;"},{"lineNumber":9,"author":{"gitId":"-"},"content":""},{"lineNumber":10,"author":{"gitId":"-"},"content":"@SpringBootApplication"},{"lineNumber":11,"author":{"gitId":"-"},"content":"public class Application {"},{"lineNumber":12,"author":{"gitId":"-"},"content":""},{"lineNumber":13,"author":{"gitId":"-"},"content":"    public static void main(String[] args) {"},{"lineNumber":14,"author":{"gitId":"-"},"content":"        SpringApplication.run(Application.class, args);"},{"lineNumber":15,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":"    @Bean"},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":"    public Dispatcher dispatcher(StateMachine stateMachine, ISessionService sessionService) {"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":"        return new Dispatcher(stateMachine, sessionService);"},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":21,"author":{"gitId":"-"},"content":"}"}],"authorContributionMap":{"VladKozyr":8,"-":13}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/MongoMapKeyDotReplacementConfiguration.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.beans.factory.annotation.Autowired;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.context.annotation.Configuration;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.data.mongodb.core.convert.MappingMongoConverter;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"@Configuration"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"public class MongoMapKeyDotReplacementConfiguration {"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"    @Autowired"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"    public void setMapKeyDotReplacement(MappingMongoConverter mongoConverter) {"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"        mongoConverter.setMapKeyDotReplacement(\"#\");"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":14}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/TelegramWebhook.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"package edu.kmaooad;"},{"lineNumber":2,"author":{"gitId":"-"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.Dispatcher;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":5,"author":{"gitId":"-"},"content":"import edu.kmaooad.dto.BotUpdateResult;"},{"lineNumber":6,"author":{"gitId":"-"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.Update;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.webapp.WebAppData;"},{"lineNumber":11,"author":{"gitId":"-"},"content":""},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"import java.util.List;"},{"lineNumber":13,"author":{"gitId":"-"},"content":"import java.util.function.Function;"},{"lineNumber":14,"author":{"gitId":"-"},"content":""},{"lineNumber":15,"author":{"gitId":"-"},"content":"@Component"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":"public class TelegramWebhook implements Function\u003cUpdate, BotUpdateResult\u003e {"},{"lineNumber":17,"author":{"gitId":"-"},"content":""},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":"    private final Dispatcher dispatcher;"},{"lineNumber":19,"author":{"gitId":"-"},"content":""},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"    public TelegramWebhook(Dispatcher dispatcher, List\u003cHandler\u003e handlers) {"},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":"        this.dispatcher \u003d dispatcher;"},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":"        handlers.forEach(dispatcher::registerHandler);"},{"lineNumber":24,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":25,"author":{"gitId":"-"},"content":""},{"lineNumber":26,"author":{"gitId":"-"},"content":"    @Override"},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":"    public BotUpdateResult apply(Update update) {"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":"        if (update \u003d\u003d null) {"},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return BotUpdateResult.Error(emptyUpdateMessage());"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":31,"author":{"gitId":"-"},"content":""},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":"        if (update.hasMessage()) {"},{"lineNumber":33,"author":{"gitId":"VladKozyr"},"content":"            Message message \u003d update.getMessage();"},{"lineNumber":34,"author":{"gitId":"VladKozyr"},"content":"            dispatcher.dispatch(message);"},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":"            return BotUpdateResult.Ok(message.getMessageId());"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":37,"author":{"gitId":"-"},"content":""},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"        if (update.hasCallbackQuery()) {"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"            CallbackQuery callbackQuery \u003d update.getCallbackQuery();"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":"            dispatcher.dispatch(callbackQuery);"},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return BotUpdateResult.Ok(callbackQuery.getMessage().getMessageId());"},{"lineNumber":42,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":44,"author":{"gitId":"VladKozyr"},"content":"        return BotUpdateResult.Error(emptyUpdateMessage());"},{"lineNumber":45,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":46,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":47,"author":{"gitId":"VladKozyr"},"content":"    static String emptyUpdateMessage() {"},{"lineNumber":48,"author":{"gitId":"VladKozyr"},"content":"        return \"Empty update\";"},{"lineNumber":49,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":50,"author":{"gitId":"-"},"content":"}"}],"authorContributionMap":{"VladKozyr":19,"Dmytro Zhornyk":12,"-":19}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/TelegramWebhookHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"package edu.kmaooad;"},{"lineNumber":2,"author":{"gitId":"-"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":4,"author":{"gitId":"-"},"content":"import com.microsoft.azure.functions.*;"},{"lineNumber":5,"author":{"gitId":"-"},"content":"import com.microsoft.azure.functions.annotation.AuthorizationLevel;"},{"lineNumber":6,"author":{"gitId":"-"},"content":"import com.microsoft.azure.functions.annotation.FunctionName;"},{"lineNumber":7,"author":{"gitId":"-"},"content":"import com.microsoft.azure.functions.annotation.HttpTrigger;"},{"lineNumber":8,"author":{"gitId":"-"},"content":"import edu.kmaooad.dto.BotUpdateResult;"},{"lineNumber":9,"author":{"gitId":"-"},"content":"import edu.kmaooad.exception.EmptyRequestBodyException;"},{"lineNumber":10,"author":{"gitId":"-"},"content":"import org.springframework.cloud.function.adapter.azure.FunctionInvoker;"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.Update;"},{"lineNumber":12,"author":{"gitId":"-"},"content":""},{"lineNumber":13,"author":{"gitId":"-"},"content":"import java.util.Optional;"},{"lineNumber":14,"author":{"gitId":"-"},"content":""},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":"public class TelegramWebhookHandler extends FunctionInvoker\u003cUpdate, BotUpdateResult\u003e {"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":17,"author":{"gitId":"-"},"content":""},{"lineNumber":18,"author":{"gitId":"-"},"content":"    @FunctionName(\"TelegramWebhook\")"},{"lineNumber":19,"author":{"gitId":"-"},"content":"    public HttpResponseMessage run("},{"lineNumber":20,"author":{"gitId":"-"},"content":"            @HttpTrigger("},{"lineNumber":21,"author":{"gitId":"-"},"content":"                    name \u003d \"req\","},{"lineNumber":22,"author":{"gitId":"-"},"content":"                    methods \u003d {HttpMethod.POST},"},{"lineNumber":23,"author":{"gitId":"-"},"content":"                    authLevel \u003d AuthorizationLevel.FUNCTION)"},{"lineNumber":24,"author":{"gitId":"-"},"content":"            HttpRequestMessage\u003cOptional\u003cString\u003e\u003e request,"},{"lineNumber":25,"author":{"gitId":"-"},"content":"            final ExecutionContext context) {"},{"lineNumber":26,"author":{"gitId":"-"},"content":""},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":"        Update update;"},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":"        BotUpdateResult result;"},{"lineNumber":29,"author":{"gitId":"-"},"content":""},{"lineNumber":30,"author":{"gitId":"-"},"content":"        try {"},{"lineNumber":31,"author":{"gitId":"VladKozyr"},"content":"            final String body \u003d request"},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":"                    .getBody()"},{"lineNumber":33,"author":{"gitId":"VladKozyr"},"content":"                    .orElseThrow(EmptyRequestBodyException::new);"},{"lineNumber":34,"author":{"gitId":"-"},"content":""},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":"            final ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":36,"author":{"gitId":"VladKozyr"},"content":"            update \u003d mapper.readValue(body, Update.class);"},{"lineNumber":37,"author":{"gitId":"VladKozyr"},"content":"            result \u003d handleRequest(update, context);"},{"lineNumber":38,"author":{"gitId":"VladKozyr"},"content":"        } catch (Exception exception) {"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"            System.err.println(exception.getMessage());"},{"lineNumber":40,"author":{"gitId":"-"},"content":""},{"lineNumber":41,"author":{"gitId":"VladKozyr"},"content":"            result \u003d BotUpdateResult.Error(exception.getMessage());"},{"lineNumber":42,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":43,"author":{"gitId":"-"},"content":""},{"lineNumber":44,"author":{"gitId":"-"},"content":"        if (result.errorMessage() \u003d\u003d null)"},{"lineNumber":45,"author":{"gitId":"-"},"content":"            return request"},{"lineNumber":46,"author":{"gitId":"-"},"content":"                    .createResponseBuilder(HttpStatus.OK)"},{"lineNumber":47,"author":{"gitId":"-"},"content":"                    .body(result.messageId())"},{"lineNumber":48,"author":{"gitId":"-"},"content":"                    .build();"},{"lineNumber":49,"author":{"gitId":"-"},"content":"        else"},{"lineNumber":50,"author":{"gitId":"-"},"content":"            return request"},{"lineNumber":51,"author":{"gitId":"-"},"content":"                    .createResponseBuilder(HttpStatus.BAD_REQUEST)"},{"lineNumber":52,"author":{"gitId":"-"},"content":"                    .body(result.errorMessage())"},{"lineNumber":53,"author":{"gitId":"-"},"content":"                    .build();"},{"lineNumber":54,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":55,"author":{"gitId":"-"},"content":"}"}],"authorContributionMap":{"VladKozyr":14,"Dmytro Zhornyk":1,"-":40}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/StateMachineImpl.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.app;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.session.ISessionService;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.exception.IncorrectIdException;"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"import java.util.Optional;"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":"@Component"},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":"public class StateMachineImpl implements StateMachine {"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":"    private final ISessionService sessionService;"},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":"    public StateMachineImpl(ISessionService sessionService) {"},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"        this.sessionService \u003d sessionService;"},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":"    public void updateStateData(Long userId, State.Group group, Object obj) throws StateMachineException {"},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":"        try {"},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":"            String payloadString \u003d new ObjectMapper().writeValueAsString(obj);"},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":"            sessionService.updateGroupStatePayload(userId, group, payloadString);"},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":"        } catch (JsonProcessingException | IncorrectIdException exception) {"},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":"            throw new StateMachineException(exception.getMessage());"},{"lineNumber":31,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":33,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":34,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":"    public \u003cPAYLOAD\u003e Optional\u003cPAYLOAD\u003e getStatePayload(Long userId, State.Group group, Class\u003cPAYLOAD\u003e payloadClass) {"},{"lineNumber":36,"author":{"gitId":"VladKozyr"},"content":"        try {"},{"lineNumber":37,"author":{"gitId":"VladKozyr"},"content":"            String payload \u003d sessionService.getGroupStatePayload(userId, group);"},{"lineNumber":38,"author":{"gitId":"VladKozyr"},"content":"            ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":39,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":40,"author":{"gitId":"VladKozyr"},"content":"            return Optional.of(mapper.readValue(payload, payloadClass));"},{"lineNumber":41,"author":{"gitId":"VladKozyr"},"content":"        } catch (JsonProcessingException | IncorrectIdException | IllegalArgumentException exception) {"},{"lineNumber":42,"author":{"gitId":"VladKozyr"},"content":"            return Optional.empty();"},{"lineNumber":43,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":44,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":45,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":46,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":47,"author":{"gitId":"VladKozyr"},"content":"    public void setState(Long userId, State state) throws StateMachineException {"},{"lineNumber":48,"author":{"gitId":"VladKozyr"},"content":"        try {"},{"lineNumber":49,"author":{"gitId":"VladKozyr"},"content":"            sessionService.updateSessionState(userId, state);"},{"lineNumber":50,"author":{"gitId":"VladKozyr"},"content":"        } catch (IncorrectIdException e) {"},{"lineNumber":51,"author":{"gitId":"VladKozyr"},"content":"            throw new StateMachineException(e.getMessage());"},{"lineNumber":52,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":53,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":54,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":54}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/Utils.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.model.CourseEntity;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.InlineKeyboardMarkup;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.buttons.InlineKeyboardButton;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.*;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class Utils {"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public static InlineKeyboardMarkup getActivitiesKeyboard(List\u003cActivityEntity\u003e entities) {"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"        List\u003cList\u003cInlineKeyboardButton\u003e\u003e rows \u003d entities.stream().map(entity -\u003e {"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"            InlineKeyboardButton btn \u003d new InlineKeyboardButton();"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":"            btn.setText(entity.getTitle() + \" \" + entity.getDate() + \" \" + entity.getTime());"},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"            btn.setCallbackData(entity.getId());"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return List.of(btn);"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }).toList();"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return new InlineKeyboardMarkup(rows);"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":22,"author":{"gitId":"Danylo Makarenko"},"content":"    public static InlineKeyboardMarkup getCoursesKeyboard(List\u003cCourseEntity\u003e entities) {"},{"lineNumber":23,"author":{"gitId":"Danylo Makarenko"},"content":"        List\u003cList\u003cInlineKeyboardButton\u003e\u003e rows \u003d entities.stream().map(entity -\u003e {"},{"lineNumber":24,"author":{"gitId":"Danylo Makarenko"},"content":"            InlineKeyboardButton btn \u003d new InlineKeyboardButton();"},{"lineNumber":25,"author":{"gitId":"Danylo Makarenko"},"content":"            btn.setText(\"| \" + entity.getTitle() + \" | \" + entity.getDescription() + \" |\");"},{"lineNumber":26,"author":{"gitId":"Danylo Makarenko"},"content":"            btn.setCallbackData(entity.getId());"},{"lineNumber":27,"author":{"gitId":"Danylo Makarenko"},"content":"            return List.of(btn);"},{"lineNumber":28,"author":{"gitId":"Danylo Makarenko"},"content":"        }).toList();"},{"lineNumber":29,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":30,"author":{"gitId":"Danylo Makarenko"},"content":"        return new InlineKeyboardMarkup(rows);"},{"lineNumber":31,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":32,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public static InlineKeyboardMarkup getKeyboardFromDict(HashMap\u003cString, String\u003e map) {"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"        List\u003cList\u003cInlineKeyboardButton\u003e\u003e rows \u003d map.entrySet().stream().map(entry -\u003e {"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"            InlineKeyboardButton btn \u003d new InlineKeyboardButton();"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"            btn.setText(entry.getKey());"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"            btn.setCallbackData(entry.getValue());"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return List.of(btn);"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }).toList();"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return new InlineKeyboardMarkup(rows);"},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Dmytro Zhornyk":31,"Danylo Makarenko":12}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/create/ActivityCreate.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.create;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"public enum ActivityCreate implements State, State.Group {"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"    GROUP, GET_TITLE, GET_DESCRIPTION, GET_DATE, GET_TIME, GET_LOCATION;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public String key() {"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return getClass().getName() + \".\" + name();"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Dmytro Zhornyk":13}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/create/ActivityCreateGetDate.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.create;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.ActivityDto;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Component"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityCreateGetDate implements Handler {"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService;"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public ActivityCreateGetDate(TelegramService telegramService) {"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"            if (!message.getText().matches(\"\\\\d{2}\\\\.\\\\d{2}\\\\.\\\\d{2}\")) {"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":"                telegramService.sendMessage(message.getChatId(), \"Date format is incorrect. Please, try again\");"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"                return;"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"            }"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"            ActivityDto payload \u003d stateMachine"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    .getStatePayload(message.getChatId(), ActivityCreate.GROUP, ActivityDto.class)"},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    .orElseThrow();"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"            payload.setDate(message.getText());"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.updateStateData(message.getChatId(), ActivityCreate.GROUP, payload);"},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.setState(message.getChatId(), ActivityCreate.GET_TIME);"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Enter the activity time in hh:mm format\");"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (Exception exception) {"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"            System.err.println(exception.getMessage());"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Activity data wasn\u0027t saved. Error occurred\");"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public State getState() {"},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return ActivityCreate.GET_DATE;"},{"lineNumber":44,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":45,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"},{"lineNumber":46,"author":{"gitId":"Dmytro Zhornyk"},"content":""}],"authorContributionMap":{"Dmytro Zhornyk":46}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/create/ActivityCreateGetDescription.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.create;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.ActivityDto;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Component"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityCreateGetDescription implements Handler {"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService;"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public ActivityCreateGetDescription(TelegramService telegramService) {"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"            ActivityDto payload \u003d stateMachine"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    .getStatePayload(message.getChatId(), ActivityCreate.GROUP, ActivityDto.class)"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    .orElseThrow();"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"            payload.setDescription(message.getText());"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.updateStateData(message.getChatId(), ActivityCreate.GROUP, payload);"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.setState(message.getChatId(), ActivityCreate.GET_DATE);"},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Enter the activity date in dd.mm.yy format\");"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (Exception exception) {"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":"            System.err.println(exception.getMessage());"},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Activity data wasn\u0027t saved. Error occurred\");"},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public State getState() {"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return ActivityCreate.GET_DESCRIPTION;"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":""}],"authorContributionMap":{"Dmytro Zhornyk":41}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/create/ActivityCreateGetLocation.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.create;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.ActivityDto;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Component"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityCreateGetLocation implements Handler {"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService;"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityService activityService;"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public ActivityCreateGetLocation(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":"            ActivityDto payload \u003d stateMachine"},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    .getStatePayload(message.getChatId(), ActivityCreate.GROUP, ActivityDto.class)"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    .orElseThrow();"},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"            payload.setLocation(message.getText());"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":"            activityService.createActivity(payload);"},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.setState(message.getChatId(), new State.Any());"},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Activity successfully saved\");"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (Exception exception) {"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Activity data wasn\u0027t saved. Error occurred\");"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public State getState() {"},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return ActivityCreate.GET_LOCATION;"},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Dmytro Zhornyk":43}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/create/ActivityCreateGetTime.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.create;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.ActivityDto;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Component"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityCreateGetTime implements Handler {"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService;"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public ActivityCreateGetTime(TelegramService telegramService) {"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"            if (!message.getText().matches(\"\\\\d{2}:\\\\d{2}\")) {"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":"                telegramService.sendMessage(message.getChatId(), \"Time format is incorrect. Please, try again\");"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"                return;"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"            }"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"            ActivityDto payload \u003d stateMachine"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    .getStatePayload(message.getChatId(), ActivityCreate.GROUP, ActivityDto.class)"},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    .orElseThrow();"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"            payload.setTime(message.getText());"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.updateStateData(message.getChatId(), ActivityCreate.GROUP, payload);"},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.setState(message.getChatId(), ActivityCreate.GET_LOCATION);"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Enter the activity location\");"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (Exception exception) {"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"            System.err.println(exception.getMessage());"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Activity data wasn\u0027t saved. Error occurred\");"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public State getState() {"},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return ActivityCreate.GET_TIME;"},{"lineNumber":44,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":45,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"},{"lineNumber":46,"author":{"gitId":"Dmytro Zhornyk"},"content":""}],"authorContributionMap":{"Dmytro Zhornyk":46}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/create/ActivityCreateGetTitle.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.create;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.ActivityDto;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Component"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityCreateGetTitle implements Handler {"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService;"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public ActivityCreateGetTitle(TelegramService telegramService) {"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"            ActivityDto payload \u003d new ActivityDto();"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":"            payload.setTitle(message.getText());"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"            payload.setOwnerId(message.getFrom().getId().toString());"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.updateStateData(message.getChatId(), ActivityCreate.GROUP, payload);"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.setState(message.getChatId(), ActivityCreate.GET_DESCRIPTION);"},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Enter the activity description\");"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (Exception exception) {"},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"            System.err.println(exception.getMessage());"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Activity data wasn\u0027t saved. Error occurred\");"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public State getState() {"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return ActivityCreate.GET_TITLE;"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Dmytro Zhornyk":38}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/create/ActivityCreateHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.create;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.List;"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Component"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityCreateHandler implements Handler {"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService;"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public ActivityCreateHandler(TelegramService telegramService) {"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.setState(message.getChatId(), ActivityCreate.GET_TITLE);"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Enter the activity title\");"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (StateMachineException e) {"},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Error occurred!\");"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public List\u003cString\u003e getCommands() {"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return List.of(\"createactivity\");"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Dmytro Zhornyk":37}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/delete/ActivityDelete.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.delete;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"public enum ActivityDelete  implements State, State.Group {"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"    GROUP, GET_ID;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public String key() {"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return getClass().getName() + \".\" + name();"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Dmytro Zhornyk":12}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/delete/ActivityDeleteGetId.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.delete;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Component"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityDeleteGetId implements Handler {"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService;"},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityService activityService;"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public ActivityDeleteGetId(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public void handle(CallbackQuery callbackQuery, StateMachine stateMachine) {"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"            String activityId \u003d callbackQuery.getData();"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":"            activityService.deleteActivity(activityId);"},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.setState(callbackQuery.getMessage().getChatId(), new State.Any());"},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Activity was successfully deleted!\");"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (Exception e) {"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Error occurred!\");"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public State getState() {"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return ActivityDelete.GET_ID;"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Dmytro Zhornyk":41}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/delete/ActivityDeleteHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.delete;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.app.activities.Utils;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.InlineKeyboardMarkup;"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.buttons.InlineKeyboardButton;"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.ArrayList;"},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.List;"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Component"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityDeleteHandler implements Handler {"},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService;"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityService activityService;"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public ActivityDeleteHandler(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":"            List\u003cActivityEntity\u003e entities \u003d activityService.getUserActivities(message.getFrom().getId().toString());"},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":"            InlineKeyboardMarkup kb \u003d Utils.getActivitiesKeyboard(entities);"},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.setState(message.getChatId(), ActivityDelete.GET_ID);"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Pick the activity:\", kb);"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (Exception e) {"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Error occurred!\");"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":44,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public List\u003cString\u003e getCommands() {"},{"lineNumber":45,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return List.of(\"deleteactivity\");"},{"lineNumber":46,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":47,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Dmytro Zhornyk":47}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/list/ActivitiesListHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.list;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.app.activities.delete.ActivityDelete;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.InlineKeyboardMarkup;"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.buttons.InlineKeyboardButton;"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.ArrayList;"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.List;"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Component"},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivitiesListHandler implements Handler {"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService;"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityService activityService;"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public ActivitiesListHandler(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":"            StringBuilder sb \u003d new StringBuilder();"},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"            sb.append(\"Your activities:\\n\");"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"            List\u003cActivityEntity\u003e entities \u003d activityService.getUserActivities(message.getFrom().getId().toString());"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"            for (ActivityEntity entity : entities) {"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"                sb.append(\"--------------------\\n\");"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"                sb.append(\"Title: \").append(entity.getTitle()).append(\"\\n\");"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"                sb.append(\"Description: \").append(entity.getDescription()).append(\"\\n\");"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":"                sb.append(\"Date: \").append(entity.getDate()).append(\"\\n\");"},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"                sb.append(\"Time: \").append(entity.getTime()).append(\"\\n\");"},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":"                sb.append(\"Location: \").append(entity.getLocation()).append(\"\\n\");"},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":"                sb.append(\"--------------------\\n\");"},{"lineNumber":44,"author":{"gitId":"Dmytro Zhornyk"},"content":"            }"},{"lineNumber":45,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":46,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), sb.toString());"},{"lineNumber":47,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (Exception e) {"},{"lineNumber":48,"author":{"gitId":"Dmytro Zhornyk"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":49,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":50,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Error occurred!\");"},{"lineNumber":51,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":52,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":53,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":54,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":55,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public List\u003cString\u003e getCommands() {"},{"lineNumber":56,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return List.of(\"listactivities\");"},{"lineNumber":57,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":58,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"},{"lineNumber":59,"author":{"gitId":"Dmytro Zhornyk"},"content":""}],"authorContributionMap":{"Dmytro Zhornyk":59}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/update/ActivityUpdate.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.update;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"public enum ActivityUpdate  implements State, State.Group {"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"    GROUP, GET_ID, GET_FIELD, GET_VALUE;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public String key() {"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return getClass().getName() + \".\" + name();"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":""}],"authorContributionMap":{"Dmytro Zhornyk":13}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/update/ActivityUpdateGetField.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.update;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Component"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityUpdateGetField implements Handler {"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService;"},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public ActivityUpdateGetField(TelegramService telegramService) {"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public void handle(CallbackQuery callbackQuery, StateMachine stateMachine) {"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":"            ActivityUpdateDto payload \u003d stateMachine"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    .getStatePayload(callbackQuery.getMessage().getChatId(), ActivityUpdate.GROUP, ActivityUpdateDto.class)"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    .orElseThrow();"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"            payload.setField(callbackQuery.getData());"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.updateStateData(callbackQuery.getMessage().getChatId(), ActivityUpdate.GROUP, payload);"},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.setState(callbackQuery.getMessage().getChatId(), ActivityUpdate.GET_VALUE);"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Enter a new value\");"},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (Exception e) {"},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Error occurred!\");"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public State getState() {"},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return ActivityUpdate.GET_FIELD;"},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"},{"lineNumber":44,"author":{"gitId":"Dmytro Zhornyk"},"content":""}],"authorContributionMap":{"Dmytro Zhornyk":44}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/update/ActivityUpdateGetId.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.update;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.app.activities.Utils;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.InlineKeyboardMarkup;"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.HashMap;"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Component"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityUpdateGetId implements Handler {"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService;"},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public ActivityUpdateGetId(TelegramService telegramService) {"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public void handle(CallbackQuery callbackQuery, StateMachine stateMachine) {"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"            String activityId \u003d callbackQuery.getData();"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"            ActivityUpdateDto payload \u003d new ActivityUpdateDto();"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"            payload.setActivityId(activityId);"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.updateStateData(callbackQuery.getMessage().getChatId(), ActivityUpdate.GROUP, payload);"},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"            HashMap\u003cString, String\u003e map \u003d new HashMap\u003c\u003e();"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"            map.put(\"Title\", \"title\");"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"            map.put(\"Description\", \"description\");"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"            map.put(\"Date\", \"date\");"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"            map.put(\"Time\", \"time\");"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"            map.put(\"Location\", \"location\");"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"            InlineKeyboardMarkup kb \u003d Utils.getKeyboardFromDict(map);"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.setState(callbackQuery.getMessage().getChatId(), ActivityUpdate.GET_FIELD);"},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Pick a field to edit\", kb);"},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (Exception e) {"},{"lineNumber":44,"author":{"gitId":"Dmytro Zhornyk"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":45,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":46,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Error occurred!\");"},{"lineNumber":47,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":48,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":49,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":50,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":51,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public State getState() {"},{"lineNumber":52,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return ActivityUpdate.GET_ID;"},{"lineNumber":53,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":54,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"},{"lineNumber":55,"author":{"gitId":"Dmytro Zhornyk"},"content":""}],"authorContributionMap":{"Dmytro Zhornyk":55}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/update/ActivityUpdateGetValue.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.update;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Component"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityUpdateGetValue implements Handler {"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService;"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityService activityService;"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public ActivityUpdateGetValue(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"            ActivityUpdateDto payload \u003d stateMachine"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    .getStatePayload(message.getChatId(), ActivityUpdate.GROUP, ActivityUpdateDto.class)"},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    .orElseThrow();"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":"            payload.setValue(message.getText());"},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":"            activityService.updateActivity(payload);"},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.setState(message.getChatId(), new State.Any());"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Successfully updated!\");"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (Exception e) {"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Error occurred!\");"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":44,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public State getState() {"},{"lineNumber":45,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return ActivityUpdate.GET_VALUE;"},{"lineNumber":46,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":47,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"},{"lineNumber":48,"author":{"gitId":"Dmytro Zhornyk"},"content":""}],"authorContributionMap":{"Dmytro Zhornyk":48}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/activities/update/ActivityUpdateHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app.activities.update;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.app.activities.Utils;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.app.activities.delete.ActivityDelete;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.InlineKeyboardMarkup;"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.buttons.InlineKeyboardButton;"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.ArrayList;"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.List;"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Component"},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityUpdateHandler implements Handler {"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService;"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityService activityService;"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public ActivityUpdateHandler(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":"            List\u003cActivityEntity\u003e entities \u003d activityService.getUserActivities(message.getFrom().getId().toString());"},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"            InlineKeyboardMarkup kb \u003d Utils.getActivitiesKeyboard(entities);"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateMachine.setState(message.getChatId(), ActivityUpdate.GET_ID);"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Pick the activity:\", kb);"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (Exception e) {"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":"            telegramService.sendMessage(message.getChatId(), \"Error occurred!\");"},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":44,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Override"},{"lineNumber":45,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public List\u003cString\u003e getCommands() {"},{"lineNumber":46,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return List.of(\"updateactivity\");"},{"lineNumber":47,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":48,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"},{"lineNumber":49,"author":{"gitId":"Dmytro Zhornyk"},"content":""}],"authorContributionMap":{"Dmytro Zhornyk":49}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/create/CompetenceCreate.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.create;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"public enum CompetenceCreate implements State, State.Group {"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"    GROUP, GET_ACTIVITY_ID, GET_COMPETENCES;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"    public String key() {"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"        return getClass().getName() + \".\" + name();"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"}"}],"authorContributionMap":{"Stas Boguta":12}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/create/CompetenceCreateGetActivityId.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.create;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.Utils;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.create.ActivityCreate;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.update.ActivityUpdate;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.InlineKeyboardMarkup;"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":"import java.util.HashMap;"},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":"@Component"},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceCreateGetActivityId implements Handler {"},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService;"},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":"    public CompetenceCreateGetActivityId(TelegramService telegramService) {"},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":"    public void handle(CallbackQuery callbackQuery, StateMachine stateMachine) {"},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":"            String activityId \u003d callbackQuery.getData();"},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":"            ActivityUpdateDto payload \u003d new ActivityUpdateDto();"},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":"            payload.setActivityId(activityId);"},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":"            payload.setField(\"competences\");"},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"            stateMachine.updateStateData(callbackQuery.getMessage().getChatId(), ActivityUpdate.GROUP, payload);"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":"            stateMachine.setState(callbackQuery.getMessage().getChatId(), CompetenceCreate.GET_COMPETENCES);"},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Enter competences. All competences in one message. Each competence in separate line\");"},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":"        } catch (Exception e) {"},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Error occurred!\");"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":46,"author":{"gitId":"Stas Boguta"},"content":"    public State getState() {"},{"lineNumber":47,"author":{"gitId":"Stas Boguta"},"content":"        return CompetenceCreate.GET_ACTIVITY_ID;"},{"lineNumber":48,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":49,"author":{"gitId":"Stas Boguta"},"content":"}"},{"lineNumber":50,"author":{"gitId":"Stas Boguta"},"content":""}],"authorContributionMap":{"Stas Boguta":50}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/create/CompetenceCreateGetCompetences.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.create;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.create.ActivityCreate;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.update.ActivityUpdate;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.ActivityDto;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":"import java.util.Arrays;"},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":"import java.util.List;"},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":"@Component"},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceCreateGetCompetences implements Handler {"},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService;"},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":"    private final ActivityService activityService;"},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":"    public CompetenceCreateGetCompetences(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":"            ActivityUpdateDto payload \u003d stateMachine"},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"                    .getStatePayload(message.getChatId(), CompetenceCreate.GROUP, ActivityUpdateDto.class)"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":"                    .orElseThrow();"},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":"            List\u003cString\u003e competences \u003d Arrays.asList(message.getText().split(\"\\\\n\"));"},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":"            payload.setArray(competences);"},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":"            activityService.updateActivity(payload);"},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":"            stateMachine.setState(message.getChatId(), new State.Any());"},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(message.getChatId(), \"Successfully created!\");"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":"        } catch (Exception e) {"},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(message.getChatId(), \"Error occurred!\");"},{"lineNumber":46,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":47,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":48,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":49,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":50,"author":{"gitId":"Stas Boguta"},"content":"    public State getState() {"},{"lineNumber":51,"author":{"gitId":"Stas Boguta"},"content":"        return CompetenceCreate.GET_COMPETENCES;"},{"lineNumber":52,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":53,"author":{"gitId":"Stas Boguta"},"content":"}"}],"authorContributionMap":{"Stas Boguta":53}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/create/CompetenceCreateHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.create;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.Utils;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.InlineKeyboardMarkup;"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"import java.util.List;"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":"@Component"},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceCreateHandler implements Handler {"},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService;"},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":"    private final ActivityService activityService;"},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":"    public CompetenceCreateHandler(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":"            List\u003cActivityEntity\u003e entities \u003d activityService.getUserActivities(message.getFrom().getId().toString());"},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":"            InlineKeyboardMarkup kb \u003d Utils.getActivitiesKeyboard(entities);"},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":"            stateMachine.setState(message.getChatId(), CompetenceCreate.GET_ACTIVITY_ID);"},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(message.getChatId(), \"Pick the activity:\", kb);"},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"        } catch (Exception e) {"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(message.getChatId(), \"Error occurred!\");"},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":"    public List\u003cString\u003e getCommands() {"},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":"        return List.of(\"createcompetences\");"},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":"}"}],"authorContributionMap":{"Stas Boguta":45}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/delete/CompetenceDelete.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.delete;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"public enum CompetenceDelete implements State, State.Group{"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"    GROUP, GET_COMPETENCES, DELETE;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"    public String key() {"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"        return getClass().getName() + \".\" + name();"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"}"}],"authorContributionMap":{"Stas Boguta":12}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/delete/CompetenceDeleteGetCompetences.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.delete;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.Utils;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.update.ActivityUpdate;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.CompetenceUpdateDto;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.InlineKeyboardMarkup;"},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":"import java.util.HashMap;"},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":"import java.util.List;"},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":"@Component"},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceDeleteGetCompetences implements Handler {"},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService;"},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":"    private final ActivityService activityService;"},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"    public CompetenceDeleteGetCompetences(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":"    public void handle(CallbackQuery callbackQuery, StateMachine stateMachine) {"},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"            String activityId \u003d callbackQuery.getData();"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":"            ActivityUpdateDto payload \u003d new ActivityUpdateDto();"},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":"            payload.setActivityId(activityId);"},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":"            List\u003cActivityEntity\u003e entities \u003d activityService.getUserActivities(callbackQuery.getMessage().getChatId().toString());"},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"            entities \u003d entities.stream().filter(a -\u003e a.getId().equals(activityId)).toList();"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":"            ActivityEntity activity \u003d entities.get(0);"},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":"            CompetenceUpdateDto competenceUpdateDto \u003d new CompetenceUpdateDto();"},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":"            competenceUpdateDto.setActivityUpdateDto(payload);"},{"lineNumber":46,"author":{"gitId":"Stas Boguta"},"content":"            competenceUpdateDto.setEntity(activity);"},{"lineNumber":47,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":48,"author":{"gitId":"Stas Boguta"},"content":"            stateMachine.updateStateData(callbackQuery.getMessage().getChatId(), ActivityUpdate.GROUP, competenceUpdateDto);"},{"lineNumber":49,"author":{"gitId":"Stas Boguta"},"content":"            if(activity.getCompetences().size() \u003d\u003d 0){"},{"lineNumber":50,"author":{"gitId":"Stas Boguta"},"content":"                stateMachine.setState(callbackQuery.getMessage().getChatId(),  new State.Any());"},{"lineNumber":51,"author":{"gitId":"Stas Boguta"},"content":"                telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Current activity hasn\u0027t competences\");"},{"lineNumber":52,"author":{"gitId":"Stas Boguta"},"content":"            } else{"},{"lineNumber":53,"author":{"gitId":"Stas Boguta"},"content":"                HashMap\u003cString, String\u003e map \u003d new HashMap\u003c\u003e();"},{"lineNumber":54,"author":{"gitId":"Stas Boguta"},"content":"                for(String c : activity.getCompetences()){"},{"lineNumber":55,"author":{"gitId":"Stas Boguta"},"content":"                    map.put(c, c);"},{"lineNumber":56,"author":{"gitId":"Stas Boguta"},"content":"                }"},{"lineNumber":57,"author":{"gitId":"Stas Boguta"},"content":"                InlineKeyboardMarkup kb \u003d Utils.getKeyboardFromDict(map);"},{"lineNumber":58,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":59,"author":{"gitId":"Stas Boguta"},"content":"                stateMachine.setState(callbackQuery.getMessage().getChatId(), CompetenceDelete.DELETE);"},{"lineNumber":60,"author":{"gitId":"Stas Boguta"},"content":"                telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Pick a competence to delete\", kb);"},{"lineNumber":61,"author":{"gitId":"Stas Boguta"},"content":"            }"},{"lineNumber":62,"author":{"gitId":"Stas Boguta"},"content":"        } catch (Exception e) {"},{"lineNumber":63,"author":{"gitId":"Stas Boguta"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":64,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":65,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Error occurred!\");"},{"lineNumber":66,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":67,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":68,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":69,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":70,"author":{"gitId":"Stas Boguta"},"content":"    public State getState() {"},{"lineNumber":71,"author":{"gitId":"Stas Boguta"},"content":"        return CompetenceDelete.GET_COMPETENCES;"},{"lineNumber":72,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":73,"author":{"gitId":"Stas Boguta"},"content":"}"},{"lineNumber":74,"author":{"gitId":"Stas Boguta"},"content":""}],"authorContributionMap":{"Stas Boguta":74}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/delete/CompetenceDeleteHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.delete;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.Utils;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.InlineKeyboardMarkup;"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"import java.util.List;"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":"@Component"},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceDeleteHandler implements Handler {"},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService;"},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":"    private final ActivityService activityService;"},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":"    public CompetenceDeleteHandler(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":"            List\u003cActivityEntity\u003e entities \u003d activityService.getUserActivities(message.getFrom().getId().toString());"},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":"            InlineKeyboardMarkup kb \u003d Utils.getActivitiesKeyboard(entities);"},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":"            stateMachine.setState(message.getChatId(), CompetenceDelete.GET_COMPETENCES);"},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(message.getChatId(), \"Pick the activity:\", kb);"},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"        } catch (Exception e) {"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(message.getChatId(), \"Error occurred!\");"},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":"    public List\u003cString\u003e getCommands() {"},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":"        return List.of(\"deletecompetence\");"},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":"}"}],"authorContributionMap":{"Stas Boguta":45}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/delete/CompetenceDeleteValue.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.delete;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.update.ActivityUpdate;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.CompetenceUpdateDto;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":"import java.util.List;"},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":"@Component"},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceDeleteValue implements Handler {"},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService;"},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":"    private final ActivityService activityService;"},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":"    public CompetenceDeleteValue(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":"    public void handle(CallbackQuery callbackQuery, StateMachine stateMachine) {"},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":"            String competence \u003d callbackQuery.getData();"},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":"            CompetenceUpdateDto payload \u003d stateMachine"},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":"                    .getStatePayload(callbackQuery.getMessage().getChatId(), ActivityUpdate.GROUP, CompetenceUpdateDto.class)"},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"                    .orElseThrow();"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":"            payload.setCompetence(competence);"},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":"            ActivityUpdateDto activityUpdateDto \u003d payload.getActivityUpdateDto();"},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":"            activityUpdateDto.setField(\"competences\");"},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":"            ActivityEntity activity \u003d payload.getEntity();"},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"            List\u003cString\u003e competences \u003d activity.getCompetences().stream()"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":"                            .filter(c -\u003e !c.equals(competence)).toList();"},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":"            activityUpdateDto.setArray(competences);"},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":"            activityService.updateActivity(activityUpdateDto);"},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":46,"author":{"gitId":"Stas Boguta"},"content":"            stateMachine.setState(callbackQuery.getMessage().getChatId(), new State.Any());"},{"lineNumber":47,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Competence is deleted!\");"},{"lineNumber":48,"author":{"gitId":"Stas Boguta"},"content":"        } catch (Exception e) {"},{"lineNumber":49,"author":{"gitId":"Stas Boguta"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":50,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":51,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Error occurred!\");"},{"lineNumber":52,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":53,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":54,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":55,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":56,"author":{"gitId":"Stas Boguta"},"content":"    public State getState() {"},{"lineNumber":57,"author":{"gitId":"Stas Boguta"},"content":"        return CompetenceDelete.DELETE;"},{"lineNumber":58,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":59,"author":{"gitId":"Stas Boguta"},"content":"}"},{"lineNumber":60,"author":{"gitId":"Stas Boguta"},"content":""}],"authorContributionMap":{"Stas Boguta":60}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/list/CompetenceList.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.list;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"public enum CompetenceList implements State, State.Group{"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"    GROUP, GET_COMPETENCES;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"    public String key() {"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"        return getClass().getName() + \".\" + name();"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"}"}],"authorContributionMap":{"Stas Boguta":12}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/list/CompetenceListGetCompetences.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.list;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"import java.util.List;"},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":"@Component"},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceListGetCompetences implements Handler {"},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService;"},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":"    private final ActivityService activityService;"},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":"    public CompetenceListGetCompetences(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"    public void handle(CallbackQuery callbackQuery, StateMachine stateMachine) {"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":"            String activityId \u003d callbackQuery.getData();"},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":"            List\u003cActivityEntity\u003e entities \u003d activityService.getUserActivities(callbackQuery.getMessage().getChatId().toString());"},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":"            entities \u003d entities.stream().filter(a -\u003e a.getId().equals(activityId)).toList();"},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":"            ActivityEntity activity \u003d entities.get(0);"},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":"            StringBuilder sb \u003d new StringBuilder();"},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":"            sb.append(\"Your competences for activity:\\n\");"},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"            for (String competence : activity.getCompetences()) {"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":"                sb.append(\"--------------------\\n\");"},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":"                sb.append(\"Title: \").append(competence).append(\"\\n\");"},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":"                sb.append(\"--------------------\\n\");"},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":"            }"},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":"            stateMachine.setState(callbackQuery.getMessage().getChatId(), new State.Any());"},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), sb.toString());"},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"        } catch (Exception e) {"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Error occurred!\");"},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":46,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":47,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":48,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":49,"author":{"gitId":"Stas Boguta"},"content":"    public State getState() {"},{"lineNumber":50,"author":{"gitId":"Stas Boguta"},"content":"        return CompetenceList.GET_COMPETENCES;"},{"lineNumber":51,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":52,"author":{"gitId":"Stas Boguta"},"content":"}"},{"lineNumber":53,"author":{"gitId":"Stas Boguta"},"content":""}],"authorContributionMap":{"Stas Boguta":53}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/list/CompetenceListHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.list;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.Utils;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.InlineKeyboardMarkup;"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"import java.util.List;"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":"@Component"},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceListHandler implements Handler {"},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService;"},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":"    private final ActivityService activityService;"},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":"    public CompetenceListHandler(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":"            List\u003cActivityEntity\u003e entities \u003d activityService.getUserActivities(message.getFrom().getId().toString());"},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":"            InlineKeyboardMarkup kb \u003d Utils.getActivitiesKeyboard(entities);"},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":"            stateMachine.setState(message.getChatId(), CompetenceList.GET_COMPETENCES);"},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(message.getChatId(), \"Pick the activity:\", kb);"},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"        } catch (Exception e) {"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(message.getChatId(), \"Error occurred!\");"},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":"    public List\u003cString\u003e getCommands() {"},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":"        return List.of(\"competences\");"},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":"}"}],"authorContributionMap":{"Stas Boguta":45}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/update/CompetenceUpdate.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.update;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"public enum CompetenceUpdate implements State, State.Group{"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"    GROUP, GET_COMPETENCES, GET_VALUE, UPDATE_VALUE;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"    public String key() {"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"        return getClass().getName() + \".\" + name();"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"}"}],"authorContributionMap":{"Stas Boguta":12}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/update/CompetenceUpdateGetCompetences.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.update;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.Utils;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.update.ActivityUpdate;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.CompetenceUpdateDto;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.InlineKeyboardMarkup;"},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":"import java.util.HashMap;"},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":"import java.util.List;"},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":"@Component"},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceUpdateGetCompetences implements Handler {"},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService;"},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":"    private final ActivityService activityService;"},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"    public CompetenceUpdateGetCompetences(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":"    public void handle(CallbackQuery callbackQuery, StateMachine stateMachine) {"},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"            String activityId \u003d callbackQuery.getData();"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":"            ActivityUpdateDto payload \u003d new ActivityUpdateDto();"},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":"            payload.setActivityId(activityId);"},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":"            List\u003cActivityEntity\u003e entities \u003d activityService.getUserActivities(callbackQuery.getMessage().getChatId().toString());"},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"            entities \u003d entities.stream().filter(a -\u003e a.getId().equals(activityId)).toList();"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":"            ActivityEntity activity \u003d entities.get(0);"},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":"            CompetenceUpdateDto competenceUpdateDto \u003d new CompetenceUpdateDto();"},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":"            competenceUpdateDto.setActivityUpdateDto(payload);"},{"lineNumber":46,"author":{"gitId":"Stas Boguta"},"content":"            competenceUpdateDto.setEntity(activity);"},{"lineNumber":47,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":48,"author":{"gitId":"Stas Boguta"},"content":"            stateMachine.updateStateData(callbackQuery.getMessage().getChatId(), CompetenceUpdate.GROUP, competenceUpdateDto);"},{"lineNumber":49,"author":{"gitId":"Stas Boguta"},"content":"            if(activity.getCompetences().size() \u003d\u003d 0){"},{"lineNumber":50,"author":{"gitId":"Stas Boguta"},"content":"                stateMachine.setState(callbackQuery.getMessage().getChatId(),  new State.Any());"},{"lineNumber":51,"author":{"gitId":"Stas Boguta"},"content":"                telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Current activity hasn\u0027t competences\");"},{"lineNumber":52,"author":{"gitId":"Stas Boguta"},"content":"            } else{"},{"lineNumber":53,"author":{"gitId":"Stas Boguta"},"content":"                HashMap\u003cString, String\u003e map \u003d new HashMap\u003c\u003e();"},{"lineNumber":54,"author":{"gitId":"Stas Boguta"},"content":"                for(String c : activity.getCompetences()){"},{"lineNumber":55,"author":{"gitId":"Stas Boguta"},"content":"                    map.put(c, c);"},{"lineNumber":56,"author":{"gitId":"Stas Boguta"},"content":"                }"},{"lineNumber":57,"author":{"gitId":"Stas Boguta"},"content":"                InlineKeyboardMarkup kb \u003d Utils.getKeyboardFromDict(map);"},{"lineNumber":58,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":59,"author":{"gitId":"Stas Boguta"},"content":"                stateMachine.setState(callbackQuery.getMessage().getChatId(), CompetenceUpdate.GET_VALUE);"},{"lineNumber":60,"author":{"gitId":"Stas Boguta"},"content":"                telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Pick a competence to edit\", kb);"},{"lineNumber":61,"author":{"gitId":"Stas Boguta"},"content":"            }"},{"lineNumber":62,"author":{"gitId":"Stas Boguta"},"content":"        } catch (Exception e) {"},{"lineNumber":63,"author":{"gitId":"Stas Boguta"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":64,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":65,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Error occurred!\");"},{"lineNumber":66,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":67,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":68,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":69,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":70,"author":{"gitId":"Stas Boguta"},"content":"    public State getState() {"},{"lineNumber":71,"author":{"gitId":"Stas Boguta"},"content":"        return CompetenceUpdate.GET_COMPETENCES;"},{"lineNumber":72,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":73,"author":{"gitId":"Stas Boguta"},"content":"}"},{"lineNumber":74,"author":{"gitId":"Stas Boguta"},"content":""}],"authorContributionMap":{"Stas Boguta":74}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/update/CompetenceUpdateGetValue.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.update;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.update.ActivityUpdate;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.CompetenceUpdateDto;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"@Component"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceUpdateGetValue implements Handler {"},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService;"},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":"    private final ActivityService activityService;"},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":"    public CompetenceUpdateGetValue(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":"    public void handle(CallbackQuery callbackQuery, StateMachine stateMachine) {"},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":"            String competence \u003d callbackQuery.getData();"},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":"            CompetenceUpdateDto payload \u003d stateMachine"},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":"                    .getStatePayload(callbackQuery.getMessage().getChatId(), CompetenceUpdate.GROUP, CompetenceUpdateDto.class)"},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":"                    .orElseThrow();"},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":"            payload.setCompetence(competence);"},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":"            stateMachine.updateStateData(callbackQuery.getMessage().getChatId(), CompetenceUpdate.GROUP, payload);"},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"            stateMachine.setState(callbackQuery.getMessage().getChatId(), CompetenceUpdate.UPDATE_VALUE);"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Type new competence name\");"},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":"        } catch (Exception e) {"},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Error occurred!\");"},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":"    public State getState() {"},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":"        return CompetenceUpdate.GET_VALUE;"},{"lineNumber":46,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":47,"author":{"gitId":"Stas Boguta"},"content":"}"},{"lineNumber":48,"author":{"gitId":"Stas Boguta"},"content":""}],"authorContributionMap":{"Stas Boguta":48}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/update/CompetenceUpdateHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.update;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.Utils;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.InlineKeyboardMarkup;"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"import java.util.List;"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":"@Component"},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceUpdateHandler implements Handler {"},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService;"},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":"    private final ActivityService activityService;"},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":"    public CompetenceUpdateHandler(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":"            List\u003cActivityEntity\u003e entities \u003d activityService.getUserActivities(message.getFrom().getId().toString());"},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":"            InlineKeyboardMarkup kb \u003d Utils.getActivitiesKeyboard(entities);"},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":"            stateMachine.setState(message.getChatId(), CompetenceUpdate.GET_COMPETENCES);"},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(message.getChatId(), \"Pick the activity:\", kb);"},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"        } catch (Exception e) {"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(message.getChatId(), \"Error occurred!\");"},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":"    public List\u003cString\u003e getCommands() {"},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":"        return List.of(\"updatecompetence\");"},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":"}"}],"authorContributionMap":{"Stas Boguta":45}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/competence/update/CompetenceUpdateValue.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app.competence.update;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.activities.update.ActivityUpdate;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.CompetenceUpdateDto;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":"import java.util.List;"},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":"@Component"},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceUpdateValue implements Handler {"},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService;"},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":"    private final ActivityService activityService;"},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":"    public CompetenceUpdateValue(TelegramService telegramService, ActivityService activityService) {"},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"        this.activityService \u003d activityService;"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":"            String newCompetence \u003d message.getText();"},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"            CompetenceUpdateDto payload \u003d stateMachine"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":"                    .getStatePayload(message.getChatId(), CompetenceUpdate.GROUP, CompetenceUpdateDto.class)"},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":"                    .orElseThrow();"},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":"            ActivityUpdateDto activity \u003d payload.getActivityUpdateDto();"},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":"            activity.setField(\"competences\");"},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":"            ActivityEntity entity \u003d payload.getEntity();"},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"            List\u003cString\u003e competences \u003d new java.util.ArrayList\u003c\u003e(entity.getCompetences()"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":"                    .stream()"},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":"                    .filter(c -\u003e !c.equals(payload.getCompetence()))"},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":"                    .toList());"},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":"            competences.add(newCompetence);"},{"lineNumber":46,"author":{"gitId":"Stas Boguta"},"content":"            activity.setArray(competences);"},{"lineNumber":47,"author":{"gitId":"Stas Boguta"},"content":"            activityService.updateActivity(activity);"},{"lineNumber":48,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":49,"author":{"gitId":"Stas Boguta"},"content":"            stateMachine.setState(message.getChatId(), new State.Any());"},{"lineNumber":50,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(message.getChatId(), \"Successfully updated!\");"},{"lineNumber":51,"author":{"gitId":"Stas Boguta"},"content":"        } catch (Exception e) {"},{"lineNumber":52,"author":{"gitId":"Stas Boguta"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":53,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":54,"author":{"gitId":"Stas Boguta"},"content":"            telegramService.sendMessage(message.getChatId(), \"Error occurred!\");"},{"lineNumber":55,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":56,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":57,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":58,"author":{"gitId":"Stas Boguta"},"content":"    @Override"},{"lineNumber":59,"author":{"gitId":"Stas Boguta"},"content":"    public State getState() {"},{"lineNumber":60,"author":{"gitId":"Stas Boguta"},"content":"        return CompetenceUpdate.UPDATE_VALUE;"},{"lineNumber":61,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":62,"author":{"gitId":"Stas Boguta"},"content":"}"},{"lineNumber":63,"author":{"gitId":"Stas Boguta"},"content":""}],"authorContributionMap":{"Stas Boguta":63}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/course/CourseCreate.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.app.course;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"public enum CourseCreate implements State, State.Group {"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"    GROUP, GET_TITLE, GET_DESCRIPTION;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"    public String key() {"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"        return getClass().getName() + \".\" + name();"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":12}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/course/CourseCreateHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.app.course;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"import java.util.List;"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"@Component"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":"public class CourseCreateHandler implements Handler {"},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":"    private final TelegramService telegramService;"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":"    public CourseCreateHandler(TelegramService telegramService) {"},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":"        try {"},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":"            stateMachine.setState(message.getChatId(), CourseCreate.GET_TITLE);"},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":"            telegramService.sendMessage(message.getChatId(), \"Enter course title: \");"},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":"        } catch (StateMachineException e) {"},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":"            telegramService.sendMessage(message.getChatId(), \"Some problems!\");"},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":31,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":"    public List\u003cString\u003e getCommands() {"},{"lineNumber":33,"author":{"gitId":"VladKozyr"},"content":"        return List.of(\"course\");"},{"lineNumber":34,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":35}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/course/CourseDescriptionHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.app.course;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.dto.CourseDto;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.service.CourseService;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"@Component"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":"public class CourseDescriptionHandler implements Handler {"},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":"    private final TelegramService telegramService;"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":"    private final CourseService courseService;"},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":"    public CourseDescriptionHandler(TelegramService telegramService, CourseService courseService) {"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"        this.courseService \u003d courseService;"},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":"        try {"},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":"            CourseDto payload \u003d stateMachine"},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":"                    .getStatePayload(message.getChatId(), CourseCreate.GROUP, CourseDto.class)"},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":"                    .orElseThrow();"},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":"            payload.setDescription(message.getText());"},{"lineNumber":31,"author":{"gitId":"VladKozyr"},"content":"            courseService.createCourse(payload);"},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":"            stateMachine.setState(message.getChatId(), new State.Any());"},{"lineNumber":33,"author":{"gitId":"VladKozyr"},"content":"            telegramService.sendMessage(message.getChatId(), \"Course saved\");"},{"lineNumber":34,"author":{"gitId":"VladKozyr"},"content":"        } catch (Exception exception) {"},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":"            telegramService.sendMessage(message.getChatId(), \"Course don\u0027t saved: Some problem\");"},{"lineNumber":36,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":37,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":38,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":39,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":40,"author":{"gitId":"VladKozyr"},"content":"    public State getState() {"},{"lineNumber":41,"author":{"gitId":"VladKozyr"},"content":"        return CourseCreate.GET_DESCRIPTION;"},{"lineNumber":42,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":43,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":43}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/course/CourseTitleHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.app.course;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.dto.CourseDto;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"@Component"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"public class CourseTitleHandler implements Handler {"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":"    private final TelegramService telegramService;"},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":"    public CourseTitleHandler(TelegramService telegramService) {"},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":"        try {"},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":"            CourseDto payload \u003d new CourseDto(message.getText(), null);"},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":"            stateMachine.updateStateData(message.getChatId(), CourseCreate.GROUP, payload);"},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":"            stateMachine.setState(message.getChatId(), CourseCreate.GET_DESCRIPTION);"},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":"            telegramService.sendMessage(message.getChatId(), \"Enter course description: \");"},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":"        } catch (Exception exception) {"},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":"            telegramService.sendMessage(message.getChatId(), \"Course don\u0027t saved: Some problem\");"},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":31,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":33,"author":{"gitId":"VladKozyr"},"content":"    public State getState() {"},{"lineNumber":34,"author":{"gitId":"VladKozyr"},"content":"        return CourseCreate.GET_TITLE;"},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":36,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":36}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/course/bulk_import/CoursesImport.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Danylo Makarenko"},"content":"package edu.kmaooad.app.course.bulk_import;"},{"lineNumber":2,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":3,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":5,"author":{"gitId":"Danylo Makarenko"},"content":"public enum CoursesImport implements State, State.Group {"},{"lineNumber":6,"author":{"gitId":"Danylo Makarenko"},"content":"    GROUP, GET_FILE;"},{"lineNumber":7,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":8,"author":{"gitId":"Danylo Makarenko"},"content":"    @Override"},{"lineNumber":9,"author":{"gitId":"Danylo Makarenko"},"content":"    public String key() {"},{"lineNumber":10,"author":{"gitId":"Danylo Makarenko"},"content":"        return getClass().getName() + \".\" + name();"},{"lineNumber":11,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":12,"author":{"gitId":"Danylo Makarenko"},"content":"}"}],"authorContributionMap":{"Danylo Makarenko":12}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/course/bulk_import/CoursesImportFileHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Danylo Makarenko"},"content":"package edu.kmaooad.app.course.bulk_import;"},{"lineNumber":2,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":3,"author":{"gitId":"Danylo Makarenko"},"content":"import com.opencsv.bean.CsvToBeanBuilder;"},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":5,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":6,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":7,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.dto.CourseDto;"},{"lineNumber":8,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.service.CourseService;"},{"lineNumber":9,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":10,"author":{"gitId":"Danylo Makarenko"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":11,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.methods.GetFile;"},{"lineNumber":12,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.File;"},{"lineNumber":13,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":14,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":15,"author":{"gitId":"Danylo Makarenko"},"content":"import java.io.FileReader;"},{"lineNumber":16,"author":{"gitId":"Danylo Makarenko"},"content":"import java.util.List;"},{"lineNumber":17,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":18,"author":{"gitId":"Danylo Makarenko"},"content":"@Component"},{"lineNumber":19,"author":{"gitId":"Danylo Makarenko"},"content":"public class CoursesImportFileHandler implements Handler {"},{"lineNumber":20,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":21,"author":{"gitId":"Danylo Makarenko"},"content":"    private final TelegramService telegramService;"},{"lineNumber":22,"author":{"gitId":"Danylo Makarenko"},"content":"    private final CourseService courseService;"},{"lineNumber":23,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":24,"author":{"gitId":"Danylo Makarenko"},"content":"    public CoursesImportFileHandler(TelegramService telegramService, CourseService courseService) {"},{"lineNumber":25,"author":{"gitId":"Danylo Makarenko"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":26,"author":{"gitId":"Danylo Makarenko"},"content":"        this.courseService \u003d courseService;"},{"lineNumber":27,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":28,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":29,"author":{"gitId":"Danylo Makarenko"},"content":"    @Override"},{"lineNumber":30,"author":{"gitId":"Danylo Makarenko"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":31,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":32,"author":{"gitId":"Danylo Makarenko"},"content":"        try {"},{"lineNumber":33,"author":{"gitId":"Danylo Makarenko"},"content":"            String fileID \u003d message.getDocument().getFileId();"},{"lineNumber":34,"author":{"gitId":"Danylo Makarenko"},"content":"            GetFile uploadedFile \u003d new GetFile();"},{"lineNumber":35,"author":{"gitId":"Danylo Makarenko"},"content":"            uploadedFile.setFileId(fileID);"},{"lineNumber":36,"author":{"gitId":"Danylo Makarenko"},"content":"            File file \u003d telegramService.getFile(uploadedFile);"},{"lineNumber":37,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":38,"author":{"gitId":"Danylo Makarenko"},"content":"            java.io.File csvFile \u003d telegramService.downloadFile(file, file.getFileUniqueId() + file.getFilePath());"},{"lineNumber":39,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":40,"author":{"gitId":"Danylo Makarenko"},"content":"            List\u003cCourseDto\u003e courseDtoList \u003d new CsvToBeanBuilder(new FileReader(csvFile))"},{"lineNumber":41,"author":{"gitId":"Danylo Makarenko"},"content":"                    .withType(CourseDto.class)"},{"lineNumber":42,"author":{"gitId":"Danylo Makarenko"},"content":"                    .build()"},{"lineNumber":43,"author":{"gitId":"Danylo Makarenko"},"content":"                    .parse();"},{"lineNumber":44,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":45,"author":{"gitId":"Danylo Makarenko"},"content":"            courseDtoList \u003d courseDtoList"},{"lineNumber":46,"author":{"gitId":"Danylo Makarenko"},"content":"                    .stream()"},{"lineNumber":47,"author":{"gitId":"Danylo Makarenko"},"content":"                    .filter(dto -\u003e dto.getTitle() !\u003d null"},{"lineNumber":48,"author":{"gitId":"Danylo Makarenko"},"content":"                            \u0026\u0026 dto.getDescription() !\u003d null"},{"lineNumber":49,"author":{"gitId":"Danylo Makarenko"},"content":"                    ).toList();"},{"lineNumber":50,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":51,"author":{"gitId":"Danylo Makarenko"},"content":"            courseDtoList.forEach(courseService::createCourse);"},{"lineNumber":52,"author":{"gitId":"Danylo Makarenko"},"content":"            stateMachine.setState(message.getChatId(), new State.Any());"},{"lineNumber":53,"author":{"gitId":"Danylo Makarenko"},"content":"            telegramService.sendMessage(message.getChatId(), courseDtoList.size() + \" Courses uploaded!\");"},{"lineNumber":54,"author":{"gitId":"Danylo Makarenko"},"content":"        } catch (Exception exception) {"},{"lineNumber":55,"author":{"gitId":"Danylo Makarenko"},"content":"            telegramService.sendMessage(message.getChatId(), \"Incorrect CSV file: \" + exception.getMessage());"},{"lineNumber":56,"author":{"gitId":"Danylo Makarenko"},"content":"        }"},{"lineNumber":57,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":58,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":59,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":60,"author":{"gitId":"Danylo Makarenko"},"content":"    @Override"},{"lineNumber":61,"author":{"gitId":"Danylo Makarenko"},"content":"    public State getState() {"},{"lineNumber":62,"author":{"gitId":"Danylo Makarenko"},"content":"        return CoursesImport.GET_FILE;"},{"lineNumber":63,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":64,"author":{"gitId":"Danylo Makarenko"},"content":"}"}],"authorContributionMap":{"Danylo Makarenko":64}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/course/bulk_import/CoursesImportHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Danylo Makarenko"},"content":"package edu.kmaooad.app.course.bulk_import;"},{"lineNumber":2,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":3,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":5,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":7,"author":{"gitId":"Danylo Makarenko"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":8,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":9,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":10,"author":{"gitId":"Danylo Makarenko"},"content":"import java.util.List;"},{"lineNumber":11,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":12,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":13,"author":{"gitId":"Danylo Makarenko"},"content":"@Component"},{"lineNumber":14,"author":{"gitId":"Danylo Makarenko"},"content":"public class CoursesImportHandler implements Handler {"},{"lineNumber":15,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":16,"author":{"gitId":"Danylo Makarenko"},"content":"    private final TelegramService telegramService;"},{"lineNumber":17,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":18,"author":{"gitId":"Danylo Makarenko"},"content":"    public CoursesImportHandler(TelegramService telegramService) {"},{"lineNumber":19,"author":{"gitId":"Danylo Makarenko"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":20,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":21,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":22,"author":{"gitId":"Danylo Makarenko"},"content":"    @Override"},{"lineNumber":23,"author":{"gitId":"Danylo Makarenko"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":24,"author":{"gitId":"Danylo Makarenko"},"content":"        try {"},{"lineNumber":25,"author":{"gitId":"Danylo Makarenko"},"content":"            stateMachine.setState(message.getChatId(), CoursesImport.GET_FILE);"},{"lineNumber":26,"author":{"gitId":"Danylo Makarenko"},"content":"            telegramService.sendMessage(message.getChatId(), \"Send csv file:\");"},{"lineNumber":27,"author":{"gitId":"Danylo Makarenko"},"content":"        } catch (StateMachineException e) {"},{"lineNumber":28,"author":{"gitId":"Danylo Makarenko"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":29,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":30,"author":{"gitId":"Danylo Makarenko"},"content":"            telegramService.sendMessage(message.getChatId(), \"Error occurred!\");"},{"lineNumber":31,"author":{"gitId":"Danylo Makarenko"},"content":"        }"},{"lineNumber":32,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":33,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":34,"author":{"gitId":"Danylo Makarenko"},"content":"    @Override"},{"lineNumber":35,"author":{"gitId":"Danylo Makarenko"},"content":"    public List\u003cString\u003e getCommands() {"},{"lineNumber":36,"author":{"gitId":"Danylo Makarenko"},"content":"        return List.of(\"import_courses\");"},{"lineNumber":37,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":38,"author":{"gitId":"Danylo Makarenko"},"content":"}"}],"authorContributionMap":{"Danylo Makarenko":38}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/course/bulk_import_projects/CourseProjectsImport.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Danylo Makarenko"},"content":"package edu.kmaooad.app.course.bulk_import_projects;"},{"lineNumber":2,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":3,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":5,"author":{"gitId":"Danylo Makarenko"},"content":"public enum CourseProjectsImport implements State, State.Group {"},{"lineNumber":6,"author":{"gitId":"Danylo Makarenko"},"content":"    GROUP, GET_COURSE_ID, GET_FILE;"},{"lineNumber":7,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":8,"author":{"gitId":"Danylo Makarenko"},"content":"    @Override"},{"lineNumber":9,"author":{"gitId":"Danylo Makarenko"},"content":"    public String key() {"},{"lineNumber":10,"author":{"gitId":"Danylo Makarenko"},"content":"        return getClass().getName() + \".\" + name();"},{"lineNumber":11,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":12,"author":{"gitId":"Danylo Makarenko"},"content":"}"}],"authorContributionMap":{"Danylo Makarenko":12}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/course/bulk_import_projects/CourseProjectsImportFileHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Danylo Makarenko"},"content":"package edu.kmaooad.app.course.bulk_import_projects;"},{"lineNumber":2,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":3,"author":{"gitId":"Danylo Makarenko"},"content":"import com.opencsv.bean.CsvToBeanBuilder;"},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":5,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":6,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":7,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.dto.CourseProjectDto;"},{"lineNumber":8,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.service.CourseService;"},{"lineNumber":9,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":10,"author":{"gitId":"Danylo Makarenko"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":11,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.methods.GetFile;"},{"lineNumber":12,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.File;"},{"lineNumber":13,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":14,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":15,"author":{"gitId":"Danylo Makarenko"},"content":"import java.io.FileReader;"},{"lineNumber":16,"author":{"gitId":"Danylo Makarenko"},"content":"import java.util.List;"},{"lineNumber":17,"author":{"gitId":"Danylo Makarenko"},"content":"import java.util.Optional;"},{"lineNumber":18,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":19,"author":{"gitId":"Danylo Makarenko"},"content":"@Component"},{"lineNumber":20,"author":{"gitId":"Danylo Makarenko"},"content":"public class CourseProjectsImportFileHandler implements Handler {"},{"lineNumber":21,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":22,"author":{"gitId":"Danylo Makarenko"},"content":"    private final TelegramService telegramService;"},{"lineNumber":23,"author":{"gitId":"Danylo Makarenko"},"content":"    private final CourseService courseService;"},{"lineNumber":24,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":25,"author":{"gitId":"Danylo Makarenko"},"content":"    public CourseProjectsImportFileHandler(TelegramService telegramService, CourseService courseService) {"},{"lineNumber":26,"author":{"gitId":"Danylo Makarenko"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":27,"author":{"gitId":"Danylo Makarenko"},"content":"        this.courseService \u003d courseService;"},{"lineNumber":28,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":29,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":30,"author":{"gitId":"Danylo Makarenko"},"content":"    @Override"},{"lineNumber":31,"author":{"gitId":"Danylo Makarenko"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":32,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":33,"author":{"gitId":"Danylo Makarenko"},"content":"        try {"},{"lineNumber":34,"author":{"gitId":"Danylo Makarenko"},"content":"            String fileID \u003d message.getDocument().getFileId();"},{"lineNumber":35,"author":{"gitId":"Danylo Makarenko"},"content":"            GetFile uploadedFile \u003d new GetFile();"},{"lineNumber":36,"author":{"gitId":"Danylo Makarenko"},"content":"            uploadedFile.setFileId(fileID);"},{"lineNumber":37,"author":{"gitId":"Danylo Makarenko"},"content":"            File file \u003d telegramService.getFile(uploadedFile);"},{"lineNumber":38,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":39,"author":{"gitId":"Danylo Makarenko"},"content":"            java.io.File csvFile \u003d telegramService.downloadFile(file, file.getFileUniqueId() + message.getDocument().getFileName());"},{"lineNumber":40,"author":{"gitId":"Danylo Makarenko"},"content":"            List\u003cCourseProjectDto\u003e courseProjectList \u003d new CsvToBeanBuilder(new FileReader(csvFile))"},{"lineNumber":41,"author":{"gitId":"Danylo Makarenko"},"content":"                    .withType(CourseProjectDto.class)"},{"lineNumber":42,"author":{"gitId":"Danylo Makarenko"},"content":"                    .build()"},{"lineNumber":43,"author":{"gitId":"Danylo Makarenko"},"content":"                    .parse();"},{"lineNumber":44,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":45,"author":{"gitId":"Danylo Makarenko"},"content":"            courseProjectList \u003d courseProjectList"},{"lineNumber":46,"author":{"gitId":"Danylo Makarenko"},"content":"                    .stream()"},{"lineNumber":47,"author":{"gitId":"Danylo Makarenko"},"content":"                    .filter(dto -\u003e dto.getTitle() !\u003d null"},{"lineNumber":48,"author":{"gitId":"Danylo Makarenko"},"content":"                            \u0026\u0026 dto.getDescription() !\u003d null"},{"lineNumber":49,"author":{"gitId":"Danylo Makarenko"},"content":"                            \u0026\u0026 dto.getRequirements() !\u003d null"},{"lineNumber":50,"author":{"gitId":"Danylo Makarenko"},"content":"                    ).toList();"},{"lineNumber":51,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":52,"author":{"gitId":"Danylo Makarenko"},"content":"            Optional\u003cString\u003e courseId \u003d stateMachine.getStatePayload(message.getChatId(), CourseProjectsImport.GROUP, String.class);"},{"lineNumber":53,"author":{"gitId":"Danylo Makarenko"},"content":"            if (courseId.isPresent()) {"},{"lineNumber":54,"author":{"gitId":"Danylo Makarenko"},"content":"                courseService.addCourseProjects(courseId.get(), courseProjectList);"},{"lineNumber":55,"author":{"gitId":"Danylo Makarenko"},"content":"                telegramService.sendMessage(message.getChatId(), \"Courses uploaded!\");"},{"lineNumber":56,"author":{"gitId":"Danylo Makarenko"},"content":"            } else {"},{"lineNumber":57,"author":{"gitId":"Danylo Makarenko"},"content":"                telegramService.sendMessage(message.getChatId(), \"Something went wrong, try again!\");"},{"lineNumber":58,"author":{"gitId":"Danylo Makarenko"},"content":"            }"},{"lineNumber":59,"author":{"gitId":"Danylo Makarenko"},"content":"        } catch (Exception exception) {"},{"lineNumber":60,"author":{"gitId":"Danylo Makarenko"},"content":"            telegramService.sendMessage(message.getChatId(), \"Incorrect CSV file: \" + exception.getMessage());"},{"lineNumber":61,"author":{"gitId":"Danylo Makarenko"},"content":"        }"},{"lineNumber":62,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":63,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":64,"author":{"gitId":"Danylo Makarenko"},"content":"    @Override"},{"lineNumber":65,"author":{"gitId":"Danylo Makarenko"},"content":"    public State getState() {"},{"lineNumber":66,"author":{"gitId":"Danylo Makarenko"},"content":"        return CourseProjectsImport.GET_FILE;"},{"lineNumber":67,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":68,"author":{"gitId":"Danylo Makarenko"},"content":"}"}],"authorContributionMap":{"Danylo Makarenko":68}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/course/bulk_import_projects/CourseProjectsImportGetCourseIdHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Danylo Makarenko"},"content":"package edu.kmaooad.app.course.bulk_import_projects;"},{"lineNumber":2,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":3,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":5,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.service.CourseService;"},{"lineNumber":7,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":8,"author":{"gitId":"Danylo Makarenko"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":9,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":10,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":11,"author":{"gitId":"Danylo Makarenko"},"content":"@Component"},{"lineNumber":12,"author":{"gitId":"Danylo Makarenko"},"content":"public class CourseProjectsImportGetCourseIdHandler implements Handler {"},{"lineNumber":13,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":14,"author":{"gitId":"Danylo Makarenko"},"content":"    private final TelegramService telegramService;"},{"lineNumber":15,"author":{"gitId":"Danylo Makarenko"},"content":"    private final CourseService courseService;"},{"lineNumber":16,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":17,"author":{"gitId":"Danylo Makarenko"},"content":"    public CourseProjectsImportGetCourseIdHandler(TelegramService telegramService, CourseService courseService) {"},{"lineNumber":18,"author":{"gitId":"Danylo Makarenko"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":19,"author":{"gitId":"Danylo Makarenko"},"content":"        this.courseService \u003d courseService;"},{"lineNumber":20,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":21,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":22,"author":{"gitId":"Danylo Makarenko"},"content":"    @Override"},{"lineNumber":23,"author":{"gitId":"Danylo Makarenko"},"content":"    public void handle(CallbackQuery callbackQuery, StateMachine stateMachine) {"},{"lineNumber":24,"author":{"gitId":"Danylo Makarenko"},"content":"        try {"},{"lineNumber":25,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":26,"author":{"gitId":"Danylo Makarenko"},"content":"            String courseId \u003d callbackQuery.getData();"},{"lineNumber":27,"author":{"gitId":"Danylo Makarenko"},"content":"            courseService.getCourse(courseId);"},{"lineNumber":28,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":29,"author":{"gitId":"Danylo Makarenko"},"content":"            stateMachine.updateStateData(callbackQuery.getMessage().getChatId(), CourseProjectsImport.GROUP, courseId);"},{"lineNumber":30,"author":{"gitId":"Danylo Makarenko"},"content":"            stateMachine.setState(callbackQuery.getMessage().getChatId(), CourseProjectsImport.GET_FILE);"},{"lineNumber":31,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":32,"author":{"gitId":"Danylo Makarenko"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Send csv file with projects in this format (title, description, requirements, time):\");"},{"lineNumber":33,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":34,"author":{"gitId":"Danylo Makarenko"},"content":"        } catch (Exception e) {"},{"lineNumber":35,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":36,"author":{"gitId":"Danylo Makarenko"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":37,"author":{"gitId":"Danylo Makarenko"},"content":"            telegramService.sendMessage(callbackQuery.getMessage().getChatId(), \"Incorrect id provided!\");"},{"lineNumber":38,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":39,"author":{"gitId":"Danylo Makarenko"},"content":"        }"},{"lineNumber":40,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":41,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":42,"author":{"gitId":"Danylo Makarenko"},"content":"    @Override"},{"lineNumber":43,"author":{"gitId":"Danylo Makarenko"},"content":"    public State getState() {"},{"lineNumber":44,"author":{"gitId":"Danylo Makarenko"},"content":"        return CourseProjectsImport.GET_COURSE_ID;"},{"lineNumber":45,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":46,"author":{"gitId":"Danylo Makarenko"},"content":"}"}],"authorContributionMap":{"Danylo Makarenko":46}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/app/course/bulk_import_projects/CourseProjectsImportHandler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Danylo Makarenko"},"content":"package edu.kmaooad.app.course.bulk_import_projects;"},{"lineNumber":2,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":3,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.app.activities.Utils;"},{"lineNumber":5,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":6,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":7,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":8,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.model.CourseEntity;"},{"lineNumber":9,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.service.CourseService;"},{"lineNumber":10,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":11,"author":{"gitId":"Danylo Makarenko"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":12,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":13,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.InlineKeyboardMarkup;"},{"lineNumber":14,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":15,"author":{"gitId":"Danylo Makarenko"},"content":"import java.util.List;"},{"lineNumber":16,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":17,"author":{"gitId":"Danylo Makarenko"},"content":"@Component"},{"lineNumber":18,"author":{"gitId":"Danylo Makarenko"},"content":"public class CourseProjectsImportHandler implements Handler {"},{"lineNumber":19,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":20,"author":{"gitId":"Danylo Makarenko"},"content":"    private final TelegramService telegramService;"},{"lineNumber":21,"author":{"gitId":"Danylo Makarenko"},"content":"    private final CourseService courseService;"},{"lineNumber":22,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":23,"author":{"gitId":"Danylo Makarenko"},"content":"    public CourseProjectsImportHandler(TelegramService telegramService, CourseService courseService) {"},{"lineNumber":24,"author":{"gitId":"Danylo Makarenko"},"content":"        this.telegramService \u003d telegramService;"},{"lineNumber":25,"author":{"gitId":"Danylo Makarenko"},"content":"        this.courseService \u003d courseService;"},{"lineNumber":26,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":27,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":28,"author":{"gitId":"Danylo Makarenko"},"content":"    @Override"},{"lineNumber":29,"author":{"gitId":"Danylo Makarenko"},"content":"    public void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":30,"author":{"gitId":"Danylo Makarenko"},"content":"        try {"},{"lineNumber":31,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":32,"author":{"gitId":"Danylo Makarenko"},"content":"            List\u003cCourseEntity\u003e entities \u003d courseService.getCourses();"},{"lineNumber":33,"author":{"gitId":"Danylo Makarenko"},"content":"            InlineKeyboardMarkup kb \u003d Utils.getCoursesKeyboard(entities);"},{"lineNumber":34,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":35,"author":{"gitId":"Danylo Makarenko"},"content":"            stateMachine.setState(message.getChatId(), CourseProjectsImport.GET_COURSE_ID);"},{"lineNumber":36,"author":{"gitId":"Danylo Makarenko"},"content":"            telegramService.sendMessage(message.getChatId(), \"Select course to update:\", kb);"},{"lineNumber":37,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":38,"author":{"gitId":"Danylo Makarenko"},"content":"        } catch (StateMachineException e) {"},{"lineNumber":39,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":40,"author":{"gitId":"Danylo Makarenko"},"content":"            System.err.println(e.getMessage());"},{"lineNumber":41,"author":{"gitId":"Danylo Makarenko"},"content":"            telegramService.sendMessage(message.getChatId(), \"Error occurred!\");"},{"lineNumber":42,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":43,"author":{"gitId":"Danylo Makarenko"},"content":"        }"},{"lineNumber":44,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":45,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":46,"author":{"gitId":"Danylo Makarenko"},"content":"    @Override"},{"lineNumber":47,"author":{"gitId":"Danylo Makarenko"},"content":"    public List\u003cString\u003e getCommands() {"},{"lineNumber":48,"author":{"gitId":"Danylo Makarenko"},"content":"        return List.of(\"import_course_project\");"},{"lineNumber":49,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":50,"author":{"gitId":"Danylo Makarenko"},"content":"}"}],"authorContributionMap":{"Danylo Makarenko":50}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/core/Dispatcher.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.core;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.session.ISessionService;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.session.UserSession;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.exception.IncorrectIdException;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"import java.util.ArrayList;"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"import java.util.List;"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"import java.util.Optional;"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":"public class Dispatcher {"},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":"    private final List\u003cHandler\u003e handlers \u003d new ArrayList\u003c\u003e();"},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":"    private final ISessionService sessionService;"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":"    private final StateMachine stateMachine;"},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"    public Dispatcher(StateMachine stateMachine, ISessionService sessionService) {"},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":"        this.stateMachine \u003d stateMachine;"},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":"        this.sessionService \u003d sessionService;"},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":"    public void registerHandler(Handler handler) {"},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":"        handlers.add(handler);"},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":31,"author":{"gitId":"VladKozyr"},"content":"    public boolean dispatch(Message message) {"},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":"        Optional\u003cHandler\u003e commandHandler \u003d handlers.stream()"},{"lineNumber":33,"author":{"gitId":"VladKozyr"},"content":"                .filter(h -\u003e h.getCommands() !\u003d null"},{"lineNumber":34,"author":{"gitId":"VladKozyr"},"content":"                        \u0026\u0026 h.getCommands().stream().anyMatch(c -\u003e (\"/\" + c).equalsIgnoreCase(message.getText())))"},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":"                .findFirst();"},{"lineNumber":36,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":37,"author":{"gitId":"VladKozyr"},"content":"        if (commandHandler.isPresent()) {"},{"lineNumber":38,"author":{"gitId":"VladKozyr"},"content":"            commandHandler.get().handle(message, stateMachine);"},{"lineNumber":39,"author":{"gitId":"VladKozyr"},"content":"            return true;"},{"lineNumber":40,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":41,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":"        Optional\u003cHandler\u003e stateHandler \u003d getHandlerByState(message.getChatId());"},{"lineNumber":43,"author":{"gitId":"VladKozyr"},"content":"        if (stateHandler.isPresent()) {"},{"lineNumber":44,"author":{"gitId":"VladKozyr"},"content":"            stateHandler.get().handle(message, stateMachine);"},{"lineNumber":45,"author":{"gitId":"VladKozyr"},"content":"            return true;"},{"lineNumber":46,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":47,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":48,"author":{"gitId":"VladKozyr"},"content":"        Optional\u003cHandler\u003e filterHandler \u003d handlers.stream()"},{"lineNumber":49,"author":{"gitId":"VladKozyr"},"content":"                .filter(h -\u003e h.getFilter() !\u003d null"},{"lineNumber":50,"author":{"gitId":"VladKozyr"},"content":"                        \u0026\u0026 h.getFilter().isApplicable(message))"},{"lineNumber":51,"author":{"gitId":"VladKozyr"},"content":"                .findFirst();"},{"lineNumber":52,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":53,"author":{"gitId":"VladKozyr"},"content":"        if (filterHandler.isPresent()) {"},{"lineNumber":54,"author":{"gitId":"VladKozyr"},"content":"            filterHandler.get().handle(message, stateMachine);"},{"lineNumber":55,"author":{"gitId":"VladKozyr"},"content":"            return true;"},{"lineNumber":56,"author":{"gitId":"VladKozyr"},"content":"        } else {"},{"lineNumber":57,"author":{"gitId":"VladKozyr"},"content":"            return false;"},{"lineNumber":58,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":59,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":60,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":61,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public boolean dispatch(CallbackQuery callbackQuery) {"},{"lineNumber":62,"author":{"gitId":"Dmytro Zhornyk"},"content":"        Optional\u003cHandler\u003e stateHandler \u003d getHandlerByState(callbackQuery.getMessage().getChatId());"},{"lineNumber":63,"author":{"gitId":"Dmytro Zhornyk"},"content":"        if (stateHandler.isPresent()) {"},{"lineNumber":64,"author":{"gitId":"Dmytro Zhornyk"},"content":"            stateHandler.get().handle(callbackQuery, stateMachine);"},{"lineNumber":65,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return true;"},{"lineNumber":66,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":67,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":68,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return false;"},{"lineNumber":69,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":70,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":71,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private Optional\u003cHandler\u003e getHandlerByState(Long chatId) {"},{"lineNumber":72,"author":{"gitId":"Dmytro Zhornyk"},"content":"        UserSession userSession \u003d sessionService"},{"lineNumber":73,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .getSessionByUserId(chatId)"},{"lineNumber":74,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .orElseGet(() -\u003e {"},{"lineNumber":75,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    try {"},{"lineNumber":76,"author":{"gitId":"Dmytro Zhornyk"},"content":"                        return sessionService.createSessionByUserId(chatId);"},{"lineNumber":77,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    } catch (IncorrectIdException e) {"},{"lineNumber":78,"author":{"gitId":"Dmytro Zhornyk"},"content":"                        throw new RuntimeException(e);"},{"lineNumber":79,"author":{"gitId":"Dmytro Zhornyk"},"content":"                    }"},{"lineNumber":80,"author":{"gitId":"Dmytro Zhornyk"},"content":"                });"},{"lineNumber":81,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":82,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return handlers.stream()"},{"lineNumber":83,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .filter(h -\u003e h.getState() !\u003d null"},{"lineNumber":84,"author":{"gitId":"Dmytro Zhornyk"},"content":"                        \u0026\u0026 h.getState().key().equalsIgnoreCase(userSession.currentState()))"},{"lineNumber":85,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .findFirst();"},{"lineNumber":86,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":87,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":58,"Dmytro Zhornyk":29}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/core/Handler.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.core;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.filters.Filter;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"import java.util.ArrayList;"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"import java.util.List;"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"public interface Handler {"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":"    default void handle(Message message, StateMachine stateMachine) {"},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"    default void handle(CallbackQuery callbackQuery, StateMachine stateMachine) {"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"    default List\u003cString\u003e getCommands() {"},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":"        return new ArrayList\u003c\u003e();"},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":"    default State getState() {"},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":"        return new State.Any();"},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":"    default Filter getFilter() {"},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":"        return null;"},{"lineNumber":31,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":26,"Dmytro Zhornyk":6}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/core/StateMachineException.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.core;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"public class StateMachineException extends Exception {"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"    public StateMachineException(String message) {"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"        super(message);"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":7}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/core/filters/Filter.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.core.filters;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"public interface Filter {"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"    boolean isApplicable(Message message);"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":8}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/core/filters/TextFilter.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.core.filters;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"record TextFilter(String text) implements Filter {"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"    public boolean isApplicable(Message message) {"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"        return message.getText().equalsIgnoreCase(text);"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":11}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/core/session/ISessionService.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.core.session;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.exception.IncorrectIdException;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import java.util.Optional;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"public interface ISessionService {"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"    Optional\u003cUserSession\u003e getSessionByUserId(Long userId);"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"    UserSession createSessionByUserId(Long userId) throws IncorrectIdException;"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":"    UserSession clearSessionByUserId(Long userId) throws IncorrectIdException;"},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":"    UserSession updateSessionState(Long userId, State state) throws IncorrectIdException;"},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":"    UserSession updateGroupStatePayload(Long userId, State.Group group, String payload) throws IncorrectIdException;"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"    String getGroupStatePayload(Long userId, State.Group group) throws IncorrectIdException;"},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":21}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/core/session/UserSession.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.core.session;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import java.util.Map;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"public record UserSession("},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"        Long id,"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"        String currentState,"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"        Map\u003cString, String\u003e statesPayload"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":") {"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":10}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/core/state/State.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.core.state;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"public interface State {"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"    default String key() {"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"        return getClass().getName();"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"    interface Group {"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"        default String group() {"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"            return getClass().getName();"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":"    record Any() implements State {"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":17}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/core/state/StateMachine.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.core.state;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import java.util.Optional;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"public interface StateMachine {"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"    void updateStateData(Long userId, State.Group group, Object obj) throws StateMachineException;"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"    \u003cPAYLOAD\u003e Optional\u003cPAYLOAD\u003e getStatePayload(Long userId, State.Group group, Class\u003cPAYLOAD\u003e payloadClass);"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":"    void setState(Long userId, State state) throws StateMachineException;"},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":14}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/dto/ActivityDto.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.dto;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import com.fasterxml.jackson.annotation.JsonProperty;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import lombok.*;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Getter"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Setter"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"@NoArgsConstructor"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"@AllArgsConstructor"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityDto {"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @JsonProperty(\"owner_id\")"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String ownerId;"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @JsonProperty(\"title\")"},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String title;"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @JsonProperty(\"description\")"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String description;"},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @JsonProperty(\"date\")"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String date;"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @JsonProperty(\"time\")"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String time;"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @JsonProperty(\"location\")"},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String location;"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Dmytro Zhornyk":28}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/dto/ActivityUpdateDto.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.dto;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import com.fasterxml.jackson.annotation.JsonProperty;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import lombok.*;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import java.util.List;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Getter"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Setter"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"@NoArgsConstructor"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"@AllArgsConstructor"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityUpdateDto {"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @JsonProperty(\"activity_id\")"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String activityId;"},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @JsonProperty(\"field\")"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String field;"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @JsonProperty(\"value\")"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String value;"},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":"    @JsonProperty(\"array\")"},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":"    private List\u003cString\u003e array;"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Stas Boguta":5,"Dmytro Zhornyk":19}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/dto/BotUpdateResult.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"package edu.kmaooad.dto;"},{"lineNumber":2,"author":{"gitId":"-"},"content":""},{"lineNumber":3,"author":{"gitId":"-"},"content":"//TODO: refactor to generic result wrapper"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"public record BotUpdateResult(Integer messageId, String errorMessage) {"},{"lineNumber":5,"author":{"gitId":"-"},"content":""},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"    public static BotUpdateResult Ok(Integer messageId) {"},{"lineNumber":7,"author":{"gitId":"-"},"content":"        return new BotUpdateResult(messageId, null);"},{"lineNumber":8,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":9,"author":{"gitId":"-"},"content":""},{"lineNumber":10,"author":{"gitId":"-"},"content":"    public static BotUpdateResult Error(String errorMessage) {"},{"lineNumber":11,"author":{"gitId":"-"},"content":"        return new BotUpdateResult(null, errorMessage);"},{"lineNumber":12,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":13,"author":{"gitId":"-"},"content":"}"}],"authorContributionMap":{"VladKozyr":2,"-":11}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/dto/CompetenceUpdateDto.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.dto;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import com.fasterxml.jackson.annotation.JsonProperty;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import lombok.*;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import java.util.List;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"@Getter"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"@Setter"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"@Builder"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"@NoArgsConstructor"},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"@AllArgsConstructor"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceUpdateDto {"},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":"    @JsonProperty(\"activity\")"},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":"    private ActivityUpdateDto activityUpdateDto;"},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":"    @JsonProperty(\"competence\")"},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":"    private String competence;"},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":"    @JsonProperty(\"entity\")"},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":"    private ActivityEntity entity;"},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":"}"}],"authorContributionMap":{"Stas Boguta":23}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/dto/CourseDto.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.dto;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import com.fasterxml.jackson.annotation.JsonProperty;"},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":"import com.opencsv.bean.CsvBindByName;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import lombok.*;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"@Getter"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"@Setter"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"@NoArgsConstructor"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"@AllArgsConstructor"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"public class CourseDto {"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":"    @JsonProperty(\"title\")"},{"lineNumber":14,"author":{"gitId":"Danylo Makarenko"},"content":"    @CsvBindByName"},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":"    private String title;"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":"    @JsonProperty(\"description\")"},{"lineNumber":18,"author":{"gitId":"Danylo Makarenko"},"content":"    @CsvBindByName"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":"    private String description;"},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":17,"Danylo Makarenko":3}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/dto/CourseProjectDto.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Danylo Makarenko"},"content":"package edu.kmaooad.dto;"},{"lineNumber":2,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":3,"author":{"gitId":"Danylo Makarenko"},"content":"import com.fasterxml.jackson.annotation.JsonProperty;"},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":"import com.opencsv.bean.CsvBindByName;"},{"lineNumber":5,"author":{"gitId":"Danylo Makarenko"},"content":"import lombok.*;"},{"lineNumber":6,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":7,"author":{"gitId":"Danylo Makarenko"},"content":"@Getter"},{"lineNumber":8,"author":{"gitId":"Danylo Makarenko"},"content":"@Setter"},{"lineNumber":9,"author":{"gitId":"Danylo Makarenko"},"content":"@NoArgsConstructor"},{"lineNumber":10,"author":{"gitId":"Danylo Makarenko"},"content":"@AllArgsConstructor"},{"lineNumber":11,"author":{"gitId":"Danylo Makarenko"},"content":"public class CourseProjectDto {"},{"lineNumber":12,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":13,"author":{"gitId":"Danylo Makarenko"},"content":"    @JsonProperty"},{"lineNumber":14,"author":{"gitId":"Danylo Makarenko"},"content":"    @CsvBindByName"},{"lineNumber":15,"author":{"gitId":"Danylo Makarenko"},"content":"    private String title;"},{"lineNumber":16,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":17,"author":{"gitId":"Danylo Makarenko"},"content":"    @JsonProperty"},{"lineNumber":18,"author":{"gitId":"Danylo Makarenko"},"content":"    @CsvBindByName"},{"lineNumber":19,"author":{"gitId":"Danylo Makarenko"},"content":"    private String description;"},{"lineNumber":20,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":21,"author":{"gitId":"Danylo Makarenko"},"content":"    @JsonProperty"},{"lineNumber":22,"author":{"gitId":"Danylo Makarenko"},"content":"    @CsvBindByName"},{"lineNumber":23,"author":{"gitId":"Danylo Makarenko"},"content":"    private String requirements;"},{"lineNumber":24,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":25,"author":{"gitId":"Danylo Makarenko"},"content":"    @JsonProperty"},{"lineNumber":26,"author":{"gitId":"Danylo Makarenko"},"content":"    @CsvBindByName"},{"lineNumber":27,"author":{"gitId":"Danylo Makarenko"},"content":"    private String time;"},{"lineNumber":28,"author":{"gitId":"Danylo Makarenko"},"content":"}"}],"authorContributionMap":{"Danylo Makarenko":28}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/exception/IncorrectIdException.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.exception;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"public class IncorrectIdException extends Exception {"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"    public static final String MESSAGE \u003d \"Incorrect entity id\";"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"    public IncorrectIdException() {"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"        super(MESSAGE);"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"}"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":""}],"authorContributionMap":{"VladKozyr":11}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/model/ActivityEntity.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.model;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import lombok.AllArgsConstructor;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import lombok.Data;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import lombok.NoArgsConstructor;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.data.annotation.Id;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.data.mongodb.core.mapping.Document;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.data.mongodb.core.mapping.Field;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import java.util.List;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Data"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"@NoArgsConstructor"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":"@AllArgsConstructor"},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Document(collection \u003d \"activities\")"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityEntity {"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Id"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String id;"},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Field(\"owner_id\")"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String ownerId;"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Field(\"title\")"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String title;"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Field(\"description\")"},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String description;"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Field(\"date\")"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String date;"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Field(\"time\")"},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String time;"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Field(\"location\")"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private String location;"},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":"    @Field(\"competences\")"},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":"    private List\u003cString\u003e competences;"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Stas Boguta":5,"Dmytro Zhornyk":35}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/model/CourseEntity.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.model;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import lombok.AllArgsConstructor;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import lombok.Data;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import lombok.NoArgsConstructor;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.data.annotation.Id;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.data.mongodb.core.mapping.Document;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.data.mongodb.core.mapping.Field;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":10,"author":{"gitId":"Danylo Makarenko"},"content":"import java.util.ArrayList;"},{"lineNumber":11,"author":{"gitId":"Danylo Makarenko"},"content":"import java.util.List;"},{"lineNumber":12,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":"@Data"},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":"@NoArgsConstructor"},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":"@AllArgsConstructor"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":"@Document(collection \u003d \"courses\")"},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":"public class CourseEntity {"},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":"    @Id"},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"    private String id;"},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":"    @Field(\"course_title\")"},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":"    private String title;"},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":"    @Field(\"course_description\")"},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":"    private String description;"},{"lineNumber":27,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":28,"author":{"gitId":"Danylo Makarenko"},"content":"    @Field(\"course_projects\")"},{"lineNumber":29,"author":{"gitId":"Danylo Makarenko"},"content":"    private List\u003cCourseProjectEntity\u003e projects \u003d new ArrayList\u003c\u003e();"},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":24,"Danylo Makarenko":6}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/model/CourseProjectEntity.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Danylo Makarenko"},"content":"package edu.kmaooad.model;"},{"lineNumber":2,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":3,"author":{"gitId":"Danylo Makarenko"},"content":"import lombok.AllArgsConstructor;"},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":"import lombok.Data;"},{"lineNumber":5,"author":{"gitId":"Danylo Makarenko"},"content":"import lombok.NoArgsConstructor;"},{"lineNumber":6,"author":{"gitId":"Danylo Makarenko"},"content":"import org.springframework.data.annotation.Id;"},{"lineNumber":7,"author":{"gitId":"Danylo Makarenko"},"content":"import org.springframework.data.mongodb.core.mapping.Document;"},{"lineNumber":8,"author":{"gitId":"Danylo Makarenko"},"content":"import org.springframework.data.mongodb.core.mapping.Field;"},{"lineNumber":9,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":10,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":11,"author":{"gitId":"Danylo Makarenko"},"content":"@Data"},{"lineNumber":12,"author":{"gitId":"Danylo Makarenko"},"content":"@NoArgsConstructor"},{"lineNumber":13,"author":{"gitId":"Danylo Makarenko"},"content":"@AllArgsConstructor"},{"lineNumber":14,"author":{"gitId":"Danylo Makarenko"},"content":"@Document(collection \u003d \"courses\")"},{"lineNumber":15,"author":{"gitId":"Danylo Makarenko"},"content":"public class CourseProjectEntity {"},{"lineNumber":16,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":17,"author":{"gitId":"Danylo Makarenko"},"content":"    @Id"},{"lineNumber":18,"author":{"gitId":"Danylo Makarenko"},"content":"    private String id;"},{"lineNumber":19,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":20,"author":{"gitId":"Danylo Makarenko"},"content":"    @Field(\"project_title\")"},{"lineNumber":21,"author":{"gitId":"Danylo Makarenko"},"content":"    private String title;"},{"lineNumber":22,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":23,"author":{"gitId":"Danylo Makarenko"},"content":"    @Field(\"project_description\")"},{"lineNumber":24,"author":{"gitId":"Danylo Makarenko"},"content":"    private String description;"},{"lineNumber":25,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":26,"author":{"gitId":"Danylo Makarenko"},"content":"    @Field(\"project_requirements\")"},{"lineNumber":27,"author":{"gitId":"Danylo Makarenko"},"content":"    private String requirements;"},{"lineNumber":28,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":29,"author":{"gitId":"Danylo Makarenko"},"content":"    @Field(\"project_deadline\")"},{"lineNumber":30,"author":{"gitId":"Danylo Makarenko"},"content":"    private String time;"},{"lineNumber":31,"author":{"gitId":"Danylo Makarenko"},"content":"}"}],"authorContributionMap":{"Danylo Makarenko":31}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/model/SessionEntity.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.model;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import lombok.AllArgsConstructor;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import lombok.Data;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import lombok.NoArgsConstructor;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import lombok.Setter;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.data.annotation.Id;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.data.mongodb.core.mapping.Document;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.data.mongodb.core.mapping.Field;"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"import java.util.HashMap;"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"import java.util.Map;"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":"@Data"},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":"@Setter"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":"@NoArgsConstructor"},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":"@AllArgsConstructor"},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":"@Document(collection \u003d \"sessions\")"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":"public class SessionEntity {"},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"    @Id"},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":"    private Long userId;"},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":"    @Field(\"state\")"},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":"    private String state;"},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":"    @Field(\"payload\")"},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":"    private Map\u003cString, String\u003e payload \u003d new HashMap\u003c\u003e();"},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":"}"},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":""}],"authorContributionMap":{"VladKozyr":30}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/repository/ActivityRepository.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.repository;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.data.mongodb.repository.MongoRepository;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.List;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import java.util.Optional;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"public interface ActivityRepository extends MongoRepository\u003cActivityEntity, String\u003e {"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"    List\u003cActivityEntity\u003e findByOwnerId(String ownerId);"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Stas Boguta":1,"Dmytro Zhornyk":10}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/repository/CourseRepository.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.repository;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.model.CourseEntity;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.data.mongodb.repository.MongoRepository;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"public interface CourseRepository extends MongoRepository\u003cCourseEntity, String\u003e {"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":7}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/repository/SessionRepository.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.repository;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.model.SessionEntity;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.data.mongodb.repository.MongoRepository;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"public interface SessionRepository extends MongoRepository\u003cSessionEntity, Long\u003e {"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":7}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/service/ActivityService.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.service;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.ActivityDto;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.exception.IncorrectIdException;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.repository.ActivityRepository;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import org.json.JSONArray;"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.json.JSONObject;"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.data.mongodb.core.aggregation.ArrayOperators;"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.data.mongodb.core.query.BasicQuery;"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.springframework.stereotype.Service;"},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.List;"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.function.Predicate;"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"@Service"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityService {"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityRepository activityRepository;"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public ActivityService(ActivityRepository activityRepository) {"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":"        this.activityRepository \u003d activityRepository;"},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public List\u003cActivityEntity\u003e getActivities() {"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return activityRepository.findAll();"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public void createActivity(ActivityDto dto) {"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"        ActivityEntity activity \u003d new ActivityEntity();"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activity.setOwnerId(dto.getOwnerId());"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activity.setTitle(dto.getTitle());"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activity.setDescription(dto.getDescription());"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activity.setDate(dto.getDate());"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activity.setTime(dto.getTime());"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activity.setLocation(dto.getLocation());"},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityRepository.save(activity);"},{"lineNumber":44,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":45,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":46,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public ActivityEntity updateActivity(ActivityUpdateDto dto) throws IncorrectIdException, JsonProcessingException {"},{"lineNumber":47,"author":{"gitId":"Dmytro Zhornyk"},"content":"        ActivityEntity activity \u003d activityRepository"},{"lineNumber":48,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .findById(dto.getActivityId())"},{"lineNumber":49,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .orElseThrow(IncorrectIdException::new);"},{"lineNumber":50,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":51,"author":{"gitId":"Dmytro Zhornyk"},"content":"        ObjectMapper objectMapper \u003d new ObjectMapper();"},{"lineNumber":52,"author":{"gitId":"Dmytro Zhornyk"},"content":"        String json \u003d objectMapper.writeValueAsString(activity);"},{"lineNumber":53,"author":{"gitId":"Dmytro Zhornyk"},"content":"        JSONObject jsonObject \u003d new JSONObject(json);"},{"lineNumber":54,"author":{"gitId":"Stas Boguta"},"content":"        if(dto.getField().equals(\"competences\")){"},{"lineNumber":55,"author":{"gitId":"Stas Boguta"},"content":"            JSONArray array \u003d new JSONArray();"},{"lineNumber":56,"author":{"gitId":"Stas Boguta"},"content":"            for(String competence : dto.getArray()){"},{"lineNumber":57,"author":{"gitId":"Stas Boguta"},"content":"                array.put(competence);"},{"lineNumber":58,"author":{"gitId":"Stas Boguta"},"content":"            }"},{"lineNumber":59,"author":{"gitId":"Stas Boguta"},"content":"            jsonObject.put(dto.getField(), array);"},{"lineNumber":60,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":61,"author":{"gitId":"Stas Boguta"},"content":"        else{"},{"lineNumber":62,"author":{"gitId":"Dmytro Zhornyk"},"content":"            jsonObject.put(dto.getField(), dto.getValue());"},{"lineNumber":63,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":64,"author":{"gitId":"Dmytro Zhornyk"},"content":"        ActivityEntity activityUpdated \u003d objectMapper.readValue(jsonObject.toString(), ActivityEntity.class);"},{"lineNumber":65,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return activityRepository.save(activityUpdated);"},{"lineNumber":66,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":67,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":68,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public void deleteActivity(String id) {"},{"lineNumber":69,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityRepository.deleteById(id);"},{"lineNumber":70,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":71,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":72,"author":{"gitId":"Dmytro Zhornyk"},"content":"    public List\u003cActivityEntity\u003e getUserActivities(String userId) {"},{"lineNumber":73,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return activityRepository.findByOwnerId(userId);"},{"lineNumber":74,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":75,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"},{"lineNumber":76,"author":{"gitId":"Dmytro Zhornyk"},"content":""}],"authorContributionMap":{"Stas Boguta":10,"Dmytro Zhornyk":66}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/service/CourseService.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.service;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.dto.CourseDto;"},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.dto.CourseProjectDto;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.exception.IncorrectIdException;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.model.CourseEntity;"},{"lineNumber":7,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.model.CourseProjectEntity;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.repository.CourseRepository;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.stereotype.Service;"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"import java.util.List;"},{"lineNumber":12,"author":{"gitId":"Danylo Makarenko"},"content":"import java.util.stream.Stream;"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":"@Service"},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":"public class CourseService {"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":"    private final CourseRepository courseRepository;"},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"    public CourseService(CourseRepository courseRepository) {"},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"        this.courseRepository \u003d courseRepository;"},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":"    public List\u003cCourseEntity\u003e getCourses() {"},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":"        return courseRepository.findAll();"},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":28,"author":{"gitId":"Danylo Makarenko"},"content":"    public CourseEntity getCourse(String id) throws IncorrectIdException {"},{"lineNumber":29,"author":{"gitId":"Danylo Makarenko"},"content":"        return courseRepository"},{"lineNumber":30,"author":{"gitId":"Danylo Makarenko"},"content":"                .findById(id)"},{"lineNumber":31,"author":{"gitId":"Danylo Makarenko"},"content":"                .orElseThrow(IncorrectIdException::new);"},{"lineNumber":32,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":33,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":34,"author":{"gitId":"VladKozyr"},"content":"    public CourseEntity createCourse(CourseDto courseDto) {"},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":"        CourseEntity course \u003d new CourseEntity();"},{"lineNumber":36,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":37,"author":{"gitId":"VladKozyr"},"content":"        course.setTitle(courseDto.getTitle());"},{"lineNumber":38,"author":{"gitId":"VladKozyr"},"content":"        course.setDescription(courseDto.getDescription());"},{"lineNumber":39,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":40,"author":{"gitId":"VladKozyr"},"content":"        return courseRepository.save(course);"},{"lineNumber":41,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":42,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":43,"author":{"gitId":"VladKozyr"},"content":"    public CourseEntity updateCourse(String id, CourseDto courseDto) throws IncorrectIdException {"},{"lineNumber":44,"author":{"gitId":"VladKozyr"},"content":"        CourseEntity course \u003d courseRepository"},{"lineNumber":45,"author":{"gitId":"VladKozyr"},"content":"                .findById(id)"},{"lineNumber":46,"author":{"gitId":"VladKozyr"},"content":"                .orElseThrow(IncorrectIdException::new);"},{"lineNumber":47,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":48,"author":{"gitId":"VladKozyr"},"content":"        course.setTitle(courseDto.getTitle());"},{"lineNumber":49,"author":{"gitId":"VladKozyr"},"content":"        course.setDescription(courseDto.getDescription());"},{"lineNumber":50,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":51,"author":{"gitId":"VladKozyr"},"content":"        return courseRepository.save(course);"},{"lineNumber":52,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":53,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":54,"author":{"gitId":"Danylo Makarenko"},"content":"    public CourseEntity addCourseProjects(String id, List\u003cCourseProjectDto\u003e courseProjectDtoList) throws IncorrectIdException {"},{"lineNumber":55,"author":{"gitId":"Danylo Makarenko"},"content":"        CourseEntity course \u003d courseRepository"},{"lineNumber":56,"author":{"gitId":"Danylo Makarenko"},"content":"                .findById(id)"},{"lineNumber":57,"author":{"gitId":"Danylo Makarenko"},"content":"                .orElseThrow(IncorrectIdException::new);"},{"lineNumber":58,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":59,"author":{"gitId":"Danylo Makarenko"},"content":"        List\u003cCourseProjectEntity\u003e courseProjectEntityList \u003d"},{"lineNumber":60,"author":{"gitId":"Danylo Makarenko"},"content":"                Stream.concat(courseProjectDtoList.stream()"},{"lineNumber":61,"author":{"gitId":"Danylo Makarenko"},"content":"                                .map(dto -\u003e {"},{"lineNumber":62,"author":{"gitId":"Danylo Makarenko"},"content":"                                    CourseProjectEntity entity \u003d new CourseProjectEntity();"},{"lineNumber":63,"author":{"gitId":"Danylo Makarenko"},"content":"                                    entity.setTitle(dto.getTitle());"},{"lineNumber":64,"author":{"gitId":"Danylo Makarenko"},"content":"                                    entity.setDescription(dto.getDescription());"},{"lineNumber":65,"author":{"gitId":"Danylo Makarenko"},"content":"                                    entity.setRequirements(dto.getRequirements());"},{"lineNumber":66,"author":{"gitId":"Danylo Makarenko"},"content":"                                    entity.setTime(dto.getTime());"},{"lineNumber":67,"author":{"gitId":"Danylo Makarenko"},"content":"                                    return entity;"},{"lineNumber":68,"author":{"gitId":"Danylo Makarenko"},"content":"                                }),"},{"lineNumber":69,"author":{"gitId":"Danylo Makarenko"},"content":"                        course.getProjects().stream()"},{"lineNumber":70,"author":{"gitId":"Danylo Makarenko"},"content":"                ).toList();"},{"lineNumber":71,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":72,"author":{"gitId":"Danylo Makarenko"},"content":"        course.setProjects(courseProjectEntityList);"},{"lineNumber":73,"author":{"gitId":"Danylo Makarenko"},"content":"        return courseRepository.save(course);"},{"lineNumber":74,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":75,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":76,"author":{"gitId":"VladKozyr"},"content":"    public void deleteCourse(String id) {"},{"lineNumber":77,"author":{"gitId":"VladKozyr"},"content":"        courseRepository.deleteById(id);"},{"lineNumber":78,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":79,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":48,"Danylo Makarenko":31}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/service/SessionService.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.service;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.session.ISessionService;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.session.UserSession;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.exception.IncorrectIdException;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.model.SessionEntity;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.repository.SessionRepository;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.stereotype.Service;"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"import java.util.HashMap;"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"import java.util.Map;"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":"import java.util.Optional;"},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":"@Service"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":"public class SessionService implements ISessionService {"},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":"    private final SessionRepository sessionRepository;"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"    public SessionService(SessionRepository sessionRepository) {"},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"        this.sessionRepository \u003d sessionRepository;"},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":"    public Optional\u003cUserSession\u003e getSessionByUserId(Long userId) {"},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":"        Optional\u003cSessionEntity\u003e session \u003d sessionRepository"},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":"                .findById(userId);"},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":"        if (session.isPresent()) {"},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":31,"author":{"gitId":"VladKozyr"},"content":"            SessionEntity sessionEntity \u003d session.get();"},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":"            UserSession userSession \u003d new UserSession("},{"lineNumber":33,"author":{"gitId":"VladKozyr"},"content":"                    sessionEntity.getUserId(),"},{"lineNumber":34,"author":{"gitId":"VladKozyr"},"content":"                    sessionEntity.getState(),"},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":"                    sessionEntity.getPayload());"},{"lineNumber":36,"author":{"gitId":"VladKozyr"},"content":"            return Optional.of(userSession);"},{"lineNumber":37,"author":{"gitId":"VladKozyr"},"content":"        } else {"},{"lineNumber":38,"author":{"gitId":"VladKozyr"},"content":"            return Optional.empty();"},{"lineNumber":39,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":40,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":41,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":42,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":43,"author":{"gitId":"VladKozyr"},"content":"    public UserSession createSessionByUserId(Long userId) throws IncorrectIdException {"},{"lineNumber":44,"author":{"gitId":"VladKozyr"},"content":"        Optional\u003cSessionEntity\u003e session \u003d sessionRepository.findById(userId);"},{"lineNumber":45,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":46,"author":{"gitId":"VladKozyr"},"content":"        if (session.isPresent()) throw new IncorrectIdException();"},{"lineNumber":47,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":48,"author":{"gitId":"VladKozyr"},"content":"        Map\u003cString, String\u003e map \u003d new HashMap\u003c\u003e();"},{"lineNumber":49,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity sessionEntity \u003d sessionRepository.save(new SessionEntity(userId, new State.Any().key(), map));"},{"lineNumber":50,"author":{"gitId":"VladKozyr"},"content":"        return new UserSession(sessionEntity.getUserId(), sessionEntity.getState(), sessionEntity.getPayload());"},{"lineNumber":51,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":52,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":53,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":54,"author":{"gitId":"VladKozyr"},"content":"    public UserSession clearSessionByUserId(Long userId) throws IncorrectIdException {"},{"lineNumber":55,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity session \u003d sessionRepository"},{"lineNumber":56,"author":{"gitId":"VladKozyr"},"content":"                .findById(userId)"},{"lineNumber":57,"author":{"gitId":"VladKozyr"},"content":"                .orElseThrow(IncorrectIdException::new);"},{"lineNumber":58,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":59,"author":{"gitId":"VladKozyr"},"content":"        session.setState(new State.Any().key());"},{"lineNumber":60,"author":{"gitId":"VladKozyr"},"content":"        session.setPayload(new HashMap\u003c\u003e());"},{"lineNumber":61,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity clearedSession \u003d sessionRepository.save(session);"},{"lineNumber":62,"author":{"gitId":"VladKozyr"},"content":"        return new UserSession(clearedSession.getUserId(), clearedSession.getState(), clearedSession.getPayload());"},{"lineNumber":63,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":64,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":65,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":66,"author":{"gitId":"VladKozyr"},"content":"    public UserSession updateSessionState(Long userId, State state) throws IncorrectIdException {"},{"lineNumber":67,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity session \u003d sessionRepository"},{"lineNumber":68,"author":{"gitId":"VladKozyr"},"content":"                .findById(userId)"},{"lineNumber":69,"author":{"gitId":"VladKozyr"},"content":"                .orElseThrow(IncorrectIdException::new);"},{"lineNumber":70,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":71,"author":{"gitId":"VladKozyr"},"content":"        session.setState(state.key());"},{"lineNumber":72,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity clearedSession \u003d sessionRepository.save(session);"},{"lineNumber":73,"author":{"gitId":"VladKozyr"},"content":"        return new UserSession(clearedSession.getUserId(), clearedSession.getState(), clearedSession.getPayload());"},{"lineNumber":74,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":75,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":76,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":77,"author":{"gitId":"VladKozyr"},"content":"    public UserSession updateGroupStatePayload(Long userId, State.Group group, String payload) throws IncorrectIdException {"},{"lineNumber":78,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity session \u003d sessionRepository"},{"lineNumber":79,"author":{"gitId":"VladKozyr"},"content":"                .findById(userId)"},{"lineNumber":80,"author":{"gitId":"VladKozyr"},"content":"                .orElseThrow(IncorrectIdException::new);"},{"lineNumber":81,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":82,"author":{"gitId":"VladKozyr"},"content":"        Map\u003cString, String\u003e payloadMap \u003d session.getPayload();"},{"lineNumber":83,"author":{"gitId":"VladKozyr"},"content":"        payloadMap.put(group.group(), payload);"},{"lineNumber":84,"author":{"gitId":"VladKozyr"},"content":"        session.setPayload(payloadMap);"},{"lineNumber":85,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":86,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity clearedSession \u003d sessionRepository.save(session);"},{"lineNumber":87,"author":{"gitId":"VladKozyr"},"content":"        return new UserSession(clearedSession.getUserId(), clearedSession.getState(), clearedSession.getPayload());"},{"lineNumber":88,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":89,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":90,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":91,"author":{"gitId":"VladKozyr"},"content":"    public String getGroupStatePayload(Long userId, State.Group group) throws IncorrectIdException {"},{"lineNumber":92,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity session \u003d sessionRepository"},{"lineNumber":93,"author":{"gitId":"VladKozyr"},"content":"                .findById(userId)"},{"lineNumber":94,"author":{"gitId":"VladKozyr"},"content":"                .orElseThrow(IncorrectIdException::new);"},{"lineNumber":95,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":96,"author":{"gitId":"VladKozyr"},"content":"        Map\u003cString, String\u003e payloadMap \u003d session.getPayload();"},{"lineNumber":97,"author":{"gitId":"VladKozyr"},"content":"        return payloadMap.get(group.group());"},{"lineNumber":98,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":99,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":99}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/telegram/TelegramApi.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.telegram;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.stereotype.Component;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.bots.DefaultAbsSender;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.bots.DefaultBotOptions;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.beans.factory.annotation.Value;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"@Component"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"public class TelegramApi extends DefaultAbsSender {"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"    @Value(\"${bot.token}\")"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"    private String botToken;"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":"    protected TelegramApi() {"},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":"        super(new DefaultBotOptions());"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":"    @Override"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":"    public String getBotToken() {"},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"        return botToken;"},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":22}},{"path":"kmaooad-functions/src/main/java/edu/kmaooad/telegram/TelegramService.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.telegram;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"Danylo Makarenko"},"content":"import org.apache.commons.io.FileUtils;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.stereotype.Service;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.methods.BotApiMethod;"},{"lineNumber":6,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.methods.GetFile;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.methods.ParseMode;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.methods.send.SendMessage;"},{"lineNumber":9,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.File;"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.ReplyKeyboard;"},{"lineNumber":12,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.exceptions.TelegramApiException;"},{"lineNumber":13,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":14,"author":{"gitId":"Danylo Makarenko"},"content":"import java.io.IOException;"},{"lineNumber":15,"author":{"gitId":"Danylo Makarenko"},"content":"import java.io.InputStream;"},{"lineNumber":16,"author":{"gitId":"Danylo Makarenko"},"content":"import java.net.URL;"},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":"@Service"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":"public class TelegramService {"},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"    private final TelegramApi telegramApi;"},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":"    public TelegramService(TelegramApi telegramApi) {"},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":"        this.telegramApi \u003d telegramApi;"},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":"    public void sendMessage(Long chatId, String text) {"},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":"        sendMessage(chatId, text, null);"},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":31,"author":{"gitId":"VladKozyr"},"content":"    public void sendMessage(Long chatId, String text, ReplyKeyboard replyKeyboard) {"},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":"        SendMessage sendMessage \u003d SendMessage"},{"lineNumber":33,"author":{"gitId":"VladKozyr"},"content":"                .builder()"},{"lineNumber":34,"author":{"gitId":"VladKozyr"},"content":"                .text(text)"},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":"                .chatId(chatId.toString())"},{"lineNumber":36,"author":{"gitId":"VladKozyr"},"content":"                //Other possible parse modes: MARKDOWNV2, MARKDOWN, which allows to make text bold, and all other things"},{"lineNumber":37,"author":{"gitId":"VladKozyr"},"content":"                .parseMode(ParseMode.HTML)"},{"lineNumber":38,"author":{"gitId":"VladKozyr"},"content":"                .replyMarkup(replyKeyboard)"},{"lineNumber":39,"author":{"gitId":"VladKozyr"},"content":"                .build();"},{"lineNumber":40,"author":{"gitId":"VladKozyr"},"content":"        execute(sendMessage);"},{"lineNumber":41,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":42,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":43,"author":{"gitId":"Danylo Makarenko"},"content":"    public File getFile(GetFile getFile) {"},{"lineNumber":44,"author":{"gitId":"Danylo Makarenko"},"content":"        try {"},{"lineNumber":45,"author":{"gitId":"Danylo Makarenko"},"content":"            return telegramApi.execute(getFile);"},{"lineNumber":46,"author":{"gitId":"Danylo Makarenko"},"content":"        } catch (TelegramApiException e) {"},{"lineNumber":47,"author":{"gitId":"Danylo Makarenko"},"content":"            throw new RuntimeException(e);"},{"lineNumber":48,"author":{"gitId":"Danylo Makarenko"},"content":"        }"},{"lineNumber":49,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":50,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":51,"author":{"gitId":"Danylo Makarenko"},"content":"    public java.io.File downloadFile(File file, String fileName) {"},{"lineNumber":52,"author":{"gitId":"Danylo Makarenko"},"content":"        java.io.File localFile \u003d new java.io.File(\"src/main/resources/files/\" + fileName);"},{"lineNumber":53,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":54,"author":{"gitId":"Danylo Makarenko"},"content":"        try (InputStream is \u003d new URL(file.getFileUrl(telegramApi.getBotToken()))"},{"lineNumber":55,"author":{"gitId":"Danylo Makarenko"},"content":"                .openStream()) {"},{"lineNumber":56,"author":{"gitId":"Danylo Makarenko"},"content":"            FileUtils.copyInputStreamToFile(is, localFile);"},{"lineNumber":57,"author":{"gitId":"Danylo Makarenko"},"content":"        } catch (IOException e) {"},{"lineNumber":58,"author":{"gitId":"Danylo Makarenko"},"content":"            throw new RuntimeException(e);"},{"lineNumber":59,"author":{"gitId":"Danylo Makarenko"},"content":"        }"},{"lineNumber":60,"author":{"gitId":"Danylo Makarenko"},"content":"        return localFile;"},{"lineNumber":61,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":62,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":63,"author":{"gitId":"VladKozyr"},"content":"    private void execute(BotApiMethod\u003cMessage\u003e botApiMethod) {"},{"lineNumber":64,"author":{"gitId":"VladKozyr"},"content":"        try {"},{"lineNumber":65,"author":{"gitId":"VladKozyr"},"content":"            telegramApi.execute(botApiMethod);"},{"lineNumber":66,"author":{"gitId":"VladKozyr"},"content":"        } catch (Exception e) {"},{"lineNumber":67,"author":{"gitId":"VladKozyr"},"content":"            //TODO: catch API exception"},{"lineNumber":68,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":69,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":70,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":42,"Danylo Makarenko":28}},{"path":"kmaooad-functions/src/main/resources/META-INF/additional-spring-configuration-metadata.json","fileType":"json","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"{"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":"  \"properties\": ["},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"    {"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"      \"name\": \"bot.token\","},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"      \"type\": \"java.lang.String\","},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"      \"description\": \"Telegram bot token.\""},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"  ]"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":9}},{"path":"kmaooad-functions/src/main/resources/application.properties","fileType":"properties","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"#MongoDB server settings"},{"lineNumber":2,"author":{"gitId":"-"},"content":"spring.data.mongodb.uri\u003dmongodb+srv://admin:Hi6EWgtnkBej3pcn@cluster0.rxe1xqc.mongodb.net/?retryWrites\u003dtrue\u0026w\u003dmajority"},{"lineNumber":3,"author":{"gitId":"-"},"content":"spring.data.mongodb.database\u003dcaja22-stalevary"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"bot.token\u003d5620337367:AAFqW_u_yKWlTRsh3-N_bxyTTHUiDSDCpAg"}],"authorContributionMap":{"VladKozyr":2,"-":3}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/DispatcherTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.Dispatcher;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.session.ISessionService;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.session.UserSession;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.exception.IncorrectIdException;"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.Update;"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":"import java.util.Collections;"},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":"import java.util.HashMap;"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":"import java.util.Objects;"},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"import java.util.Optional;"},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":"import static com.mongodb.assertions.Assertions.assertFalse;"},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":"import static com.mongodb.internal.connection.tlschannel.util.Util.assertTrue;"},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":"public class DispatcherTest {"},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":"    private final StateMachine stateMachine \u003d mock(StateMachine.class);"},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":"    private final ISessionService sessionService \u003d mock(ISessionService.class);"},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":31,"author":{"gitId":"VladKozyr"},"content":"    private Dispatcher dispatcher() {"},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":"        return new Dispatcher(stateMachine, sessionService);"},{"lineNumber":33,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":34,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":36,"author":{"gitId":"VladKozyr"},"content":"    void shouldCreateUserAndDispatch() throws IncorrectIdException {"},{"lineNumber":37,"author":{"gitId":"VladKozyr"},"content":"        Handler commandHandler \u003d mock(Handler.class);"},{"lineNumber":38,"author":{"gitId":"VladKozyr"},"content":"        when(commandHandler.getCommands())"},{"lineNumber":39,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Collections.singletonList(\"course\"));"},{"lineNumber":40,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":41,"author":{"gitId":"VladKozyr"},"content":"        Handler stateHandler \u003d mock(Handler.class);"},{"lineNumber":42,"author":{"gitId":"VladKozyr"},"content":"        when(stateHandler.getState())"},{"lineNumber":43,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(new State.Any());"},{"lineNumber":44,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":45,"author":{"gitId":"VladKozyr"},"content":"        Handler filterHandler \u003d mock(Handler.class);"},{"lineNumber":46,"author":{"gitId":"VladKozyr"},"content":"        when(filterHandler.getFilter())"},{"lineNumber":47,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(message -\u003e true);"},{"lineNumber":48,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":49,"author":{"gitId":"VladKozyr"},"content":"        when(sessionService.getSessionByUserId(any()))"},{"lineNumber":50,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.empty());"},{"lineNumber":51,"author":{"gitId":"VladKozyr"},"content":"        when(sessionService.createSessionByUserId(any()))"},{"lineNumber":52,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(new UserSession(1L, new State.Any().key(), new HashMap\u003c\u003e()));"},{"lineNumber":53,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":54,"author":{"gitId":"VladKozyr"},"content":"        Dispatcher dispatcher \u003d dispatcher();"},{"lineNumber":55,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":56,"author":{"gitId":"VladKozyr"},"content":"        dispatcher.registerHandler(commandHandler);"},{"lineNumber":57,"author":{"gitId":"VladKozyr"},"content":"        dispatcher.registerHandler(stateHandler);"},{"lineNumber":58,"author":{"gitId":"VladKozyr"},"content":"        dispatcher.registerHandler(filterHandler);"},{"lineNumber":59,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":60,"author":{"gitId":"VladKozyr"},"content":"        boolean handled \u003d dispatcher.dispatch(Objects.requireNonNull(update()).getMessage());"},{"lineNumber":61,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":62,"author":{"gitId":"VladKozyr"},"content":"        assertTrue(handled);"},{"lineNumber":63,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(commandHandler, times(1)).handle((Message) any(), any());"},{"lineNumber":64,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateHandler, times(0)).handle((Message) any(), any());"},{"lineNumber":65,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(filterHandler, times(0)).handle((Message) any(), any());"},{"lineNumber":66,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":67,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":68,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":69,"author":{"gitId":"VladKozyr"},"content":"    void shouldDispatchCommandHandler() {"},{"lineNumber":70,"author":{"gitId":"VladKozyr"},"content":"        Handler commandHandler \u003d mock(Handler.class);"},{"lineNumber":71,"author":{"gitId":"VladKozyr"},"content":"        when(commandHandler.getCommands())"},{"lineNumber":72,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Collections.singletonList(\"course\"));"},{"lineNumber":73,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":74,"author":{"gitId":"VladKozyr"},"content":"        Handler stateHandle \u003d mock(Handler.class);"},{"lineNumber":75,"author":{"gitId":"VladKozyr"},"content":"        when(stateHandle.getState())"},{"lineNumber":76,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(new State.Any());"},{"lineNumber":77,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":78,"author":{"gitId":"VladKozyr"},"content":"        Handler filterHandler \u003d mock(Handler.class);"},{"lineNumber":79,"author":{"gitId":"VladKozyr"},"content":"        when(filterHandler.getFilter())"},{"lineNumber":80,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(message -\u003e true);"},{"lineNumber":81,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":82,"author":{"gitId":"VladKozyr"},"content":"        when(sessionService.getSessionByUserId(any()))"},{"lineNumber":83,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.of(new UserSession(1L, new State.Any().key(), new HashMap\u003c\u003e())));"},{"lineNumber":84,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":85,"author":{"gitId":"VladKozyr"},"content":"        Dispatcher dispatcher \u003d dispatcher();"},{"lineNumber":86,"author":{"gitId":"VladKozyr"},"content":"        dispatcher.registerHandler(commandHandler);"},{"lineNumber":87,"author":{"gitId":"VladKozyr"},"content":"        dispatcher.registerHandler(stateHandle);"},{"lineNumber":88,"author":{"gitId":"VladKozyr"},"content":"        dispatcher.registerHandler(filterHandler);"},{"lineNumber":89,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":90,"author":{"gitId":"VladKozyr"},"content":"        boolean handled \u003d dispatcher.dispatch(Objects.requireNonNull(update()).getMessage());"},{"lineNumber":91,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":92,"author":{"gitId":"VladKozyr"},"content":"        assertTrue(handled);"},{"lineNumber":93,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(commandHandler, times(1)).handle((Message) any(), any());"},{"lineNumber":94,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateHandle, times(0)).handle((Message) any(), any());"},{"lineNumber":95,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(filterHandler, times(0)).handle((Message) any(), any());"},{"lineNumber":96,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":97,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":98,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":99,"author":{"gitId":"VladKozyr"},"content":"    void shouldDispatchStateHandler() {"},{"lineNumber":100,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":101,"author":{"gitId":"VladKozyr"},"content":"        Handler stateHandle \u003d mock(Handler.class);"},{"lineNumber":102,"author":{"gitId":"VladKozyr"},"content":"        when(stateHandle.getState())"},{"lineNumber":103,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(new State.Any());"},{"lineNumber":104,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":105,"author":{"gitId":"VladKozyr"},"content":"        Handler filterHandler \u003d mock(Handler.class);"},{"lineNumber":106,"author":{"gitId":"VladKozyr"},"content":"        when(filterHandler.getFilter())"},{"lineNumber":107,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(message -\u003e true);"},{"lineNumber":108,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":109,"author":{"gitId":"VladKozyr"},"content":"        when(sessionService.getSessionByUserId(any()))"},{"lineNumber":110,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.of(new UserSession(1L, new State.Any().key(), new HashMap\u003c\u003e())));"},{"lineNumber":111,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":112,"author":{"gitId":"VladKozyr"},"content":"        Dispatcher dispatcher \u003d dispatcher();"},{"lineNumber":113,"author":{"gitId":"VladKozyr"},"content":"        dispatcher.registerHandler(stateHandle);"},{"lineNumber":114,"author":{"gitId":"VladKozyr"},"content":"        dispatcher.registerHandler(filterHandler);"},{"lineNumber":115,"author":{"gitId":"VladKozyr"},"content":"        boolean handled \u003d dispatcher.dispatch(Objects.requireNonNull(update()).getMessage());"},{"lineNumber":116,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":117,"author":{"gitId":"VladKozyr"},"content":"        assertTrue(handled);"},{"lineNumber":118,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateHandle, times(1)).handle((Message) any(), any());"},{"lineNumber":119,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(filterHandler, times(0)).handle((Message) any(), any());"},{"lineNumber":120,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":121,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":122,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":123,"author":{"gitId":"VladKozyr"},"content":"    void shouldDispatchFilterHandler() {"},{"lineNumber":124,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":125,"author":{"gitId":"VladKozyr"},"content":"        Handler filterHandler \u003d mock(Handler.class);"},{"lineNumber":126,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":127,"author":{"gitId":"VladKozyr"},"content":"        when(filterHandler.getFilter())"},{"lineNumber":128,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(message -\u003e true);"},{"lineNumber":129,"author":{"gitId":"VladKozyr"},"content":"        when(sessionService.getSessionByUserId(any()))"},{"lineNumber":130,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.of(new UserSession(1L, new State.Any().key(), new HashMap\u003c\u003e())));"},{"lineNumber":131,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":132,"author":{"gitId":"VladKozyr"},"content":"        Dispatcher dispatcher \u003d dispatcher();"},{"lineNumber":133,"author":{"gitId":"VladKozyr"},"content":"        dispatcher.registerHandler(filterHandler);"},{"lineNumber":134,"author":{"gitId":"VladKozyr"},"content":"        boolean handled \u003d dispatcher.dispatch(Objects.requireNonNull(update()).getMessage());"},{"lineNumber":135,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":136,"author":{"gitId":"VladKozyr"},"content":"        assertTrue(handled);"},{"lineNumber":137,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(filterHandler, times(1)).handle((Message) any(), any());"},{"lineNumber":138,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":139,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":140,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":141,"author":{"gitId":"VladKozyr"},"content":"    void shouldReturnNonDispatched() {"},{"lineNumber":142,"author":{"gitId":"VladKozyr"},"content":"        when(sessionService.getSessionByUserId(any()))"},{"lineNumber":143,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.of(new UserSession(1L, new State.Any().key(), new HashMap\u003c\u003e())));"},{"lineNumber":144,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":145,"author":{"gitId":"VladKozyr"},"content":"        Dispatcher dispatcher \u003d dispatcher();"},{"lineNumber":146,"author":{"gitId":"VladKozyr"},"content":"        boolean handled \u003d dispatcher.dispatch(Objects.requireNonNull(update()).getMessage());"},{"lineNumber":147,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":148,"author":{"gitId":"VladKozyr"},"content":"        assertFalse(handled);"},{"lineNumber":149,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":150,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":151,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":152,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldDispatchCallback() {"},{"lineNumber":153,"author":{"gitId":"Dmytro Zhornyk"},"content":"        Handler stateHandle \u003d mock(Handler.class);"},{"lineNumber":154,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(stateHandle.getState())"},{"lineNumber":155,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .thenReturn(new State.Any());"},{"lineNumber":156,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":157,"author":{"gitId":"Dmytro Zhornyk"},"content":"        Handler filterHandler \u003d mock(Handler.class);"},{"lineNumber":158,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(filterHandler.getFilter())"},{"lineNumber":159,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .thenReturn(message -\u003e true);"},{"lineNumber":160,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":161,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(sessionService.getSessionByUserId(any()))"},{"lineNumber":162,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .thenReturn(Optional.of(new UserSession(1L, new State.Any().key(), new HashMap\u003c\u003e())));"},{"lineNumber":163,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":164,"author":{"gitId":"Dmytro Zhornyk"},"content":"        Dispatcher dispatcher \u003d dispatcher();"},{"lineNumber":165,"author":{"gitId":"Dmytro Zhornyk"},"content":"        dispatcher.registerHandler(stateHandle);"},{"lineNumber":166,"author":{"gitId":"Dmytro Zhornyk"},"content":"        dispatcher.registerHandler(filterHandler);"},{"lineNumber":167,"author":{"gitId":"Dmytro Zhornyk"},"content":"        CallbackQuery callbackQuery \u003d new CallbackQuery();"},{"lineNumber":168,"author":{"gitId":"Dmytro Zhornyk"},"content":"        callbackQuery.setData(\"data\");"},{"lineNumber":169,"author":{"gitId":"Dmytro Zhornyk"},"content":"        callbackQuery.setMessage(Objects.requireNonNull(update()).getMessage());"},{"lineNumber":170,"author":{"gitId":"Dmytro Zhornyk"},"content":"        boolean handled \u003d dispatcher.dispatch(callbackQuery);"},{"lineNumber":171,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":172,"author":{"gitId":"Dmytro Zhornyk"},"content":"        assertTrue(handled);"},{"lineNumber":173,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateHandle, times(1)).handle((CallbackQuery) any(), any());"},{"lineNumber":174,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(filterHandler, times(0)).handle((CallbackQuery) any(), any());"},{"lineNumber":175,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":176,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":177,"author":{"gitId":"VladKozyr"},"content":"    private Update update() {"},{"lineNumber":178,"author":{"gitId":"VladKozyr"},"content":"        String updateJson \u003d \"\"\""},{"lineNumber":179,"author":{"gitId":"VladKozyr"},"content":"                {"},{"lineNumber":180,"author":{"gitId":"VladKozyr"},"content":"                   \"update_id\":260336395,"},{"lineNumber":181,"author":{"gitId":"VladKozyr"},"content":"                   \"message\":{"},{"lineNumber":182,"author":{"gitId":"VladKozyr"},"content":"                      \"message_id\":207,"},{"lineNumber":183,"author":{"gitId":"VladKozyr"},"content":"                      \"from\":{"},{"lineNumber":184,"author":{"gitId":"VladKozyr"},"content":"                         \"id\":384859024,"},{"lineNumber":185,"author":{"gitId":"VladKozyr"},"content":"                         \"is_bot\":false,"},{"lineNumber":186,"author":{"gitId":"VladKozyr"},"content":"                         \"first_name\":\"Vlad\","},{"lineNumber":187,"author":{"gitId":"VladKozyr"},"content":"                         \"last_name\":\"Kozyr\","},{"lineNumber":188,"author":{"gitId":"VladKozyr"},"content":"                         \"username\":\"vladyslav_kozyr\","},{"lineNumber":189,"author":{"gitId":"VladKozyr"},"content":"                         \"language_code\":\"en\""},{"lineNumber":190,"author":{"gitId":"VladKozyr"},"content":"                      },"},{"lineNumber":191,"author":{"gitId":"VladKozyr"},"content":"                      \"chat\":{"},{"lineNumber":192,"author":{"gitId":"VladKozyr"},"content":"                         \"id\":384859024,"},{"lineNumber":193,"author":{"gitId":"VladKozyr"},"content":"                         \"first_name\":\"Vlad\","},{"lineNumber":194,"author":{"gitId":"VladKozyr"},"content":"                         \"last_name\":\"Kozyr\","},{"lineNumber":195,"author":{"gitId":"VladKozyr"},"content":"                         \"username\":\"vladyslav_kozyr\","},{"lineNumber":196,"author":{"gitId":"VladKozyr"},"content":"                         \"type\":\"private\""},{"lineNumber":197,"author":{"gitId":"VladKozyr"},"content":"                      },"},{"lineNumber":198,"author":{"gitId":"VladKozyr"},"content":"                      \"date\":1669839096,"},{"lineNumber":199,"author":{"gitId":"VladKozyr"},"content":"                      \"text\":\"/course\","},{"lineNumber":200,"author":{"gitId":"VladKozyr"},"content":"                      \"entities\":["},{"lineNumber":201,"author":{"gitId":"VladKozyr"},"content":"                         {"},{"lineNumber":202,"author":{"gitId":"VladKozyr"},"content":"                            \"offset\":0,"},{"lineNumber":203,"author":{"gitId":"VladKozyr"},"content":"                            \"length\":7,"},{"lineNumber":204,"author":{"gitId":"VladKozyr"},"content":"                            \"type\":\"bot_command\""},{"lineNumber":205,"author":{"gitId":"VladKozyr"},"content":"                         }"},{"lineNumber":206,"author":{"gitId":"VladKozyr"},"content":"                      ]"},{"lineNumber":207,"author":{"gitId":"VladKozyr"},"content":"                   }"},{"lineNumber":208,"author":{"gitId":"VladKozyr"},"content":"                }"},{"lineNumber":209,"author":{"gitId":"VladKozyr"},"content":"                \"\"\";"},{"lineNumber":210,"author":{"gitId":"VladKozyr"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":211,"author":{"gitId":"VladKozyr"},"content":"        try {"},{"lineNumber":212,"author":{"gitId":"VladKozyr"},"content":"            return mapper.readValue(updateJson, Update.class);"},{"lineNumber":213,"author":{"gitId":"VladKozyr"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":214,"author":{"gitId":"VladKozyr"},"content":"            return null;"},{"lineNumber":215,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":216,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":217,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":180,"Dmytro Zhornyk":37}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/StateMachineTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.app.StateMachineImpl;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.session.ISessionService;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.session.UserSession;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.dto.CourseDto;"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.exception.IncorrectIdException;"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":"import java.util.HashMap;"},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":"import java.util.Optional;"},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":"import static org.junit.jupiter.api.Assertions.assertThrows;"},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":"import static org.junit.jupiter.api.Assertions.assertTrue;"},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":"import static org.mockito.ArgumentMatchers.any;"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"public class StateMachineTest {"},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":"    private final ISessionService sessionService \u003d mock(ISessionService.class);"},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":"    private final StateMachine stateMachine \u003d new StateMachineImpl(sessionService);"},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":"    void shouldThrowExceptionWhenUpdateStateAndUserNotExist() throws IncorrectIdException {"},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":"        when(sessionService.updateSessionState(any(), any()))"},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":"                .thenThrow(IncorrectIdException.class);"},{"lineNumber":31,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":"        assertThrows(StateMachineException.class, () -\u003e stateMachine.updateStateData(1L, group, new Object()));"},{"lineNumber":33,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":34,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":36,"author":{"gitId":"VladKozyr"},"content":"    void shouldThrowExceptionWhenUpdateSessionWithNonSerializableObject() throws IncorrectIdException {"},{"lineNumber":37,"author":{"gitId":"VladKozyr"},"content":"        when(sessionService.updateSessionState(any(), any()))"},{"lineNumber":38,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(new UserSession(1L, \"state\", new HashMap\u003c\u003e()));"},{"lineNumber":39,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":40,"author":{"gitId":"VladKozyr"},"content":"        assertThrows(StateMachineException.class, () -\u003e stateMachine.updateStateData(1L, group, new Object()));"},{"lineNumber":41,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":42,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":43,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":44,"author":{"gitId":"VladKozyr"},"content":"    void shouldUpdateSession() throws StateMachineException, IncorrectIdException {"},{"lineNumber":45,"author":{"gitId":"VladKozyr"},"content":"        stateMachine.updateStateData(1L, group, new CourseDto());"},{"lineNumber":46,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":47,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionService, times(1))"},{"lineNumber":48,"author":{"gitId":"VladKozyr"},"content":"                .updateGroupStatePayload(1L, group, \"{\\\"title\\\":null,\\\"description\\\":null}\");"},{"lineNumber":49,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":50,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":51,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":52,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":53,"author":{"gitId":"VladKozyr"},"content":"    void shouldThrowExceptionWhenSetStateAndUserNotExist() throws IncorrectIdException {"},{"lineNumber":54,"author":{"gitId":"VladKozyr"},"content":"        when(sessionService.updateSessionState(any(), any()))"},{"lineNumber":55,"author":{"gitId":"VladKozyr"},"content":"                .thenThrow(IncorrectIdException.class);"},{"lineNumber":56,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":57,"author":{"gitId":"VladKozyr"},"content":"        assertThrows(StateMachineException.class, () -\u003e stateMachine.setState(1L, new State.Any()));"},{"lineNumber":58,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":59,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":60,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":61,"author":{"gitId":"VladKozyr"},"content":"    void shouldSetState() throws StateMachineException, IncorrectIdException {"},{"lineNumber":62,"author":{"gitId":"VladKozyr"},"content":"        stateMachine.setState(1L, new State.Any());"},{"lineNumber":63,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":64,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionService, times(1))"},{"lineNumber":65,"author":{"gitId":"VladKozyr"},"content":"                .updateSessionState(1L, new State.Any());"},{"lineNumber":66,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":67,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":68,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":69,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":70,"author":{"gitId":"VladKozyr"},"content":"    void shouldReturnEmptyOptionalWhenGetStatePayloadAndUserNotExist() throws IncorrectIdException {"},{"lineNumber":71,"author":{"gitId":"VladKozyr"},"content":"        when(sessionService.getGroupStatePayload(any(), any()))"},{"lineNumber":72,"author":{"gitId":"VladKozyr"},"content":"                .thenThrow(IncorrectIdException.class);"},{"lineNumber":73,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":74,"author":{"gitId":"VladKozyr"},"content":"        Optional\u003cInteger\u003e result \u003d stateMachine.getStatePayload(1L, group, Integer.class);"},{"lineNumber":75,"author":{"gitId":"VladKozyr"},"content":"        assertTrue(result.isEmpty());"},{"lineNumber":76,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":77,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":78,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":79,"author":{"gitId":"VladKozyr"},"content":"    void shouldReturnEmptyOptionalWhenGetStatePayloadAndPayloadNotExist() throws IncorrectIdException {"},{"lineNumber":80,"author":{"gitId":"VladKozyr"},"content":"        when(sessionService.getGroupStatePayload(any(), any()))"},{"lineNumber":81,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(null);"},{"lineNumber":82,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":83,"author":{"gitId":"VladKozyr"},"content":"        Optional\u003cInteger\u003e result \u003d stateMachine.getStatePayload(1L, group, Integer.class);"},{"lineNumber":84,"author":{"gitId":"VladKozyr"},"content":"        assertTrue(result.isEmpty());"},{"lineNumber":85,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":86,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":87,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":88,"author":{"gitId":"VladKozyr"},"content":"    void shouldGetStatePayload() throws IncorrectIdException {"},{"lineNumber":89,"author":{"gitId":"VladKozyr"},"content":"        when(sessionService.getGroupStatePayload(any(), any()))"},{"lineNumber":90,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(\"{\\\"title\\\":\\\"TITLE\\\",\\\"description\\\":\\\"DESC\\\"}\");"},{"lineNumber":91,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":92,"author":{"gitId":"VladKozyr"},"content":"        Optional\u003cCourseDto\u003e result \u003d stateMachine.getStatePayload(1L, group, CourseDto.class);"},{"lineNumber":93,"author":{"gitId":"VladKozyr"},"content":"        assertTrue(result.isPresent());"},{"lineNumber":94,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":95,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":96,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":97,"author":{"gitId":"VladKozyr"},"content":"    private final State.Group group \u003d new State.Group() {"},{"lineNumber":98,"author":{"gitId":"VladKozyr"},"content":"        @Override"},{"lineNumber":99,"author":{"gitId":"VladKozyr"},"content":"        public String group() {"},{"lineNumber":100,"author":{"gitId":"VladKozyr"},"content":"            return \"key\";"},{"lineNumber":101,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":102,"author":{"gitId":"VladKozyr"},"content":"    };"},{"lineNumber":103,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":103}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/TelegramWebhookHandlerTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import com.microsoft.azure.functions.ExecutionContext;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import com.microsoft.azure.functions.HttpRequestMessage;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import com.microsoft.azure.functions.HttpResponseMessage;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import com.microsoft.azure.functions.HttpStatus;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.dto.BotUpdateResult;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"import org.mockito.stubbing.Answer;"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"import org.springframework.boot.test.context.SpringBootTest;"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.Update;"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":"import java.util.Optional;"},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":"import java.util.logging.Logger;"},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":"import static org.junit.jupiter.api.Assertions.assertEquals;"},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":"import static org.mockito.ArgumentMatchers.any;"},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"@SpringBootTest"},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"public class TelegramWebhookHandlerTest {"},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":"    private HttpRequestMessage\u003cOptional\u003cString\u003e\u003e setupHttpRequestMock(String body) {"},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":"        final HttpRequestMessage\u003cOptional\u003cString\u003e\u003e requestMock \u003d mock(HttpRequestMessage.class);"},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":"        when(requestMock.getBody()).thenReturn(Optional.ofNullable(body));"},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":"        when(requestMock.createResponseBuilder(any(HttpStatus.class)))"},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":"                .thenAnswer((Answer\u003cHttpResponseMessage.Builder\u003e) invocation -\u003e"},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":"                        new HttpResponseMessageMock"},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":"                                .HttpResponseMessageBuilderMock()"},{"lineNumber":31,"author":{"gitId":"VladKozyr"},"content":"                                .status(invocation.getArgument(0))"},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":"                );"},{"lineNumber":33,"author":{"gitId":"VladKozyr"},"content":"        return requestMock;"},{"lineNumber":34,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":36,"author":{"gitId":"VladKozyr"},"content":"    private ExecutionContext getExecutionContext() {"},{"lineNumber":37,"author":{"gitId":"VladKozyr"},"content":"        ExecutionContext contextMock \u003d mock(ExecutionContext.class);"},{"lineNumber":38,"author":{"gitId":"VladKozyr"},"content":"        when(contextMock.getLogger()).thenReturn(Logger.getGlobal());"},{"lineNumber":39,"author":{"gitId":"VladKozyr"},"content":"        return contextMock;"},{"lineNumber":40,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":41,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":42,"author":{"gitId":"VladKozyr"},"content":"    private TelegramWebhookHandler getSucceedHandler() {"},{"lineNumber":43,"author":{"gitId":"VladKozyr"},"content":"        TelegramWebhookHandler handler \u003d spy(TelegramWebhookHandler.class);"},{"lineNumber":44,"author":{"gitId":"VladKozyr"},"content":"        doAnswer("},{"lineNumber":45,"author":{"gitId":"VladKozyr"},"content":"                invocationOnMock -\u003e {"},{"lineNumber":46,"author":{"gitId":"VladKozyr"},"content":"                    Update update \u003d invocationOnMock.getArgument(0);"},{"lineNumber":47,"author":{"gitId":"VladKozyr"},"content":"                    return BotUpdateResult.Ok(update.getMessage().getMessageId());"},{"lineNumber":48,"author":{"gitId":"VladKozyr"},"content":"                }"},{"lineNumber":49,"author":{"gitId":"VladKozyr"},"content":"        )"},{"lineNumber":50,"author":{"gitId":"VladKozyr"},"content":"                .when(handler)"},{"lineNumber":51,"author":{"gitId":"VladKozyr"},"content":"                .handleRequest(any(Update.class), any(ExecutionContext.class));"},{"lineNumber":52,"author":{"gitId":"VladKozyr"},"content":"        return handler;"},{"lineNumber":53,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":54,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":55,"author":{"gitId":"VladKozyr"},"content":"    private TelegramWebhookHandler getFailedHandler() {"},{"lineNumber":56,"author":{"gitId":"VladKozyr"},"content":"        TelegramWebhookHandler handler \u003d spy(TelegramWebhookHandler.class);"},{"lineNumber":57,"author":{"gitId":"VladKozyr"},"content":"        doAnswer("},{"lineNumber":58,"author":{"gitId":"VladKozyr"},"content":"                invocationOnMock -\u003e BotUpdateResult.Error(\"\")"},{"lineNumber":59,"author":{"gitId":"VladKozyr"},"content":"        )"},{"lineNumber":60,"author":{"gitId":"VladKozyr"},"content":"                .when(handler)"},{"lineNumber":61,"author":{"gitId":"VladKozyr"},"content":"                .handleRequest(any(Update.class), any(ExecutionContext.class));"},{"lineNumber":62,"author":{"gitId":"VladKozyr"},"content":"        return handler;"},{"lineNumber":63,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":64,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":65,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":66,"author":{"gitId":"VladKozyr"},"content":"    public void shouldReturnBadResponseWhenEmptyBody() {"},{"lineNumber":67,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":68,"author":{"gitId":"VladKozyr"},"content":"        final HttpRequestMessage\u003cOptional\u003cString\u003e\u003e request \u003d setupHttpRequestMock(null);"},{"lineNumber":69,"author":{"gitId":"VladKozyr"},"content":"        final HttpResponseMessage response \u003d getSucceedHandler().run(request, getExecutionContext());"},{"lineNumber":70,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":71,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(HttpStatus.BAD_REQUEST, response.getStatus());"},{"lineNumber":72,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":73,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":74,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":75,"author":{"gitId":"VladKozyr"},"content":"    public void shouldReturnBadResponseWhenIncorrectJsonBody() {"},{"lineNumber":76,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":77,"author":{"gitId":"VladKozyr"},"content":"        final HttpRequestMessage\u003cOptional\u003cString\u003e\u003e request \u003d setupHttpRequestMock(\"string\");"},{"lineNumber":78,"author":{"gitId":"VladKozyr"},"content":"        final HttpResponseMessage response \u003d getSucceedHandler().run(request, getExecutionContext());"},{"lineNumber":79,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":80,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(HttpStatus.BAD_REQUEST, response.getStatus());"},{"lineNumber":81,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":82,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":83,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":84,"author":{"gitId":"VladKozyr"},"content":"    public void shouldReturnBadResponseWhenMessageNonPresent() {"},{"lineNumber":85,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":86,"author":{"gitId":"VladKozyr"},"content":"        final HttpRequestMessage\u003cOptional\u003cString\u003e\u003e request \u003d setupHttpRequestMock(\"\"\""},{"lineNumber":87,"author":{"gitId":"VladKozyr"},"content":"                {"},{"lineNumber":88,"author":{"gitId":"VladKozyr"},"content":"                   \"msg\":{"},{"lineNumber":89,"author":{"gitId":"VladKozyr"},"content":"                     \\s"},{"lineNumber":90,"author":{"gitId":"VladKozyr"},"content":"                   }"},{"lineNumber":91,"author":{"gitId":"VladKozyr"},"content":"                }\"\"\");"},{"lineNumber":92,"author":{"gitId":"VladKozyr"},"content":"        final HttpResponseMessage response \u003d getSucceedHandler().run(request, getExecutionContext());"},{"lineNumber":93,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":94,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(HttpStatus.BAD_REQUEST, response.getStatus());"},{"lineNumber":95,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":96,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":97,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":98,"author":{"gitId":"VladKozyr"},"content":"    public void shouldReturnOkResponse() {"},{"lineNumber":99,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":100,"author":{"gitId":"VladKozyr"},"content":"        final HttpRequestMessage\u003cOptional\u003cString\u003e\u003e request \u003d setupHttpRequestMock(\"\"\""},{"lineNumber":101,"author":{"gitId":"VladKozyr"},"content":"                {"},{"lineNumber":102,"author":{"gitId":"VladKozyr"},"content":"                   \"update_id\":260336395,"},{"lineNumber":103,"author":{"gitId":"VladKozyr"},"content":"                   \"message\":{"},{"lineNumber":104,"author":{"gitId":"VladKozyr"},"content":"                      \"message_id\":207,"},{"lineNumber":105,"author":{"gitId":"VladKozyr"},"content":"                      \"from\":{"},{"lineNumber":106,"author":{"gitId":"VladKozyr"},"content":"                         \"id\":384859024,"},{"lineNumber":107,"author":{"gitId":"VladKozyr"},"content":"                         \"is_bot\":false,"},{"lineNumber":108,"author":{"gitId":"VladKozyr"},"content":"                         \"first_name\":\"Vlad\","},{"lineNumber":109,"author":{"gitId":"VladKozyr"},"content":"                         \"last_name\":\"Kozyr\","},{"lineNumber":110,"author":{"gitId":"VladKozyr"},"content":"                         \"username\":\"vladyslav_kozyr\","},{"lineNumber":111,"author":{"gitId":"VladKozyr"},"content":"                         \"language_code\":\"en\""},{"lineNumber":112,"author":{"gitId":"VladKozyr"},"content":"                      },"},{"lineNumber":113,"author":{"gitId":"VladKozyr"},"content":"                      \"chat\":{"},{"lineNumber":114,"author":{"gitId":"VladKozyr"},"content":"                         \"id\":384859024,"},{"lineNumber":115,"author":{"gitId":"VladKozyr"},"content":"                         \"first_name\":\"Vlad\","},{"lineNumber":116,"author":{"gitId":"VladKozyr"},"content":"                         \"last_name\":\"Kozyr\","},{"lineNumber":117,"author":{"gitId":"VladKozyr"},"content":"                         \"username\":\"vladyslav_kozyr\","},{"lineNumber":118,"author":{"gitId":"VladKozyr"},"content":"                         \"type\":\"private\""},{"lineNumber":119,"author":{"gitId":"VladKozyr"},"content":"                      },"},{"lineNumber":120,"author":{"gitId":"VladKozyr"},"content":"                      \"date\":1669839096,"},{"lineNumber":121,"author":{"gitId":"VladKozyr"},"content":"                      \"text\":\"/course\","},{"lineNumber":122,"author":{"gitId":"VladKozyr"},"content":"                      \"entities\":["},{"lineNumber":123,"author":{"gitId":"VladKozyr"},"content":"                         {"},{"lineNumber":124,"author":{"gitId":"VladKozyr"},"content":"                            \"offset\":0,"},{"lineNumber":125,"author":{"gitId":"VladKozyr"},"content":"                            \"length\":7,"},{"lineNumber":126,"author":{"gitId":"VladKozyr"},"content":"                            \"type\":\"bot_command\""},{"lineNumber":127,"author":{"gitId":"VladKozyr"},"content":"                         }"},{"lineNumber":128,"author":{"gitId":"VladKozyr"},"content":"                      ]"},{"lineNumber":129,"author":{"gitId":"VladKozyr"},"content":"                   }"},{"lineNumber":130,"author":{"gitId":"VladKozyr"},"content":"                }\"\"\");"},{"lineNumber":131,"author":{"gitId":"VladKozyr"},"content":"        final HttpResponseMessage response \u003d getSucceedHandler().run(request, getExecutionContext());"},{"lineNumber":132,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":133,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(207, response.getBody());"},{"lineNumber":134,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(HttpStatus.OK, response.getStatus());"},{"lineNumber":135,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":136,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":137,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":138,"author":{"gitId":"VladKozyr"},"content":"    public void shouldReturnBadResponseForFailedHandler() {"},{"lineNumber":139,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":140,"author":{"gitId":"VladKozyr"},"content":"        final HttpRequestMessage\u003cOptional\u003cString\u003e\u003e request \u003d setupHttpRequestMock(\"\"\""},{"lineNumber":141,"author":{"gitId":"VladKozyr"},"content":"                {"},{"lineNumber":142,"author":{"gitId":"VladKozyr"},"content":"                   \"update_id\":260336395,"},{"lineNumber":143,"author":{"gitId":"VladKozyr"},"content":"                   \"message\":{"},{"lineNumber":144,"author":{"gitId":"VladKozyr"},"content":"                      \"message_id\":207,"},{"lineNumber":145,"author":{"gitId":"VladKozyr"},"content":"                      \"from\":{"},{"lineNumber":146,"author":{"gitId":"VladKozyr"},"content":"                         \"id\":384859024,"},{"lineNumber":147,"author":{"gitId":"VladKozyr"},"content":"                         \"is_bot\":false,"},{"lineNumber":148,"author":{"gitId":"VladKozyr"},"content":"                         \"first_name\":\"Vlad\","},{"lineNumber":149,"author":{"gitId":"VladKozyr"},"content":"                         \"last_name\":\"Kozyr\","},{"lineNumber":150,"author":{"gitId":"VladKozyr"},"content":"                         \"username\":\"vladyslav_kozyr\","},{"lineNumber":151,"author":{"gitId":"VladKozyr"},"content":"                         \"language_code\":\"en\""},{"lineNumber":152,"author":{"gitId":"VladKozyr"},"content":"                      },"},{"lineNumber":153,"author":{"gitId":"VladKozyr"},"content":"                      \"chat\":{"},{"lineNumber":154,"author":{"gitId":"VladKozyr"},"content":"                         \"id\":384859024,"},{"lineNumber":155,"author":{"gitId":"VladKozyr"},"content":"                         \"first_name\":\"Vlad\","},{"lineNumber":156,"author":{"gitId":"VladKozyr"},"content":"                         \"last_name\":\"Kozyr\","},{"lineNumber":157,"author":{"gitId":"VladKozyr"},"content":"                         \"username\":\"vladyslav_kozyr\","},{"lineNumber":158,"author":{"gitId":"VladKozyr"},"content":"                         \"type\":\"private\""},{"lineNumber":159,"author":{"gitId":"VladKozyr"},"content":"                      },"},{"lineNumber":160,"author":{"gitId":"VladKozyr"},"content":"                      \"date\":1669839096,"},{"lineNumber":161,"author":{"gitId":"VladKozyr"},"content":"                      \"text\":\"/course\","},{"lineNumber":162,"author":{"gitId":"VladKozyr"},"content":"                      \"entities\":["},{"lineNumber":163,"author":{"gitId":"VladKozyr"},"content":"                         {"},{"lineNumber":164,"author":{"gitId":"VladKozyr"},"content":"                            \"offset\":0,"},{"lineNumber":165,"author":{"gitId":"VladKozyr"},"content":"                            \"length\":7,"},{"lineNumber":166,"author":{"gitId":"VladKozyr"},"content":"                            \"type\":\"bot_command\""},{"lineNumber":167,"author":{"gitId":"VladKozyr"},"content":"                         }"},{"lineNumber":168,"author":{"gitId":"VladKozyr"},"content":"                      ]"},{"lineNumber":169,"author":{"gitId":"VladKozyr"},"content":"                   }"},{"lineNumber":170,"author":{"gitId":"VladKozyr"},"content":"                }\"\"\");"},{"lineNumber":171,"author":{"gitId":"VladKozyr"},"content":"        final HttpResponseMessage response \u003d getFailedHandler().run(request, getExecutionContext());"},{"lineNumber":172,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":173,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(HttpStatus.BAD_REQUEST, response.getStatus());"},{"lineNumber":174,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":175,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":175}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/TelegramWebhookTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"package edu.kmaooad;"},{"lineNumber":2,"author":{"gitId":"-"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.Dispatcher;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.Handler;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.dto.BotUpdateResult;"},{"lineNumber":8,"author":{"gitId":"-"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.Update;"},{"lineNumber":11,"author":{"gitId":"-"},"content":""},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"import java.util.ArrayList;"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":"import java.util.List;"},{"lineNumber":14,"author":{"gitId":"-"},"content":""},{"lineNumber":15,"author":{"gitId":"-"},"content":"import static org.junit.jupiter.api.Assertions.assertEquals;"},{"lineNumber":16,"author":{"gitId":"-"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":17,"author":{"gitId":"-"},"content":""},{"lineNumber":18,"author":{"gitId":"-"},"content":"public class TelegramWebhookTest {"},{"lineNumber":19,"author":{"gitId":"-"},"content":""},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"    void shouldReturnBadUpdateForNullParam() {"},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":"        Dispatcher dispatcher \u003d mock(Dispatcher.class);"},{"lineNumber":23,"author":{"gitId":"-"},"content":""},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":"        List\u003cHandler\u003e handlerList \u003d new ArrayList\u003c\u003e();"},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":"        handlerList.add(mock(Handler.class));"},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":"        handlerList.add(mock(Handler.class));"},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":"        handlerList.add(mock(Handler.class));"},{"lineNumber":28,"author":{"gitId":"-"},"content":""},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":"        BotUpdateResult result \u003d new TelegramWebhook(dispatcher, handlerList).apply(null);"},{"lineNumber":30,"author":{"gitId":"-"},"content":""},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(dispatcher, times(0)).dispatch((Message) any());"},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(result.errorMessage(), TelegramWebhook.emptyUpdateMessage());"},{"lineNumber":33,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":34,"author":{"gitId":"-"},"content":""},{"lineNumber":35,"author":{"gitId":"-"},"content":"    @Test"},{"lineNumber":36,"author":{"gitId":"VladKozyr"},"content":"    void shouldReturnBadUpdateForEmptyMessage() {"},{"lineNumber":37,"author":{"gitId":"VladKozyr"},"content":"        Dispatcher dispatcher \u003d mock(Dispatcher.class);"},{"lineNumber":38,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":39,"author":{"gitId":"VladKozyr"},"content":"        List\u003cHandler\u003e handlerList \u003d new ArrayList\u003c\u003e();"},{"lineNumber":40,"author":{"gitId":"VladKozyr"},"content":"        handlerList.add(mock(Handler.class));"},{"lineNumber":41,"author":{"gitId":"VladKozyr"},"content":"        handlerList.add(mock(Handler.class));"},{"lineNumber":42,"author":{"gitId":"VladKozyr"},"content":"        handlerList.add(mock(Handler.class));"},{"lineNumber":43,"author":{"gitId":"-"},"content":""},{"lineNumber":44,"author":{"gitId":"VladKozyr"},"content":"        BotUpdateResult result \u003d new TelegramWebhook(dispatcher, handlerList).apply(updateWithoutMessage());"},{"lineNumber":45,"author":{"gitId":"-"},"content":""},{"lineNumber":46,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(dispatcher, times(0)).dispatch((Message) any());"},{"lineNumber":47,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(result.errorMessage(), TelegramWebhook.emptyUpdateMessage());"},{"lineNumber":48,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":49,"author":{"gitId":"-"},"content":""},{"lineNumber":50,"author":{"gitId":"-"},"content":"    @Test"},{"lineNumber":51,"author":{"gitId":"VladKozyr"},"content":"    void shouldReturnOkUpdate() {"},{"lineNumber":52,"author":{"gitId":"VladKozyr"},"content":"        Dispatcher dispatcher \u003d mock(Dispatcher.class);"},{"lineNumber":53,"author":{"gitId":"-"},"content":""},{"lineNumber":54,"author":{"gitId":"VladKozyr"},"content":"        List\u003cHandler\u003e handlerList \u003d new ArrayList\u003c\u003e();"},{"lineNumber":55,"author":{"gitId":"VladKozyr"},"content":"        handlerList.add(mock(Handler.class));"},{"lineNumber":56,"author":{"gitId":"VladKozyr"},"content":"        handlerList.add(mock(Handler.class));"},{"lineNumber":57,"author":{"gitId":"VladKozyr"},"content":"        handlerList.add(mock(Handler.class));"},{"lineNumber":58,"author":{"gitId":"-"},"content":""},{"lineNumber":59,"author":{"gitId":"VladKozyr"},"content":"        Update update \u003d updateWithMessage();"},{"lineNumber":60,"author":{"gitId":"-"},"content":""},{"lineNumber":61,"author":{"gitId":"VladKozyr"},"content":"        BotUpdateResult result \u003d new TelegramWebhook(dispatcher, handlerList).apply(update);"},{"lineNumber":62,"author":{"gitId":"-"},"content":""},{"lineNumber":63,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(dispatcher, times(1)).dispatch((Message) any());"},{"lineNumber":64,"author":{"gitId":"Dmytro Zhornyk"},"content":"        assertEquals(update.getMessage().getMessageId(), result.messageId());"},{"lineNumber":65,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":66,"author":{"gitId":"-"},"content":""},{"lineNumber":67,"author":{"gitId":"VladKozyr"},"content":"    private Update updateWithoutMessage() {"},{"lineNumber":68,"author":{"gitId":"VladKozyr"},"content":"        String updateJson \u003d \"\"\""},{"lineNumber":69,"author":{"gitId":"-"},"content":"                {"},{"lineNumber":70,"author":{"gitId":"VladKozyr"},"content":"                   \"update_id\":260336395"},{"lineNumber":71,"author":{"gitId":"VladKozyr"},"content":"                }"},{"lineNumber":72,"author":{"gitId":"VladKozyr"},"content":"                \"\"\";"},{"lineNumber":73,"author":{"gitId":"VladKozyr"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":74,"author":{"gitId":"VladKozyr"},"content":"        try {"},{"lineNumber":75,"author":{"gitId":"VladKozyr"},"content":"            return mapper.readValue(updateJson, Update.class);"},{"lineNumber":76,"author":{"gitId":"VladKozyr"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":77,"author":{"gitId":"VladKozyr"},"content":"            return null;"},{"lineNumber":78,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":79,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":80,"author":{"gitId":"-"},"content":""},{"lineNumber":81,"author":{"gitId":"VladKozyr"},"content":"    private Update updateWithMessage() {"},{"lineNumber":82,"author":{"gitId":"VladKozyr"},"content":"        String updateJson \u003d \"\"\""},{"lineNumber":83,"author":{"gitId":"-"},"content":"                {"},{"lineNumber":84,"author":{"gitId":"VladKozyr"},"content":"                   \"update_id\":260336395,"},{"lineNumber":85,"author":{"gitId":"-"},"content":"                   \"message\":{"},{"lineNumber":86,"author":{"gitId":"VladKozyr"},"content":"                      \"message_id\":207,"},{"lineNumber":87,"author":{"gitId":"VladKozyr"},"content":"                      \"from\":{"},{"lineNumber":88,"author":{"gitId":"VladKozyr"},"content":"                         \"id\":384859024,"},{"lineNumber":89,"author":{"gitId":"VladKozyr"},"content":"                         \"is_bot\":false,"},{"lineNumber":90,"author":{"gitId":"VladKozyr"},"content":"                         \"first_name\":\"Vlad\","},{"lineNumber":91,"author":{"gitId":"VladKozyr"},"content":"                         \"last_name\":\"Kozyr\","},{"lineNumber":92,"author":{"gitId":"VladKozyr"},"content":"                         \"username\":\"vladyslav_kozyr\","},{"lineNumber":93,"author":{"gitId":"VladKozyr"},"content":"                         \"language_code\":\"en\""},{"lineNumber":94,"author":{"gitId":"VladKozyr"},"content":"                      },"},{"lineNumber":95,"author":{"gitId":"VladKozyr"},"content":"                      \"chat\":{"},{"lineNumber":96,"author":{"gitId":"VladKozyr"},"content":"                         \"id\":384859024,"},{"lineNumber":97,"author":{"gitId":"VladKozyr"},"content":"                         \"first_name\":\"Vlad\","},{"lineNumber":98,"author":{"gitId":"VladKozyr"},"content":"                         \"last_name\":\"Kozyr\","},{"lineNumber":99,"author":{"gitId":"VladKozyr"},"content":"                         \"username\":\"vladyslav_kozyr\","},{"lineNumber":100,"author":{"gitId":"VladKozyr"},"content":"                         \"type\":\"private\""},{"lineNumber":101,"author":{"gitId":"VladKozyr"},"content":"                      },"},{"lineNumber":102,"author":{"gitId":"VladKozyr"},"content":"                      \"date\":1669839096,"},{"lineNumber":103,"author":{"gitId":"VladKozyr"},"content":"                      \"text\":\"/course\","},{"lineNumber":104,"author":{"gitId":"VladKozyr"},"content":"                      \"entities\":["},{"lineNumber":105,"author":{"gitId":"VladKozyr"},"content":"                         {"},{"lineNumber":106,"author":{"gitId":"VladKozyr"},"content":"                            \"offset\":0,"},{"lineNumber":107,"author":{"gitId":"VladKozyr"},"content":"                            \"length\":7,"},{"lineNumber":108,"author":{"gitId":"VladKozyr"},"content":"                            \"type\":\"bot_command\""},{"lineNumber":109,"author":{"gitId":"VladKozyr"},"content":"                         }"},{"lineNumber":110,"author":{"gitId":"VladKozyr"},"content":"                      ]"},{"lineNumber":111,"author":{"gitId":"-"},"content":"                   }"},{"lineNumber":112,"author":{"gitId":"VladKozyr"},"content":"                }"},{"lineNumber":113,"author":{"gitId":"VladKozyr"},"content":"                \"\"\";"},{"lineNumber":114,"author":{"gitId":"VladKozyr"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":115,"author":{"gitId":"VladKozyr"},"content":"        try {"},{"lineNumber":116,"author":{"gitId":"VladKozyr"},"content":"            return mapper.readValue(updateJson, Update.class);"},{"lineNumber":117,"author":{"gitId":"VladKozyr"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":118,"author":{"gitId":"VladKozyr"},"content":"            return null;"},{"lineNumber":119,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":120,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":121,"author":{"gitId":"-"},"content":"}"}],"authorContributionMap":{"VladKozyr":81,"Dmytro Zhornyk":5,"-":35}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/app/ActivityCreateHandlerTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.app.activities.create.*;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.ActivityDto;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.json.JSONObject;"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.mockito.ArgumentCaptor;"},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.Objects;"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.Optional;"},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.junit.jupiter.api.Assertions.assertEquals;"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.ArgumentMatchers.any;"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.ArgumentMatchers.anyLong;"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.ArgumentMatchers.eq;"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.ArgumentMatchers.refEq;"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.Mockito.times;"},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityCreateHandlerTest {"},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService \u003d mock(TelegramService.class);"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final StateMachine stateMachine \u003d mock(StateMachine.class);"},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityService activityService \u003d mock(ActivityService.class);"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityCreateHandler activityCreateHandler \u003d new ActivityCreateHandler(telegramService);"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityCreateGetTitle activityTitleHandler \u003d new ActivityCreateGetTitle(telegramService);"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityCreateGetDescription activityDescriptionHandler \u003d new ActivityCreateGetDescription(telegramService);"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityCreateGetDate activityDateHandler \u003d new ActivityCreateGetDate(telegramService);"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityCreateGetTime activityTimeHandler \u003d new ActivityCreateGetTime(telegramService);"},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityCreateGetLocation activityLocationHandler \u003d new ActivityCreateGetLocation(telegramService, activityService);"},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":44,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldUpdateState_onCreateHandler() throws StateMachineException {"},{"lineNumber":45,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":46,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityCreateHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":47,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":48,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).setState(384859024L, ActivityCreate.GET_TITLE);"},{"lineNumber":49,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":50,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":51,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":52,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":53,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCatchExceptionOnUpdateState_onCreateHandler() throws StateMachineException {"},{"lineNumber":54,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":55,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(stateMachine)"},{"lineNumber":56,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(anyLong(), any());"},{"lineNumber":57,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":58,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityCreateHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":59,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":60,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).setState(384859024L, ActivityCreate.GET_TITLE);"},{"lineNumber":61,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":62,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":63,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":64,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":65,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldUpdateState_onTitleHandler() throws StateMachineException {"},{"lineNumber":66,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityTitleHandler.handle(Objects.requireNonNull(withText(\"title\")), stateMachine);"},{"lineNumber":67,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":68,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":69,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(384859024L, ActivityCreate.GET_DESCRIPTION);"},{"lineNumber":70,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":71,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .updateStateData(eq(384859024L), eq(ActivityCreate.GROUP), refEq(new ActivityDto(\"384859024\", \"title\", null, null, null, null)));"},{"lineNumber":72,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1))"},{"lineNumber":73,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .sendMessage(any(), any());"},{"lineNumber":74,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":75,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":76,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":77,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCatchExceptionOnUpdateState_onTitleHandler() throws StateMachineException {"},{"lineNumber":78,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":79,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":80,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(stateMachine)"},{"lineNumber":81,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(anyLong(), any());"},{"lineNumber":82,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":83,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityTitleHandler.handle(Objects.requireNonNull(withText(\"title\")), stateMachine);"},{"lineNumber":84,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":85,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).setState(384859024L, ActivityCreate.GET_DESCRIPTION);"},{"lineNumber":86,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":87,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":88,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":89,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":90,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCatchExceptionOnSaveStatePayload_onTitleHandler() throws StateMachineException {"},{"lineNumber":91,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":92,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":93,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(stateMachine)"},{"lineNumber":94,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .updateStateData(anyLong(), any(), any());"},{"lineNumber":95,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":96,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityTitleHandler.handle(Objects.requireNonNull(withText(\"title\")), stateMachine);"},{"lineNumber":97,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":98,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":99,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .updateStateData(eq(384859024L), eq(ActivityCreate.GROUP), refEq(new ActivityDto(\"384859024\", \"title\", null, null, null, null)));"},{"lineNumber":100,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0))"},{"lineNumber":101,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(anyLong(), any());"},{"lineNumber":102,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1))"},{"lineNumber":103,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .sendMessage(any(), any());"},{"lineNumber":104,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":105,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":106,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":107,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldUpdateState_onDescriptionHandler() throws StateMachineException {"},{"lineNumber":108,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":109,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .thenReturn(Optional.of(new ActivityDto(\"384859024\", \"title\", null, null, null, null)));"},{"lineNumber":110,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":111,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityDescriptionHandler.handle(Objects.requireNonNull(withText(\"description\")), stateMachine);"},{"lineNumber":112,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":113,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":114,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(384859024L, ActivityCreate.GET_DATE);"},{"lineNumber":115,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":116,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .updateStateData(eq(384859024L), eq(ActivityCreate.GROUP), refEq(new ActivityDto(\"384859024\", \"title\", \"description\", null, null, null)));"},{"lineNumber":117,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1))"},{"lineNumber":118,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .sendMessage(any(), any());"},{"lineNumber":119,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":120,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":121,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":122,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCatchExceptionOnUpdateState_onDescriptionHandler() throws StateMachineException {"},{"lineNumber":123,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":124,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":125,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(stateMachine)"},{"lineNumber":126,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(anyLong(), any());"},{"lineNumber":127,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":128,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityDescriptionHandler.handle(Objects.requireNonNull(withText(\"description\")), stateMachine);"},{"lineNumber":129,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":130,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).getStatePayload(384859024L, ActivityCreate.GROUP, ActivityDto.class);"},{"lineNumber":131,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).setState(anyLong(), any());"},{"lineNumber":132,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":133,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":134,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":135,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":136,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCatchExceptionOnSaveStatePayload_onDescriptionHandler() throws StateMachineException {"},{"lineNumber":137,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":138,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":139,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(stateMachine)"},{"lineNumber":140,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .updateStateData(anyLong(), any(), any());"},{"lineNumber":141,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":142,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityDescriptionHandler.handle(Objects.requireNonNull(withText(\"description\")), stateMachine);"},{"lineNumber":143,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":144,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).getStatePayload(384859024L, ActivityCreate.GROUP, ActivityDto.class);"},{"lineNumber":145,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).updateStateData(anyLong(), any(), any());"},{"lineNumber":146,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).setState(anyLong(), any());"},{"lineNumber":147,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":148,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":149,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":150,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":151,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldUpdateState_onDateHandler() throws StateMachineException {"},{"lineNumber":152,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":153,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .thenReturn(Optional.of(new ActivityDto(\"384859024\", \"title\", \"description\", null, null, null)));"},{"lineNumber":154,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":155,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":156,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityDateHandler.handle(Objects.requireNonNull(withText(\"11.12.22\")), stateMachine);"},{"lineNumber":157,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":158,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":159,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(384859024L, ActivityCreate.GET_TIME);"},{"lineNumber":160,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":161,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .updateStateData(eq(384859024L), eq(ActivityCreate.GROUP), refEq(new ActivityDto(\"384859024\", \"title\", \"description\", \"11.12.22\", null, null)));"},{"lineNumber":162,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1))"},{"lineNumber":163,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .sendMessage(any(), any());"},{"lineNumber":164,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":165,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":166,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":167,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCatchExceptionOnUpdateState_onDateHandler() throws StateMachineException {"},{"lineNumber":168,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":169,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":170,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(stateMachine)"},{"lineNumber":171,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(anyLong(), any());"},{"lineNumber":172,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":173,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityDateHandler.handle(Objects.requireNonNull(withText(\"11.12.22\")), stateMachine);"},{"lineNumber":174,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":175,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).getStatePayload(384859024L, ActivityCreate.GROUP, ActivityDto.class);"},{"lineNumber":176,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).setState(anyLong(), any());"},{"lineNumber":177,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":178,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":179,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":180,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":181,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCatchExceptionOnSaveStatePayload_onDateHandler() throws StateMachineException {"},{"lineNumber":182,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":183,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":184,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(stateMachine)"},{"lineNumber":185,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .updateStateData(anyLong(), any(), any());"},{"lineNumber":186,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":187,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityDateHandler.handle(Objects.requireNonNull(withText(\"11.12.22\")), stateMachine);"},{"lineNumber":188,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":189,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).getStatePayload(384859024L, ActivityCreate.GROUP, ActivityDto.class);"},{"lineNumber":190,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).updateStateData(anyLong(), any(), any());"},{"lineNumber":191,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).setState(anyLong(), any());"},{"lineNumber":192,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":193,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":194,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":195,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":196,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldFailValidation_onDateHandler() throws StateMachineException {"},{"lineNumber":197,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityDateHandler.handle(Objects.requireNonNull(withText(\"11/12/22\")), stateMachine);"},{"lineNumber":198,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":199,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).getStatePayload(anyLong(), any(), any());"},{"lineNumber":200,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).updateStateData(anyLong(), any(), any());"},{"lineNumber":201,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).setState(anyLong(), any());"},{"lineNumber":202,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":203,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":204,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":205,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":206,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldUpdateState_onTimeHandler() throws StateMachineException {"},{"lineNumber":207,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":208,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .thenReturn(Optional.of(new ActivityDto(\"384859024\", \"title\", \"description\", \"11.12.22\", null, null)));"},{"lineNumber":209,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":210,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":211,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityTimeHandler.handle(Objects.requireNonNull(withText(\"11:12\")), stateMachine);"},{"lineNumber":212,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":213,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":214,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(384859024L, ActivityCreate.GET_LOCATION);"},{"lineNumber":215,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":216,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .updateStateData(eq(384859024L), eq(ActivityCreate.GROUP), refEq(new ActivityDto(\"384859024\", \"title\", \"description\", \"11.12.22\", \"11:12\", null)));"},{"lineNumber":217,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1))"},{"lineNumber":218,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .sendMessage(any(), any());"},{"lineNumber":219,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":220,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":221,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":222,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCatchExceptionOnUpdateState_onTimeHandler() throws StateMachineException {"},{"lineNumber":223,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":224,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":225,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(stateMachine)"},{"lineNumber":226,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(anyLong(), any());"},{"lineNumber":227,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":228,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityTimeHandler.handle(Objects.requireNonNull(withText(\"11:12\")), stateMachine);"},{"lineNumber":229,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":230,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).getStatePayload(384859024L, ActivityCreate.GROUP, ActivityDto.class);"},{"lineNumber":231,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).setState(anyLong(), any());"},{"lineNumber":232,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":233,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":234,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":235,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":236,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCatchExceptionOnSaveStatePayload_onTimeHandler() throws StateMachineException {"},{"lineNumber":237,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":238,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":239,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(stateMachine)"},{"lineNumber":240,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .updateStateData(anyLong(), any(), any());"},{"lineNumber":241,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":242,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityTimeHandler.handle(Objects.requireNonNull(withText(\"11:12\")), stateMachine);"},{"lineNumber":243,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":244,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).getStatePayload(384859024L, ActivityCreate.GROUP, ActivityDto.class);"},{"lineNumber":245,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).updateStateData(anyLong(), any(), any());"},{"lineNumber":246,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).setState(anyLong(), any());"},{"lineNumber":247,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":248,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":249,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":250,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":251,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldFailValidation_onTimeHandler() throws StateMachineException {"},{"lineNumber":252,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityDateHandler.handle(Objects.requireNonNull(withText(\"11.12\")), stateMachine);"},{"lineNumber":253,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":254,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).getStatePayload(anyLong(), any(), any());"},{"lineNumber":255,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).updateStateData(anyLong(), any(), any());"},{"lineNumber":256,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).setState(anyLong(), any());"},{"lineNumber":257,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":258,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":259,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":260,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":261,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldSaveActivity_onLocationHandler() throws StateMachineException {"},{"lineNumber":262,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":263,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .thenReturn(Optional.of(new ActivityDto(\"384859024\", \"title\", \"description\", \"11.12.22\", \"11:12\", null)));"},{"lineNumber":264,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":265,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityLocationHandler.handle(Objects.requireNonNull(withText(\"location\")), stateMachine);"},{"lineNumber":266,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":267,"author":{"gitId":"Dmytro Zhornyk"},"content":"        ArgumentCaptor\u003cActivityDto\u003e argument \u003d ArgumentCaptor.forClass(ActivityDto.class);"},{"lineNumber":268,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityService, times(1))"},{"lineNumber":269,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .createActivity(argument.capture());"},{"lineNumber":270,"author":{"gitId":"Dmytro Zhornyk"},"content":"        assertEquals(\"title\", argument.getValue().getTitle());"},{"lineNumber":271,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":272,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":273,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(384859024L, new State.Any());"},{"lineNumber":274,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1))"},{"lineNumber":275,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .sendMessage(any(), any());"},{"lineNumber":276,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":277,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":278,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":279,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldThrowExceptionOnGetPayload_onDescriptionHandler() throws StateMachineException {"},{"lineNumber":280,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":281,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .thenReturn(Optional.empty());"},{"lineNumber":282,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":283,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityLocationHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":284,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":285,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityService, times(0)).createActivity(any());"},{"lineNumber":286,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).setState(any(), any());"},{"lineNumber":287,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":288,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":289,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":290,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":291,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldThrowExceptionOnSaveState_onDescriptionHandler() throws StateMachineException {"},{"lineNumber":292,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":293,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .thenReturn(Optional.of(new ActivityDto(\"384859024\", \"title\", \"description\", \"11.12.22\", \"11:12\", null)));"},{"lineNumber":294,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":295,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":296,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(stateMachine)"},{"lineNumber":297,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(anyLong(), any());"},{"lineNumber":298,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":299,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityLocationHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":300,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":301,"author":{"gitId":"Dmytro Zhornyk"},"content":"        ArgumentCaptor\u003cActivityDto\u003e argument \u003d ArgumentCaptor.forClass(ActivityDto.class);"},{"lineNumber":302,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityService, times(1)).createActivity(argument.capture());"},{"lineNumber":303,"author":{"gitId":"Dmytro Zhornyk"},"content":"        assertEquals(\"description\", argument.getValue().getDescription());"},{"lineNumber":304,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":305,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":306,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(384859024L, new State.Any());"},{"lineNumber":307,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1))"},{"lineNumber":308,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .sendMessage(any(), any());"},{"lineNumber":309,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":310,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":311,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private JSONObject messageJSON() {"},{"lineNumber":312,"author":{"gitId":"Dmytro Zhornyk"},"content":"        String updateJson \u003d \"\"\""},{"lineNumber":313,"author":{"gitId":"Dmytro Zhornyk"},"content":"                {"},{"lineNumber":314,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"message_id\":207,"},{"lineNumber":315,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"from\":{"},{"lineNumber":316,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"id\":384859024,"},{"lineNumber":317,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"is_bot\":false,"},{"lineNumber":318,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":319,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":320,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":321,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"language_code\":\"en\""},{"lineNumber":322,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   },"},{"lineNumber":323,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"chat\":{"},{"lineNumber":324,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"id\":384859024,"},{"lineNumber":325,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":326,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":327,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":328,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"type\":\"private\""},{"lineNumber":329,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   },"},{"lineNumber":330,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"date\":1669839096,"},{"lineNumber":331,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"text\":\"/course\","},{"lineNumber":332,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"entities\":["},{"lineNumber":333,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      {"},{"lineNumber":334,"author":{"gitId":"Dmytro Zhornyk"},"content":"                         \"offset\":0,"},{"lineNumber":335,"author":{"gitId":"Dmytro Zhornyk"},"content":"                         \"length\":7,"},{"lineNumber":336,"author":{"gitId":"Dmytro Zhornyk"},"content":"                         \"type\":\"bot_command\""},{"lineNumber":337,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      }"},{"lineNumber":338,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   ]"},{"lineNumber":339,"author":{"gitId":"Dmytro Zhornyk"},"content":"                }"},{"lineNumber":340,"author":{"gitId":"Dmytro Zhornyk"},"content":"                \"\"\";"},{"lineNumber":341,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return new JSONObject(updateJson);"},{"lineNumber":342,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":343,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":344,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private Message message() {"},{"lineNumber":345,"author":{"gitId":"Dmytro Zhornyk"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":346,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":347,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return mapper.readValue(messageJSON().toString(), Message.class);"},{"lineNumber":348,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":349,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return null;"},{"lineNumber":350,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":351,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":352,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":353,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private Message withText(String text) {"},{"lineNumber":354,"author":{"gitId":"Dmytro Zhornyk"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":355,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":356,"author":{"gitId":"Dmytro Zhornyk"},"content":"            JSONObject json \u003d messageJSON();"},{"lineNumber":357,"author":{"gitId":"Dmytro Zhornyk"},"content":"            json.put(\"text\", text);"},{"lineNumber":358,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return mapper.readValue(json.toString(), Message.class);"},{"lineNumber":359,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":360,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return null;"},{"lineNumber":361,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":362,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":363,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":364,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final State.Group group \u003d new State.Group() {"},{"lineNumber":365,"author":{"gitId":"Dmytro Zhornyk"},"content":"        @Override"},{"lineNumber":366,"author":{"gitId":"Dmytro Zhornyk"},"content":"        public String group() {"},{"lineNumber":367,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return \"key\";"},{"lineNumber":368,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":369,"author":{"gitId":"Dmytro Zhornyk"},"content":"    };"},{"lineNumber":370,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"},{"lineNumber":371,"author":{"gitId":"Dmytro Zhornyk"},"content":""}],"authorContributionMap":{"Dmytro Zhornyk":371}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/app/ActivityDeleteHandlerTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.app.activities.delete.ActivityDelete;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.app.activities.delete.ActivityDeleteGetId;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.app.activities.delete.ActivityDeleteHandler;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.json.JSONObject;"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.Objects;"},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.ArgumentMatchers.any;"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.ArgumentMatchers.anyLong;"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.ArgumentMatchers.eq;"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityDeleteHandlerTest {"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService \u003d mock(TelegramService.class);"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final StateMachine stateMachine \u003d mock(StateMachine.class);"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityService activityService \u003d mock(ActivityService.class);"},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityDeleteHandler activityDeleteHandler \u003d new ActivityDeleteHandler(telegramService, activityService);"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityDeleteGetId activityDeleteGetId \u003d new ActivityDeleteGetId(telegramService, activityService);"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldSendOptions_onDeleteHandler() throws StateMachineException {"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityDeleteHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityService, times(1)).getUserActivities(any());"},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).setState(any(), eq(ActivityDelete.GET_ID));"},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any(), any());"},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":44,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":45,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":46,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCatchExceptionOnUpdateState_onDeleteHandler() throws StateMachineException {"},{"lineNumber":47,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":48,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(stateMachine)"},{"lineNumber":49,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(anyLong(), any());"},{"lineNumber":50,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":51,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityDeleteHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":52,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":53,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityService, times(1)).getUserActivities(any());"},{"lineNumber":54,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).setState(384859024L, ActivityDelete.GET_ID);"},{"lineNumber":55,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":56,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":57,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":58,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":59,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldDeleteActivity_onGetIdHandler() throws StateMachineException {"},{"lineNumber":60,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityDeleteGetId.handle(callbackQuery(\"123\"), stateMachine);"},{"lineNumber":61,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":62,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityService, times(1)).deleteActivity(\"123\");"},{"lineNumber":63,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).setState(any(), eq(new State.Any()));"},{"lineNumber":64,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":65,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":66,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":67,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":68,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCatchExceptionOnUpdateState_onGetId() throws StateMachineException {"},{"lineNumber":69,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":70,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(stateMachine)"},{"lineNumber":71,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(anyLong(), any());"},{"lineNumber":72,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":73,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityDeleteGetId.handle(callbackQuery(\"data\"), stateMachine);"},{"lineNumber":74,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":75,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityService, times(1)).deleteActivity(any());"},{"lineNumber":76,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":77,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":78,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":79,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":80,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private JSONObject messageJSON() {"},{"lineNumber":81,"author":{"gitId":"Dmytro Zhornyk"},"content":"        String updateJson \u003d \"\"\""},{"lineNumber":82,"author":{"gitId":"Dmytro Zhornyk"},"content":"                {"},{"lineNumber":83,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"message_id\":207,"},{"lineNumber":84,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"from\":{"},{"lineNumber":85,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"id\":384859024,"},{"lineNumber":86,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"is_bot\":false,"},{"lineNumber":87,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":88,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":89,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":90,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"language_code\":\"en\""},{"lineNumber":91,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   },"},{"lineNumber":92,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"chat\":{"},{"lineNumber":93,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"id\":384859024,"},{"lineNumber":94,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":95,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":96,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":97,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"type\":\"private\""},{"lineNumber":98,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   },"},{"lineNumber":99,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"date\":1669839096,"},{"lineNumber":100,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"text\":\"/course\","},{"lineNumber":101,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"entities\":["},{"lineNumber":102,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      {"},{"lineNumber":103,"author":{"gitId":"Dmytro Zhornyk"},"content":"                         \"offset\":0,"},{"lineNumber":104,"author":{"gitId":"Dmytro Zhornyk"},"content":"                         \"length\":7,"},{"lineNumber":105,"author":{"gitId":"Dmytro Zhornyk"},"content":"                         \"type\":\"bot_command\""},{"lineNumber":106,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      }"},{"lineNumber":107,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   ]"},{"lineNumber":108,"author":{"gitId":"Dmytro Zhornyk"},"content":"                }"},{"lineNumber":109,"author":{"gitId":"Dmytro Zhornyk"},"content":"                \"\"\";"},{"lineNumber":110,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return new JSONObject(updateJson);"},{"lineNumber":111,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":112,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":113,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private Message message() {"},{"lineNumber":114,"author":{"gitId":"Dmytro Zhornyk"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":115,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":116,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return mapper.readValue(messageJSON().toString(), Message.class);"},{"lineNumber":117,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":118,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return null;"},{"lineNumber":119,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":120,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":121,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":122,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private CallbackQuery callbackQuery(String data) {"},{"lineNumber":123,"author":{"gitId":"Dmytro Zhornyk"},"content":"        Message message \u003d message();"},{"lineNumber":124,"author":{"gitId":"Dmytro Zhornyk"},"content":"        CallbackQuery callbackQuery \u003d new CallbackQuery();"},{"lineNumber":125,"author":{"gitId":"Dmytro Zhornyk"},"content":"        callbackQuery.setData(data);"},{"lineNumber":126,"author":{"gitId":"Dmytro Zhornyk"},"content":"        callbackQuery.setMessage(message);"},{"lineNumber":127,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return callbackQuery;"},{"lineNumber":128,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":129,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":130,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final State.Group group \u003d new State.Group() {"},{"lineNumber":131,"author":{"gitId":"Dmytro Zhornyk"},"content":"        @Override"},{"lineNumber":132,"author":{"gitId":"Dmytro Zhornyk"},"content":"        public String group() {"},{"lineNumber":133,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return \"key\";"},{"lineNumber":134,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":135,"author":{"gitId":"Dmytro Zhornyk"},"content":"    };"},{"lineNumber":136,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Dmytro Zhornyk":136}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/app/ActivityListHandlerTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.app.activities.create.*;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.app.activities.list.ActivitiesListHandler;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.ActivityDto;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.Objects;"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.ArgumentMatchers.any;"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.ArgumentMatchers.anyLong;"},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.ArgumentMatchers.eq;"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.ArgumentMatchers.refEq;"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityListHandlerTest {"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService \u003d mock(TelegramService.class);"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final StateMachine stateMachine \u003d mock(StateMachine.class);"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityService activityService \u003d mock(ActivityService.class);"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivitiesListHandler activitiesListHandler \u003d new ActivitiesListHandler(telegramService, activityService);"},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldReturnList_onListHandler() throws StateMachineException {"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activitiesListHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityService, times(1)).getUserActivities(any());"},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private Message message() {"},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":"        String updateJson \u003d \"\"\""},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":"                {"},{"lineNumber":44,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"message_id\":207,"},{"lineNumber":45,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"from\":{"},{"lineNumber":46,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"id\":384859024,"},{"lineNumber":47,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"is_bot\":false,"},{"lineNumber":48,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":49,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":50,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":51,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"language_code\":\"en\""},{"lineNumber":52,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   },"},{"lineNumber":53,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"chat\":{"},{"lineNumber":54,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"id\":384859024,"},{"lineNumber":55,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":56,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":57,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":58,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"type\":\"private\""},{"lineNumber":59,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   },"},{"lineNumber":60,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"date\":1669839096,"},{"lineNumber":61,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"text\":\"/course\","},{"lineNumber":62,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"entities\":["},{"lineNumber":63,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      {"},{"lineNumber":64,"author":{"gitId":"Dmytro Zhornyk"},"content":"                         \"offset\":0,"},{"lineNumber":65,"author":{"gitId":"Dmytro Zhornyk"},"content":"                         \"length\":7,"},{"lineNumber":66,"author":{"gitId":"Dmytro Zhornyk"},"content":"                         \"type\":\"bot_command\""},{"lineNumber":67,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      }"},{"lineNumber":68,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   ]"},{"lineNumber":69,"author":{"gitId":"Dmytro Zhornyk"},"content":"                }"},{"lineNumber":70,"author":{"gitId":"Dmytro Zhornyk"},"content":"                \"\"\";"},{"lineNumber":71,"author":{"gitId":"Dmytro Zhornyk"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":72,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":73,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return mapper.readValue(updateJson, Message.class);"},{"lineNumber":74,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":75,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return null;"},{"lineNumber":76,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":77,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":78,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Dmytro Zhornyk":78}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/app/ActivityUpdateHandlerTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.app;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.app.activities.delete.ActivityDelete;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.app.activities.delete.ActivityDeleteGetId;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.app.activities.delete.ActivityDeleteHandler;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.app.activities.update.*;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.CourseDto;"},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.exception.IncorrectIdException;"},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.json.JSONObject;"},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.Objects;"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.Optional;"},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.ArgumentMatchers.any;"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.ArgumentMatchers.anyLong;"},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.ArgumentMatchers.eq;"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityUpdateHandlerTest {"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final TelegramService telegramService \u003d mock(TelegramService.class);"},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final StateMachine stateMachine \u003d mock(StateMachine.class);"},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityService activityService \u003d mock(ActivityService.class);"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityUpdateHandler activityUpdateHandler \u003d new ActivityUpdateHandler(telegramService, activityService);"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityUpdateGetId activityUpdateGetId \u003d new ActivityUpdateGetId(telegramService);"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityUpdateGetField activityUpdateGetField \u003d new ActivityUpdateGetField(telegramService);"},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityUpdateGetValue activityUpdateGetValue \u003d new ActivityUpdateGetValue(telegramService, activityService);"},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":44,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldSendOptions_onUpdateHandler() throws StateMachineException {"},{"lineNumber":45,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityUpdateHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":46,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":47,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityService, times(1)).getUserActivities(any());"},{"lineNumber":48,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).setState(any(), eq(ActivityUpdate.GET_ID));"},{"lineNumber":49,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any(), any());"},{"lineNumber":50,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":51,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":52,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":53,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCatchExceptionOnUpdateState_onUpdateHandler() throws StateMachineException {"},{"lineNumber":54,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":55,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(stateMachine)"},{"lineNumber":56,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(anyLong(), any());"},{"lineNumber":57,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":58,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityUpdateHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":59,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":60,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityService, times(1)).getUserActivities(any());"},{"lineNumber":61,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).setState(384859024L, ActivityUpdate.GET_ID);"},{"lineNumber":62,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":63,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":64,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":65,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":66,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldUpdateState_onGetIdHandler() throws StateMachineException {"},{"lineNumber":67,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityUpdateGetId.handle(callbackQuery(\"123\"), stateMachine);"},{"lineNumber":68,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":69,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).updateStateData(eq(384859024L), eq(ActivityUpdate.GROUP), any());"},{"lineNumber":70,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).setState(any(), eq(ActivityUpdate.GET_FIELD));"},{"lineNumber":71,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any(), any());"},{"lineNumber":72,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":73,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":74,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":75,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCatchExceptionOnUpdateState_onGetId() throws StateMachineException {"},{"lineNumber":76,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":77,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(stateMachine)"},{"lineNumber":78,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .setState(anyLong(), any());"},{"lineNumber":79,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":80,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityUpdateGetId.handle(callbackQuery(\"data\"), stateMachine);"},{"lineNumber":81,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":82,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).updateStateData(eq(384859024L), eq(ActivityUpdate.GROUP), any());"},{"lineNumber":83,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).setState(anyLong(), eq(new State.Any()));"},{"lineNumber":84,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":85,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":86,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":87,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":88,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldUpdateState_onGetField() throws StateMachineException {"},{"lineNumber":89,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":90,"author":{"gitId":"Stas Boguta"},"content":"                .thenReturn(Optional.of(new ActivityUpdateDto(\"123\", null, null, null)));"},{"lineNumber":91,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":92,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityUpdateGetField.handle(callbackQuery(\"title\"), stateMachine);"},{"lineNumber":93,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":94,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).getStatePayload(384859024L, ActivityUpdate.GROUP, ActivityUpdateDto.class);"},{"lineNumber":95,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).updateStateData(eq(384859024L), eq(ActivityUpdate.GROUP), any());"},{"lineNumber":96,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).setState(any(), eq(ActivityUpdate.GET_VALUE));"},{"lineNumber":97,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":98,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":99,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":100,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":101,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCatchExceptionOnUpdateState_onGetField() throws StateMachineException {"},{"lineNumber":102,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":103,"author":{"gitId":"Stas Boguta"},"content":"                .thenReturn(Optional.of(new ActivityUpdateDto(\"123\", null, null, null)));"},{"lineNumber":104,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":105,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":106,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(stateMachine)"},{"lineNumber":107,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .updateStateData(anyLong(), any(), any());"},{"lineNumber":108,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":109,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityUpdateGetField.handle(callbackQuery(\"title\"), stateMachine);"},{"lineNumber":110,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":111,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).getStatePayload(384859024L, ActivityUpdate.GROUP, ActivityUpdateDto.class);"},{"lineNumber":112,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).updateStateData(eq(384859024L), eq(ActivityUpdate.GROUP), any());"},{"lineNumber":113,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).setState(anyLong(), eq(new State.Any()));"},{"lineNumber":114,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":115,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":116,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":117,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":118,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldUpdateActivity_onGetValue() throws StateMachineException, IncorrectIdException, JsonProcessingException {"},{"lineNumber":119,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":120,"author":{"gitId":"Stas Boguta"},"content":"                .thenReturn(Optional.of(new ActivityUpdateDto(\"123\", null, null, null)));"},{"lineNumber":121,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":122,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityUpdateGetValue.handle(withText(\"new title\"), stateMachine);"},{"lineNumber":123,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":124,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).getStatePayload(384859024L, ActivityUpdate.GROUP, ActivityUpdateDto.class);"},{"lineNumber":125,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityService, times(1)).updateActivity(any());"},{"lineNumber":126,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).setState(any(), eq(new State.Any()));"},{"lineNumber":127,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":128,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":129,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":130,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":131,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCatchExceptionOnUpdateActivity_onGetValue() throws StateMachineException, IncorrectIdException, JsonProcessingException {"},{"lineNumber":132,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":133,"author":{"gitId":"Stas Boguta"},"content":"                .thenReturn(Optional.of(new ActivityUpdateDto(\"123\", null, null, null)));"},{"lineNumber":134,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":135,"author":{"gitId":"Dmytro Zhornyk"},"content":"        doThrow(new IncorrectIdException())"},{"lineNumber":136,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .when(activityService)"},{"lineNumber":137,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .updateActivity(any());"},{"lineNumber":138,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":139,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityUpdateGetValue.handle(withText(\"new title\"), stateMachine);"},{"lineNumber":140,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":141,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(1)).getStatePayload(384859024L, ActivityUpdate.GROUP, ActivityUpdateDto.class);"},{"lineNumber":142,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityService, times(1)).updateActivity(any());"},{"lineNumber":143,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(stateMachine, times(0)).setState(any(), any());"},{"lineNumber":144,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":145,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":146,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":147,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private JSONObject messageJSON() {"},{"lineNumber":148,"author":{"gitId":"Dmytro Zhornyk"},"content":"        String updateJson \u003d \"\"\""},{"lineNumber":149,"author":{"gitId":"Dmytro Zhornyk"},"content":"                {"},{"lineNumber":150,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"message_id\":207,"},{"lineNumber":151,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"from\":{"},{"lineNumber":152,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"id\":384859024,"},{"lineNumber":153,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"is_bot\":false,"},{"lineNumber":154,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":155,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":156,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":157,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"language_code\":\"en\""},{"lineNumber":158,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   },"},{"lineNumber":159,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"chat\":{"},{"lineNumber":160,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"id\":384859024,"},{"lineNumber":161,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":162,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":163,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":164,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      \"type\":\"private\""},{"lineNumber":165,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   },"},{"lineNumber":166,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"date\":1669839096,"},{"lineNumber":167,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"text\":\"/course\","},{"lineNumber":168,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   \"entities\":["},{"lineNumber":169,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      {"},{"lineNumber":170,"author":{"gitId":"Dmytro Zhornyk"},"content":"                         \"offset\":0,"},{"lineNumber":171,"author":{"gitId":"Dmytro Zhornyk"},"content":"                         \"length\":7,"},{"lineNumber":172,"author":{"gitId":"Dmytro Zhornyk"},"content":"                         \"type\":\"bot_command\""},{"lineNumber":173,"author":{"gitId":"Dmytro Zhornyk"},"content":"                      }"},{"lineNumber":174,"author":{"gitId":"Dmytro Zhornyk"},"content":"                   ]"},{"lineNumber":175,"author":{"gitId":"Dmytro Zhornyk"},"content":"                }"},{"lineNumber":176,"author":{"gitId":"Dmytro Zhornyk"},"content":"                \"\"\";"},{"lineNumber":177,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return new JSONObject(updateJson);"},{"lineNumber":178,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":179,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":180,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private Message message() {"},{"lineNumber":181,"author":{"gitId":"Dmytro Zhornyk"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":182,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":183,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return mapper.readValue(messageJSON().toString(), Message.class);"},{"lineNumber":184,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":185,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return null;"},{"lineNumber":186,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":187,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":188,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":189,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private Message withText(String text) {"},{"lineNumber":190,"author":{"gitId":"Dmytro Zhornyk"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":191,"author":{"gitId":"Dmytro Zhornyk"},"content":"        try {"},{"lineNumber":192,"author":{"gitId":"Dmytro Zhornyk"},"content":"            JSONObject json \u003d messageJSON();"},{"lineNumber":193,"author":{"gitId":"Dmytro Zhornyk"},"content":"            json.put(\"text\", text);"},{"lineNumber":194,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return mapper.readValue(json.toString(), Message.class);"},{"lineNumber":195,"author":{"gitId":"Dmytro Zhornyk"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":196,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return null;"},{"lineNumber":197,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":198,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":199,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":200,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private CallbackQuery callbackQuery(String data) {"},{"lineNumber":201,"author":{"gitId":"Dmytro Zhornyk"},"content":"        Message message \u003d message();"},{"lineNumber":202,"author":{"gitId":"Dmytro Zhornyk"},"content":"        CallbackQuery callbackQuery \u003d new CallbackQuery();"},{"lineNumber":203,"author":{"gitId":"Dmytro Zhornyk"},"content":"        callbackQuery.setData(data);"},{"lineNumber":204,"author":{"gitId":"Dmytro Zhornyk"},"content":"        callbackQuery.setMessage(message);"},{"lineNumber":205,"author":{"gitId":"Dmytro Zhornyk"},"content":"        return callbackQuery;"},{"lineNumber":206,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":207,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":208,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final State.Group group \u003d new State.Group() {"},{"lineNumber":209,"author":{"gitId":"Dmytro Zhornyk"},"content":"        @Override"},{"lineNumber":210,"author":{"gitId":"Dmytro Zhornyk"},"content":"        public String group() {"},{"lineNumber":211,"author":{"gitId":"Dmytro Zhornyk"},"content":"            return \"key\";"},{"lineNumber":212,"author":{"gitId":"Dmytro Zhornyk"},"content":"        }"},{"lineNumber":213,"author":{"gitId":"Dmytro Zhornyk"},"content":"    };"},{"lineNumber":214,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Stas Boguta":4,"Dmytro Zhornyk":210}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/app/CompetenceDeleteHandlerTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.competence.delete.*;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.CompetenceUpdateDto;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":"import org.checkerframework.checker.units.qual.A;"},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":"import org.checkerframework.checker.units.qual.C;"},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":"import org.json.JSONObject;"},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":"import java.util.ArrayList;"},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":"import java.util.Objects;"},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":"import java.util.Optional;"},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":"import static org.mockito.ArgumentMatchers.*;"},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceDeleteHandlerTest {"},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService \u003d mock(TelegramService.class);"},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":"    private final StateMachine stateMachine \u003d mock(StateMachine.class);"},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"    private final ActivityService activityService \u003d mock(ActivityService.class);"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":"    private final CompetenceDeleteHandler competenceDeleteHandler \u003d new CompetenceDeleteHandler(telegramService, activityService);"},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":"    private final CompetenceDeleteValue competenceDeleteValue \u003d new CompetenceDeleteValue(telegramService, activityService);"},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":"    private final CompetenceDeleteGetCompetences competenceDeleteGetCompetences \u003d new CompetenceDeleteGetCompetences(telegramService, activityService);"},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"    void shouldSendOptions_onDeleteHandler() throws StateMachineException {"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":"        competenceDeleteHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":"        verify(activityService, times(1)).getUserActivities(any());"},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(any(), eq(CompetenceDelete.GET_COMPETENCES));"},{"lineNumber":46,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any(), any());"},{"lineNumber":47,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":48,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":49,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":50,"author":{"gitId":"Stas Boguta"},"content":"    void shouldCatchExceptionOnUpdateState_onDeleteHandler() throws StateMachineException {"},{"lineNumber":51,"author":{"gitId":"Stas Boguta"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":52,"author":{"gitId":"Stas Boguta"},"content":"                .when(stateMachine)"},{"lineNumber":53,"author":{"gitId":"Stas Boguta"},"content":"                .setState(anyLong(), any());"},{"lineNumber":54,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":55,"author":{"gitId":"Stas Boguta"},"content":"        competenceDeleteHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":56,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":57,"author":{"gitId":"Stas Boguta"},"content":"        verify(activityService, times(1)).getUserActivities(any());"},{"lineNumber":58,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CompetenceDelete.GET_COMPETENCES);"},{"lineNumber":59,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":60,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":61,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":62,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":63,"author":{"gitId":"Stas Boguta"},"content":"    void shouldSendOptions_onGetCompetencesHandler() throws StateMachineException {"},{"lineNumber":64,"author":{"gitId":"Stas Boguta"},"content":"        ArrayList\u003cActivityEntity\u003e activityEntities \u003d new ArrayList\u003c\u003e();"},{"lineNumber":65,"author":{"gitId":"Stas Boguta"},"content":"        ArrayList\u003cString\u003e competences \u003d new ArrayList\u003c\u003e();"},{"lineNumber":66,"author":{"gitId":"Stas Boguta"},"content":"        competences.add(\"some\");"},{"lineNumber":67,"author":{"gitId":"Stas Boguta"},"content":"        activityEntities.add(new ActivityEntity(\"someid\", null, null, null, null, null, null, competences));"},{"lineNumber":68,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":69,"author":{"gitId":"Stas Boguta"},"content":"        when(activityService.getUserActivities(any()))"},{"lineNumber":70,"author":{"gitId":"Stas Boguta"},"content":"                .thenReturn(activityEntities);"},{"lineNumber":71,"author":{"gitId":"Stas Boguta"},"content":"        competenceDeleteGetCompetences.handle(callbackQuery(\"someid\"), stateMachine);"},{"lineNumber":72,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":73,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CompetenceDelete.DELETE);"},{"lineNumber":74,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any(), any());"},{"lineNumber":75,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":76,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":77,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":78,"author":{"gitId":"Stas Boguta"},"content":"    void shouldNotSendOptions_onGetCompetencesHandler() throws StateMachineException {"},{"lineNumber":79,"author":{"gitId":"Stas Boguta"},"content":"        ArrayList\u003cActivityEntity\u003e activityEntities \u003d new ArrayList\u003c\u003e();"},{"lineNumber":80,"author":{"gitId":"Stas Boguta"},"content":"        ArrayList\u003cString\u003e competences \u003d new ArrayList\u003c\u003e();"},{"lineNumber":81,"author":{"gitId":"Stas Boguta"},"content":"        activityEntities.add(new ActivityEntity(\"someid\", null, null, null, null, null, null, competences));"},{"lineNumber":82,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":83,"author":{"gitId":"Stas Boguta"},"content":"        when(activityService.getUserActivities(any()))"},{"lineNumber":84,"author":{"gitId":"Stas Boguta"},"content":"                .thenReturn(activityEntities);"},{"lineNumber":85,"author":{"gitId":"Stas Boguta"},"content":"        competenceDeleteGetCompetences.handle(callbackQuery(\"someid\"), stateMachine);"},{"lineNumber":86,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":87,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(384859024L, new State.Any());"},{"lineNumber":88,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":89,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":90,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":91,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":92,"author":{"gitId":"Stas Boguta"},"content":"    void shouldCatchExceptionOnUpdateState_onGetCompetencesHandler() throws StateMachineException {"},{"lineNumber":93,"author":{"gitId":"Stas Boguta"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":94,"author":{"gitId":"Stas Boguta"},"content":"                .when(stateMachine)"},{"lineNumber":95,"author":{"gitId":"Stas Boguta"},"content":"                .setState(anyLong(), any());"},{"lineNumber":96,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":97,"author":{"gitId":"Stas Boguta"},"content":"        competenceDeleteGetCompetences.handle(callbackQuery(\"someid\"), stateMachine);"},{"lineNumber":98,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":99,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":100,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":101,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":102,"author":{"gitId":"Stas Boguta"},"content":"    void shouldDelete_onDeleteValueHandler() throws StateMachineException {"},{"lineNumber":103,"author":{"gitId":"Stas Boguta"},"content":"        ArrayList\u003cString\u003e competences \u003d new ArrayList\u003c\u003e();"},{"lineNumber":104,"author":{"gitId":"Stas Boguta"},"content":"        competences.add(\"some\");"},{"lineNumber":105,"author":{"gitId":"Stas Boguta"},"content":"        ActivityEntity entity \u003d new ActivityEntity(\"someid\", null, null, null, null, null, null, competences);"},{"lineNumber":106,"author":{"gitId":"Stas Boguta"},"content":"        ActivityUpdateDto activityUpdateDto \u003d new ActivityUpdateDto();"},{"lineNumber":107,"author":{"gitId":"Stas Boguta"},"content":"        activityUpdateDto.setActivityId(\"someid\");"},{"lineNumber":108,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":109,"author":{"gitId":"Stas Boguta"},"content":"        CompetenceUpdateDto competenceUpdateDto \u003d new CompetenceUpdateDto();"},{"lineNumber":110,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateDto.setActivityUpdateDto(activityUpdateDto);"},{"lineNumber":111,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateDto.setEntity(entity);"},{"lineNumber":112,"author":{"gitId":"Stas Boguta"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":113,"author":{"gitId":"Stas Boguta"},"content":"                .thenReturn(Optional.of(competenceUpdateDto));"},{"lineNumber":114,"author":{"gitId":"Stas Boguta"},"content":"        competenceDeleteValue.handle(callbackQuery(\"some\"), stateMachine);"},{"lineNumber":115,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":116,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(384859024L, new State.Any());"},{"lineNumber":117,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":118,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":119,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":120,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":121,"author":{"gitId":"Stas Boguta"},"content":"    void shouldCatchExceptionOnUpdateState_onDeleteValueHandler() throws StateMachineException {"},{"lineNumber":122,"author":{"gitId":"Stas Boguta"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":123,"author":{"gitId":"Stas Boguta"},"content":"                .when(stateMachine)"},{"lineNumber":124,"author":{"gitId":"Stas Boguta"},"content":"                .setState(anyLong(), any());"},{"lineNumber":125,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":126,"author":{"gitId":"Stas Boguta"},"content":"        competenceDeleteValue.handle(callbackQuery(\"someid\"), stateMachine);"},{"lineNumber":127,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":128,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":129,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":130,"author":{"gitId":"Stas Boguta"},"content":"    private JSONObject messageJSON() {"},{"lineNumber":131,"author":{"gitId":"Stas Boguta"},"content":"        String updateJson \u003d \"\"\""},{"lineNumber":132,"author":{"gitId":"Stas Boguta"},"content":"                {"},{"lineNumber":133,"author":{"gitId":"Stas Boguta"},"content":"                   \"message_id\":207,"},{"lineNumber":134,"author":{"gitId":"Stas Boguta"},"content":"                   \"from\":{"},{"lineNumber":135,"author":{"gitId":"Stas Boguta"},"content":"                      \"id\":384859024,"},{"lineNumber":136,"author":{"gitId":"Stas Boguta"},"content":"                      \"is_bot\":false,"},{"lineNumber":137,"author":{"gitId":"Stas Boguta"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":138,"author":{"gitId":"Stas Boguta"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":139,"author":{"gitId":"Stas Boguta"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":140,"author":{"gitId":"Stas Boguta"},"content":"                      \"language_code\":\"en\""},{"lineNumber":141,"author":{"gitId":"Stas Boguta"},"content":"                   },"},{"lineNumber":142,"author":{"gitId":"Stas Boguta"},"content":"                   \"chat\":{"},{"lineNumber":143,"author":{"gitId":"Stas Boguta"},"content":"                      \"id\":384859024,"},{"lineNumber":144,"author":{"gitId":"Stas Boguta"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":145,"author":{"gitId":"Stas Boguta"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":146,"author":{"gitId":"Stas Boguta"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":147,"author":{"gitId":"Stas Boguta"},"content":"                      \"type\":\"private\""},{"lineNumber":148,"author":{"gitId":"Stas Boguta"},"content":"                   },"},{"lineNumber":149,"author":{"gitId":"Stas Boguta"},"content":"                   \"date\":1669839096,"},{"lineNumber":150,"author":{"gitId":"Stas Boguta"},"content":"                   \"text\":\"/course\","},{"lineNumber":151,"author":{"gitId":"Stas Boguta"},"content":"                   \"entities\":["},{"lineNumber":152,"author":{"gitId":"Stas Boguta"},"content":"                      {"},{"lineNumber":153,"author":{"gitId":"Stas Boguta"},"content":"                         \"offset\":0,"},{"lineNumber":154,"author":{"gitId":"Stas Boguta"},"content":"                         \"length\":7,"},{"lineNumber":155,"author":{"gitId":"Stas Boguta"},"content":"                         \"type\":\"bot_command\""},{"lineNumber":156,"author":{"gitId":"Stas Boguta"},"content":"                      }"},{"lineNumber":157,"author":{"gitId":"Stas Boguta"},"content":"                   ]"},{"lineNumber":158,"author":{"gitId":"Stas Boguta"},"content":"                }"},{"lineNumber":159,"author":{"gitId":"Stas Boguta"},"content":"                \"\"\";"},{"lineNumber":160,"author":{"gitId":"Stas Boguta"},"content":"        return new JSONObject(updateJson);"},{"lineNumber":161,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":162,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":163,"author":{"gitId":"Stas Boguta"},"content":"    private Message message() {"},{"lineNumber":164,"author":{"gitId":"Stas Boguta"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":165,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":166,"author":{"gitId":"Stas Boguta"},"content":"            return mapper.readValue(messageJSON().toString(), Message.class);"},{"lineNumber":167,"author":{"gitId":"Stas Boguta"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":168,"author":{"gitId":"Stas Boguta"},"content":"            return null;"},{"lineNumber":169,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":170,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":171,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":172,"author":{"gitId":"Stas Boguta"},"content":"    private CallbackQuery callbackQuery(String data) {"},{"lineNumber":173,"author":{"gitId":"Stas Boguta"},"content":"        Message message \u003d message();"},{"lineNumber":174,"author":{"gitId":"Stas Boguta"},"content":"        CallbackQuery callbackQuery \u003d new CallbackQuery();"},{"lineNumber":175,"author":{"gitId":"Stas Boguta"},"content":"        callbackQuery.setData(data);"},{"lineNumber":176,"author":{"gitId":"Stas Boguta"},"content":"        callbackQuery.setMessage(message);"},{"lineNumber":177,"author":{"gitId":"Stas Boguta"},"content":"        return callbackQuery;"},{"lineNumber":178,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":179,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":180,"author":{"gitId":"Stas Boguta"},"content":"    private final State.Group group \u003d new State.Group() {"},{"lineNumber":181,"author":{"gitId":"Stas Boguta"},"content":"        @Override"},{"lineNumber":182,"author":{"gitId":"Stas Boguta"},"content":"        public String group() {"},{"lineNumber":183,"author":{"gitId":"Stas Boguta"},"content":"            return \"key\";"},{"lineNumber":184,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":185,"author":{"gitId":"Stas Boguta"},"content":"    };"},{"lineNumber":186,"author":{"gitId":"Stas Boguta"},"content":"}"}],"authorContributionMap":{"Stas Boguta":186}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/app/CompetenceListHandlerTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.competence.create.CompetenceCreate;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.competence.list.*;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":"import java.util.Objects;"},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":"import static org.mockito.ArgumentMatchers.any;"},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceListHandlerTest {"},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService \u003d mock(TelegramService.class);"},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"    private final StateMachine stateMachine \u003d mock(StateMachine.class);"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":"    private final ActivityService activityService \u003d mock(ActivityService.class);"},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":"    private final CompetenceListHandler competenceListHandler \u003d new CompetenceListHandler(telegramService, activityService);"},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":"    private final CompetenceListGetCompetences competenceListGetCompetences \u003d new CompetenceListGetCompetences(telegramService, activityService);"},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"    void shouldUpdateState_onListHandler() throws StateMachineException {"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":"        competenceListHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CompetenceList.GET_COMPETENCES);"},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any(), any());"},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":"    void shouldCatchExceptionOnUpdateState_onListHandler() throws StateMachineException {"},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":"                .when(stateMachine)"},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":"                .setState(anyLong(), any());"},{"lineNumber":46,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":47,"author":{"gitId":"Stas Boguta"},"content":"        competenceListHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":48,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":49,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CompetenceList.GET_COMPETENCES);"},{"lineNumber":50,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":51,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":52,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":53,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":54,"author":{"gitId":"Stas Boguta"},"content":"    void shouldUpdateState_onGetCompetencesHandler() throws StateMachineException {"},{"lineNumber":55,"author":{"gitId":"Stas Boguta"},"content":"        competenceListGetCompetences.handle(callbackQuery(\"someid\"), stateMachine);"},{"lineNumber":56,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":57,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":58,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":59,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":60,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":61,"author":{"gitId":"Stas Boguta"},"content":"    void shouldCatchExceptionOnUpdateState_onGetCompetencesHandler() throws StateMachineException {"},{"lineNumber":62,"author":{"gitId":"Stas Boguta"},"content":"        competenceListGetCompetences.handle(callbackQuery(\"someid\"), stateMachine);"},{"lineNumber":63,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":64,"author":{"gitId":"Stas Boguta"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":65,"author":{"gitId":"Stas Boguta"},"content":"                .when(stateMachine)"},{"lineNumber":66,"author":{"gitId":"Stas Boguta"},"content":"                .setState(anyLong(), any());"},{"lineNumber":67,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":68,"author":{"gitId":"Stas Boguta"},"content":"        competenceListGetCompetences.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":69,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":70,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":71,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":72,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":73,"author":{"gitId":"Stas Boguta"},"content":"    private Message message() {"},{"lineNumber":74,"author":{"gitId":"Stas Boguta"},"content":"        String updateJson \u003d \"\"\""},{"lineNumber":75,"author":{"gitId":"Stas Boguta"},"content":"                {"},{"lineNumber":76,"author":{"gitId":"Stas Boguta"},"content":"                   \"message_id\":207,"},{"lineNumber":77,"author":{"gitId":"Stas Boguta"},"content":"                   \"from\":{"},{"lineNumber":78,"author":{"gitId":"Stas Boguta"},"content":"                      \"id\":384859024,"},{"lineNumber":79,"author":{"gitId":"Stas Boguta"},"content":"                      \"is_bot\":false,"},{"lineNumber":80,"author":{"gitId":"Stas Boguta"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":81,"author":{"gitId":"Stas Boguta"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":82,"author":{"gitId":"Stas Boguta"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":83,"author":{"gitId":"Stas Boguta"},"content":"                      \"language_code\":\"en\""},{"lineNumber":84,"author":{"gitId":"Stas Boguta"},"content":"                   },"},{"lineNumber":85,"author":{"gitId":"Stas Boguta"},"content":"                   \"chat\":{"},{"lineNumber":86,"author":{"gitId":"Stas Boguta"},"content":"                      \"id\":384859024,"},{"lineNumber":87,"author":{"gitId":"Stas Boguta"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":88,"author":{"gitId":"Stas Boguta"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":89,"author":{"gitId":"Stas Boguta"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":90,"author":{"gitId":"Stas Boguta"},"content":"                      \"type\":\"private\""},{"lineNumber":91,"author":{"gitId":"Stas Boguta"},"content":"                   },"},{"lineNumber":92,"author":{"gitId":"Stas Boguta"},"content":"                   \"date\":1669839096,"},{"lineNumber":93,"author":{"gitId":"Stas Boguta"},"content":"                   \"text\":\"/course\","},{"lineNumber":94,"author":{"gitId":"Stas Boguta"},"content":"                   \"entities\":["},{"lineNumber":95,"author":{"gitId":"Stas Boguta"},"content":"                      {"},{"lineNumber":96,"author":{"gitId":"Stas Boguta"},"content":"                         \"offset\":0,"},{"lineNumber":97,"author":{"gitId":"Stas Boguta"},"content":"                         \"length\":7,"},{"lineNumber":98,"author":{"gitId":"Stas Boguta"},"content":"                         \"type\":\"bot_command\""},{"lineNumber":99,"author":{"gitId":"Stas Boguta"},"content":"                      }"},{"lineNumber":100,"author":{"gitId":"Stas Boguta"},"content":"                   ]"},{"lineNumber":101,"author":{"gitId":"Stas Boguta"},"content":"                }"},{"lineNumber":102,"author":{"gitId":"Stas Boguta"},"content":"                \"\"\";"},{"lineNumber":103,"author":{"gitId":"Stas Boguta"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":104,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":105,"author":{"gitId":"Stas Boguta"},"content":"            return mapper.readValue(updateJson, Message.class);"},{"lineNumber":106,"author":{"gitId":"Stas Boguta"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":107,"author":{"gitId":"Stas Boguta"},"content":"            return null;"},{"lineNumber":108,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":109,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":110,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":111,"author":{"gitId":"Stas Boguta"},"content":"    private CallbackQuery callbackQuery(String data) {"},{"lineNumber":112,"author":{"gitId":"Stas Boguta"},"content":"        Message message \u003d message();"},{"lineNumber":113,"author":{"gitId":"Stas Boguta"},"content":"        CallbackQuery callbackQuery \u003d new CallbackQuery();"},{"lineNumber":114,"author":{"gitId":"Stas Boguta"},"content":"        callbackQuery.setData(data);"},{"lineNumber":115,"author":{"gitId":"Stas Boguta"},"content":"        callbackQuery.setMessage(message);"},{"lineNumber":116,"author":{"gitId":"Stas Boguta"},"content":"        return callbackQuery;"},{"lineNumber":117,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":118,"author":{"gitId":"Stas Boguta"},"content":"}"}],"authorContributionMap":{"Stas Boguta":118}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/app/CompetenceUpdateHandlerTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.competence.update.*;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.CompetenceUpdateDto;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.exception.IncorrectIdException;"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":"import org.checkerframework.checker.units.qual.C;"},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":"import org.json.JSONObject;"},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":"import java.util.ArrayList;"},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":"import java.util.Objects;"},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":"import java.util.Optional;"},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":"import static org.mockito.ArgumentMatchers.*;"},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":"public class CompetenceUpdateHandlerTest {"},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService \u003d mock(TelegramService.class);"},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":"    private final StateMachine stateMachine \u003d mock(StateMachine.class);"},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"    private final ActivityService activityService \u003d mock(ActivityService.class);"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":"    private final CompetenceUpdateHandler competenceUpdateHandler \u003d new CompetenceUpdateHandler(telegramService, activityService);"},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":"    private final CompetenceUpdateGetCompetences competenceUpdateGetCompetences \u003d new CompetenceUpdateGetCompetences(telegramService, activityService);"},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":"    private final CompetenceUpdateGetValue competenceUpdateGetValue \u003d new CompetenceUpdateGetValue(telegramService, activityService);"},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":"    private final CompetenceUpdateValue competenceUpdateValue \u003d new CompetenceUpdateValue(telegramService, activityService);"},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":"    void shouldSendOptions_onUpdateHandler() throws StateMachineException {"},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":"        verify(activityService, times(1)).getUserActivities(any());"},{"lineNumber":46,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(any(), eq(CompetenceUpdate.GET_COMPETENCES));"},{"lineNumber":47,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any(), any());"},{"lineNumber":48,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":49,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":50,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":51,"author":{"gitId":"Stas Boguta"},"content":"    void shouldCatchExceptionOnUpdateState_onUpdateHandler() throws StateMachineException {"},{"lineNumber":52,"author":{"gitId":"Stas Boguta"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":53,"author":{"gitId":"Stas Boguta"},"content":"                .when(stateMachine)"},{"lineNumber":54,"author":{"gitId":"Stas Boguta"},"content":"                .setState(anyLong(), any());"},{"lineNumber":55,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":56,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":57,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":58,"author":{"gitId":"Stas Boguta"},"content":"        verify(activityService, times(1)).getUserActivities(any());"},{"lineNumber":59,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CompetenceUpdate.GET_COMPETENCES);"},{"lineNumber":60,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":61,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":62,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":63,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":64,"author":{"gitId":"Stas Boguta"},"content":"    void shouldUpdateState_onGetCompetencesHandler() throws StateMachineException {"},{"lineNumber":65,"author":{"gitId":"Stas Boguta"},"content":"        ArrayList\u003cActivityEntity\u003e activityEntities \u003d new ArrayList\u003c\u003e();"},{"lineNumber":66,"author":{"gitId":"Stas Boguta"},"content":"        ArrayList\u003cString\u003e competences \u003d new ArrayList\u003c\u003e();"},{"lineNumber":67,"author":{"gitId":"Stas Boguta"},"content":"        competences.add(\"some\");"},{"lineNumber":68,"author":{"gitId":"Stas Boguta"},"content":"        activityEntities.add(new ActivityEntity(\"someid\", null, null, null, null, null, null, competences));"},{"lineNumber":69,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":70,"author":{"gitId":"Stas Boguta"},"content":"        when(activityService.getUserActivities(any()))"},{"lineNumber":71,"author":{"gitId":"Stas Boguta"},"content":"                .thenReturn(activityEntities);"},{"lineNumber":72,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":73,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateGetCompetences.handle(callbackQuery(\"someid\"), stateMachine);"},{"lineNumber":74,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":75,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).updateStateData(eq(384859024L), eq(CompetenceUpdate.GROUP), any());"},{"lineNumber":76,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(any(), eq(CompetenceUpdate.GET_VALUE));"},{"lineNumber":77,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any(), any());"},{"lineNumber":78,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":79,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":80,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":81,"author":{"gitId":"Stas Boguta"},"content":"    void shouldNotUpdateState_onGetCompetencesHandler() throws StateMachineException {"},{"lineNumber":82,"author":{"gitId":"Stas Boguta"},"content":"        ArrayList\u003cActivityEntity\u003e activityEntities \u003d new ArrayList\u003c\u003e();"},{"lineNumber":83,"author":{"gitId":"Stas Boguta"},"content":"        ArrayList\u003cString\u003e competences \u003d new ArrayList\u003c\u003e();"},{"lineNumber":84,"author":{"gitId":"Stas Boguta"},"content":"        activityEntities.add(new ActivityEntity(\"someid\", null, null, null, null, null, null, competences));"},{"lineNumber":85,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":86,"author":{"gitId":"Stas Boguta"},"content":"        when(activityService.getUserActivities(any()))"},{"lineNumber":87,"author":{"gitId":"Stas Boguta"},"content":"                .thenReturn(activityEntities);"},{"lineNumber":88,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":89,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateGetCompetences.handle(callbackQuery(\"someid\"), stateMachine);"},{"lineNumber":90,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":91,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(any(), eq(new State.Any()));"},{"lineNumber":92,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":93,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":94,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":95,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":96,"author":{"gitId":"Stas Boguta"},"content":"    void shouldCatchExceptionOnUpdateState_onGetCompetences() throws StateMachineException {"},{"lineNumber":97,"author":{"gitId":"Stas Boguta"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":98,"author":{"gitId":"Stas Boguta"},"content":"                .when(stateMachine)"},{"lineNumber":99,"author":{"gitId":"Stas Boguta"},"content":"                .setState(anyLong(), any());"},{"lineNumber":100,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":101,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateGetCompetences.handle(callbackQuery(\"data\"), stateMachine);"},{"lineNumber":102,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":103,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(0)).setState(anyLong(), eq(new State.Any()));"},{"lineNumber":104,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":105,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":106,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":107,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":108,"author":{"gitId":"Stas Boguta"},"content":"    void shouldChangeState_onGetValueHandler() throws StateMachineException {"},{"lineNumber":109,"author":{"gitId":"Stas Boguta"},"content":"        ArrayList\u003cString\u003e competences \u003d new ArrayList\u003c\u003e();"},{"lineNumber":110,"author":{"gitId":"Stas Boguta"},"content":"        competences.add(\"some\");"},{"lineNumber":111,"author":{"gitId":"Stas Boguta"},"content":"        ActivityEntity entity \u003d new ActivityEntity(\"someid\", null, null, null, null, null, null, competences);"},{"lineNumber":112,"author":{"gitId":"Stas Boguta"},"content":"        ActivityUpdateDto activityUpdateDto \u003d new ActivityUpdateDto();"},{"lineNumber":113,"author":{"gitId":"Stas Boguta"},"content":"        activityUpdateDto.setActivityId(\"someid\");"},{"lineNumber":114,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":115,"author":{"gitId":"Stas Boguta"},"content":"        CompetenceUpdateDto competenceUpdateDto \u003d new CompetenceUpdateDto();"},{"lineNumber":116,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateDto.setActivityUpdateDto(activityUpdateDto);"},{"lineNumber":117,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateDto.setEntity(entity);"},{"lineNumber":118,"author":{"gitId":"Stas Boguta"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":119,"author":{"gitId":"Stas Boguta"},"content":"                .thenReturn(Optional.of(competenceUpdateDto));"},{"lineNumber":120,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateGetValue.handle(callbackQuery(\"some\"), stateMachine);"},{"lineNumber":121,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":122,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).updateStateData(eq(384859024L), eq(CompetenceUpdate.GROUP), any());"},{"lineNumber":123,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CompetenceUpdate.UPDATE_VALUE);"},{"lineNumber":124,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":125,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":126,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":127,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":128,"author":{"gitId":"Stas Boguta"},"content":"    void shouldCatchExceptionOnUpdateState_onGetValue() throws StateMachineException {"},{"lineNumber":129,"author":{"gitId":"Stas Boguta"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":130,"author":{"gitId":"Stas Boguta"},"content":"                .thenReturn(Optional.of(new ActivityUpdateDto(\"123\", null, null, null)));"},{"lineNumber":131,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":132,"author":{"gitId":"Stas Boguta"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":133,"author":{"gitId":"Stas Boguta"},"content":"                .when(stateMachine)"},{"lineNumber":134,"author":{"gitId":"Stas Boguta"},"content":"                .updateStateData(anyLong(), any(), any());"},{"lineNumber":135,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":136,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateGetValue.handle(callbackQuery(\"title\"), stateMachine);"},{"lineNumber":137,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":138,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).getStatePayload(384859024L, CompetenceUpdate.GROUP, CompetenceUpdateDto.class);"},{"lineNumber":139,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(0)).setState(anyLong(), eq(new State.Any()));"},{"lineNumber":140,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":141,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":142,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":143,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":144,"author":{"gitId":"Stas Boguta"},"content":"    void shouldChangeState_onUpdateValueHandler() throws StateMachineException {"},{"lineNumber":145,"author":{"gitId":"Stas Boguta"},"content":"        ArrayList\u003cString\u003e competences \u003d new ArrayList\u003c\u003e();"},{"lineNumber":146,"author":{"gitId":"Stas Boguta"},"content":"        competences.add(\"some\");"},{"lineNumber":147,"author":{"gitId":"Stas Boguta"},"content":"        ActivityEntity entity \u003d new ActivityEntity(\"someid\", null, null, null, null, null, null, competences);"},{"lineNumber":148,"author":{"gitId":"Stas Boguta"},"content":"        ActivityUpdateDto activityUpdateDto \u003d new ActivityUpdateDto();"},{"lineNumber":149,"author":{"gitId":"Stas Boguta"},"content":"        activityUpdateDto.setActivityId(\"someid\");"},{"lineNumber":150,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":151,"author":{"gitId":"Stas Boguta"},"content":"        CompetenceUpdateDto competenceUpdateDto \u003d new CompetenceUpdateDto();"},{"lineNumber":152,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateDto.setActivityUpdateDto(activityUpdateDto);"},{"lineNumber":153,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateDto.setEntity(entity);"},{"lineNumber":154,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateDto.setCompetence(\"some\");"},{"lineNumber":155,"author":{"gitId":"Stas Boguta"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":156,"author":{"gitId":"Stas Boguta"},"content":"                .thenReturn(Optional.of(competenceUpdateDto));"},{"lineNumber":157,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateValue.handle(Objects.requireNonNull(withText(\"newSome\")), stateMachine);"},{"lineNumber":158,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":159,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(384859024L, new State.Any());"},{"lineNumber":160,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":161,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":162,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":163,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":164,"author":{"gitId":"Stas Boguta"},"content":"    void shouldCatchExceptionOnUpdateState_onUpdateValueHandler() throws StateMachineException {"},{"lineNumber":165,"author":{"gitId":"Stas Boguta"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":166,"author":{"gitId":"Stas Boguta"},"content":"                .when(stateMachine)"},{"lineNumber":167,"author":{"gitId":"Stas Boguta"},"content":"                .updateStateData(anyLong(), any(), any());"},{"lineNumber":168,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":169,"author":{"gitId":"Stas Boguta"},"content":"        competenceUpdateValue.handle(Objects.requireNonNull(withText(\"newSome\")), stateMachine);"},{"lineNumber":170,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":171,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(0)).setState(anyLong(), eq(new State.Any()));"},{"lineNumber":172,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":173,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":174,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":175,"author":{"gitId":"Stas Boguta"},"content":"    private JSONObject messageJSON() {"},{"lineNumber":176,"author":{"gitId":"Stas Boguta"},"content":"        String updateJson \u003d \"\"\""},{"lineNumber":177,"author":{"gitId":"Stas Boguta"},"content":"                {"},{"lineNumber":178,"author":{"gitId":"Stas Boguta"},"content":"                   \"message_id\":207,"},{"lineNumber":179,"author":{"gitId":"Stas Boguta"},"content":"                   \"from\":{"},{"lineNumber":180,"author":{"gitId":"Stas Boguta"},"content":"                      \"id\":384859024,"},{"lineNumber":181,"author":{"gitId":"Stas Boguta"},"content":"                      \"is_bot\":false,"},{"lineNumber":182,"author":{"gitId":"Stas Boguta"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":183,"author":{"gitId":"Stas Boguta"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":184,"author":{"gitId":"Stas Boguta"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":185,"author":{"gitId":"Stas Boguta"},"content":"                      \"language_code\":\"en\""},{"lineNumber":186,"author":{"gitId":"Stas Boguta"},"content":"                   },"},{"lineNumber":187,"author":{"gitId":"Stas Boguta"},"content":"                   \"chat\":{"},{"lineNumber":188,"author":{"gitId":"Stas Boguta"},"content":"                      \"id\":384859024,"},{"lineNumber":189,"author":{"gitId":"Stas Boguta"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":190,"author":{"gitId":"Stas Boguta"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":191,"author":{"gitId":"Stas Boguta"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":192,"author":{"gitId":"Stas Boguta"},"content":"                      \"type\":\"private\""},{"lineNumber":193,"author":{"gitId":"Stas Boguta"},"content":"                   },"},{"lineNumber":194,"author":{"gitId":"Stas Boguta"},"content":"                   \"date\":1669839096,"},{"lineNumber":195,"author":{"gitId":"Stas Boguta"},"content":"                   \"text\":\"/course\","},{"lineNumber":196,"author":{"gitId":"Stas Boguta"},"content":"                   \"entities\":["},{"lineNumber":197,"author":{"gitId":"Stas Boguta"},"content":"                      {"},{"lineNumber":198,"author":{"gitId":"Stas Boguta"},"content":"                         \"offset\":0,"},{"lineNumber":199,"author":{"gitId":"Stas Boguta"},"content":"                         \"length\":7,"},{"lineNumber":200,"author":{"gitId":"Stas Boguta"},"content":"                         \"type\":\"bot_command\""},{"lineNumber":201,"author":{"gitId":"Stas Boguta"},"content":"                      }"},{"lineNumber":202,"author":{"gitId":"Stas Boguta"},"content":"                   ]"},{"lineNumber":203,"author":{"gitId":"Stas Boguta"},"content":"                }"},{"lineNumber":204,"author":{"gitId":"Stas Boguta"},"content":"                \"\"\";"},{"lineNumber":205,"author":{"gitId":"Stas Boguta"},"content":"        return new JSONObject(updateJson);"},{"lineNumber":206,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":207,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":208,"author":{"gitId":"Stas Boguta"},"content":"    private Message message() {"},{"lineNumber":209,"author":{"gitId":"Stas Boguta"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":210,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":211,"author":{"gitId":"Stas Boguta"},"content":"            return mapper.readValue(messageJSON().toString(), Message.class);"},{"lineNumber":212,"author":{"gitId":"Stas Boguta"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":213,"author":{"gitId":"Stas Boguta"},"content":"            return null;"},{"lineNumber":214,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":215,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":216,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":217,"author":{"gitId":"Stas Boguta"},"content":"    private Message withText(String text) {"},{"lineNumber":218,"author":{"gitId":"Stas Boguta"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":219,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":220,"author":{"gitId":"Stas Boguta"},"content":"            JSONObject json \u003d messageJSON();"},{"lineNumber":221,"author":{"gitId":"Stas Boguta"},"content":"            json.put(\"text\", text);"},{"lineNumber":222,"author":{"gitId":"Stas Boguta"},"content":"            return mapper.readValue(json.toString(), Message.class);"},{"lineNumber":223,"author":{"gitId":"Stas Boguta"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":224,"author":{"gitId":"Stas Boguta"},"content":"            return null;"},{"lineNumber":225,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":226,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":227,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":228,"author":{"gitId":"Stas Boguta"},"content":"    private CallbackQuery callbackQuery(String data) {"},{"lineNumber":229,"author":{"gitId":"Stas Boguta"},"content":"        Message message \u003d message();"},{"lineNumber":230,"author":{"gitId":"Stas Boguta"},"content":"        CallbackQuery callbackQuery \u003d new CallbackQuery();"},{"lineNumber":231,"author":{"gitId":"Stas Boguta"},"content":"        callbackQuery.setData(data);"},{"lineNumber":232,"author":{"gitId":"Stas Boguta"},"content":"        callbackQuery.setMessage(message);"},{"lineNumber":233,"author":{"gitId":"Stas Boguta"},"content":"        return callbackQuery;"},{"lineNumber":234,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":235,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":236,"author":{"gitId":"Stas Boguta"},"content":"    private final State.Group group \u003d new State.Group() {"},{"lineNumber":237,"author":{"gitId":"Stas Boguta"},"content":"        @Override"},{"lineNumber":238,"author":{"gitId":"Stas Boguta"},"content":"        public String group() {"},{"lineNumber":239,"author":{"gitId":"Stas Boguta"},"content":"            return \"key\";"},{"lineNumber":240,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":241,"author":{"gitId":"Stas Boguta"},"content":"    };"},{"lineNumber":242,"author":{"gitId":"Stas Boguta"},"content":"}"}],"authorContributionMap":{"Stas Boguta":242}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/app/CompetencesCreateHandlerTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Stas Boguta"},"content":"package edu.kmaooad.app;"},{"lineNumber":2,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":3,"author":{"gitId":"Stas Boguta"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"Stas Boguta"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":5,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.app.competence.create.*;"},{"lineNumber":6,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":7,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":8,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":9,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.ActivityDto;"},{"lineNumber":10,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":11,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.service.ActivityService;"},{"lineNumber":12,"author":{"gitId":"Stas Boguta"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":13,"author":{"gitId":"Stas Boguta"},"content":"import org.json.JSONObject;"},{"lineNumber":14,"author":{"gitId":"Stas Boguta"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":15,"author":{"gitId":"Stas Boguta"},"content":"import org.mockito.ArgumentCaptor;"},{"lineNumber":16,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":17,"author":{"gitId":"Stas Boguta"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":18,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":19,"author":{"gitId":"Stas Boguta"},"content":"import java.util.Objects;"},{"lineNumber":20,"author":{"gitId":"Stas Boguta"},"content":"import java.util.Optional;"},{"lineNumber":21,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":22,"author":{"gitId":"Stas Boguta"},"content":"import static org.junit.jupiter.api.Assertions.assertEquals;"},{"lineNumber":23,"author":{"gitId":"Stas Boguta"},"content":"import static org.mockito.ArgumentMatchers.*;"},{"lineNumber":24,"author":{"gitId":"Stas Boguta"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":25,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":26,"author":{"gitId":"Stas Boguta"},"content":"public class CompetencesCreateHandlerTest {"},{"lineNumber":27,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":28,"author":{"gitId":"Stas Boguta"},"content":"    private final TelegramService telegramService \u003d mock(TelegramService.class);"},{"lineNumber":29,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":30,"author":{"gitId":"Stas Boguta"},"content":"    private final StateMachine stateMachine \u003d mock(StateMachine.class);"},{"lineNumber":31,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":32,"author":{"gitId":"Stas Boguta"},"content":"    private final ActivityService activityService \u003d mock(ActivityService.class);"},{"lineNumber":33,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":34,"author":{"gitId":"Stas Boguta"},"content":"    private final CompetenceCreateHandler competenceCreateHandler \u003d new CompetenceCreateHandler(telegramService, activityService);"},{"lineNumber":35,"author":{"gitId":"Stas Boguta"},"content":"    private final CompetenceCreateGetActivityId competenceCreateGetActivityId \u003d new CompetenceCreateGetActivityId(telegramService);"},{"lineNumber":36,"author":{"gitId":"Stas Boguta"},"content":"    private final CompetenceCreateGetCompetences competenceCreateGetCompetences \u003d new CompetenceCreateGetCompetences(telegramService, activityService);"},{"lineNumber":37,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":38,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":39,"author":{"gitId":"Stas Boguta"},"content":"    void shouldUpdateState_onCreateHandler() throws StateMachineException {"},{"lineNumber":40,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":41,"author":{"gitId":"Stas Boguta"},"content":"        competenceCreateHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":42,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":43,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CompetenceCreate.GET_ACTIVITY_ID);"},{"lineNumber":44,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any(), any());"},{"lineNumber":45,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":46,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":47,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":48,"author":{"gitId":"Stas Boguta"},"content":"    void shouldCatchExceptionOnUpdateState_onCreateHandler() throws StateMachineException {"},{"lineNumber":49,"author":{"gitId":"Stas Boguta"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":50,"author":{"gitId":"Stas Boguta"},"content":"                .when(stateMachine)"},{"lineNumber":51,"author":{"gitId":"Stas Boguta"},"content":"                .setState(anyLong(), any());"},{"lineNumber":52,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":53,"author":{"gitId":"Stas Boguta"},"content":"        competenceCreateHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":54,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":55,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CompetenceCreate.GET_ACTIVITY_ID);"},{"lineNumber":56,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":57,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":58,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":59,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":60,"author":{"gitId":"Stas Boguta"},"content":"    void shouldUpdateState_onGetActivityIdHandler() throws StateMachineException {"},{"lineNumber":61,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":62,"author":{"gitId":"Stas Boguta"},"content":"        competenceCreateGetActivityId.handle(callbackQuery(\"someid\"), stateMachine);"},{"lineNumber":63,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":64,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CompetenceCreate.GET_COMPETENCES);"},{"lineNumber":65,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":66,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":67,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":68,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":69,"author":{"gitId":"Stas Boguta"},"content":"    void shouldCatchExceptionOnUpdateState_onGetActivityIdHandler() throws StateMachineException {"},{"lineNumber":70,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":71,"author":{"gitId":"Stas Boguta"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":72,"author":{"gitId":"Stas Boguta"},"content":"                .when(stateMachine)"},{"lineNumber":73,"author":{"gitId":"Stas Boguta"},"content":"                .setState(anyLong(), any());"},{"lineNumber":74,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":75,"author":{"gitId":"Stas Boguta"},"content":"        competenceCreateGetActivityId.handle(callbackQuery(\"someid\"), stateMachine);"},{"lineNumber":76,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":77,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CompetenceCreate.GET_COMPETENCES);"},{"lineNumber":78,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":79,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":80,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":81,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":82,"author":{"gitId":"Stas Boguta"},"content":"    void shouldUpdateState_onGetCompetencesHandler() throws StateMachineException {"},{"lineNumber":83,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":84,"author":{"gitId":"Stas Boguta"},"content":"        competenceCreateGetCompetences.handle(Objects.requireNonNull(withText(\"Some competence\")), stateMachine);"},{"lineNumber":85,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":86,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).getStatePayload(384859024L, CompetenceCreate.GROUP, ActivityUpdateDto.class);"},{"lineNumber":87,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":88,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":89,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":90,"author":{"gitId":"Stas Boguta"},"content":"    @Test"},{"lineNumber":91,"author":{"gitId":"Stas Boguta"},"content":"    void shouldCatchExceptionOnUpdateState_onGetCompetencesHandler() throws StateMachineException {"},{"lineNumber":92,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":93,"author":{"gitId":"Stas Boguta"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":94,"author":{"gitId":"Stas Boguta"},"content":"                .when(stateMachine)"},{"lineNumber":95,"author":{"gitId":"Stas Boguta"},"content":"                .setState(anyLong(), any());"},{"lineNumber":96,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":97,"author":{"gitId":"Stas Boguta"},"content":"        competenceCreateGetCompetences.handle(Objects.requireNonNull(withText(\"Some competence\")), stateMachine);"},{"lineNumber":98,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":99,"author":{"gitId":"Stas Boguta"},"content":"        verify(stateMachine, times(1)).getStatePayload(384859024L, CompetenceCreate.GROUP, ActivityUpdateDto.class);"},{"lineNumber":100,"author":{"gitId":"Stas Boguta"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":101,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":102,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":103,"author":{"gitId":"Stas Boguta"},"content":"    private JSONObject messageJSON() {"},{"lineNumber":104,"author":{"gitId":"Stas Boguta"},"content":"        String updateJson \u003d \"\"\""},{"lineNumber":105,"author":{"gitId":"Stas Boguta"},"content":"                {"},{"lineNumber":106,"author":{"gitId":"Stas Boguta"},"content":"                   \"message_id\":207,"},{"lineNumber":107,"author":{"gitId":"Stas Boguta"},"content":"                   \"from\":{"},{"lineNumber":108,"author":{"gitId":"Stas Boguta"},"content":"                      \"id\":384859024,"},{"lineNumber":109,"author":{"gitId":"Stas Boguta"},"content":"                      \"is_bot\":false,"},{"lineNumber":110,"author":{"gitId":"Stas Boguta"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":111,"author":{"gitId":"Stas Boguta"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":112,"author":{"gitId":"Stas Boguta"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":113,"author":{"gitId":"Stas Boguta"},"content":"                      \"language_code\":\"en\""},{"lineNumber":114,"author":{"gitId":"Stas Boguta"},"content":"                   },"},{"lineNumber":115,"author":{"gitId":"Stas Boguta"},"content":"                   \"chat\":{"},{"lineNumber":116,"author":{"gitId":"Stas Boguta"},"content":"                      \"id\":384859024,"},{"lineNumber":117,"author":{"gitId":"Stas Boguta"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":118,"author":{"gitId":"Stas Boguta"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":119,"author":{"gitId":"Stas Boguta"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":120,"author":{"gitId":"Stas Boguta"},"content":"                      \"type\":\"private\""},{"lineNumber":121,"author":{"gitId":"Stas Boguta"},"content":"                   },"},{"lineNumber":122,"author":{"gitId":"Stas Boguta"},"content":"                   \"date\":1669839096,"},{"lineNumber":123,"author":{"gitId":"Stas Boguta"},"content":"                   \"text\":\"/course\","},{"lineNumber":124,"author":{"gitId":"Stas Boguta"},"content":"                   \"entities\":["},{"lineNumber":125,"author":{"gitId":"Stas Boguta"},"content":"                      {"},{"lineNumber":126,"author":{"gitId":"Stas Boguta"},"content":"                         \"offset\":0,"},{"lineNumber":127,"author":{"gitId":"Stas Boguta"},"content":"                         \"length\":7,"},{"lineNumber":128,"author":{"gitId":"Stas Boguta"},"content":"                         \"type\":\"bot_command\""},{"lineNumber":129,"author":{"gitId":"Stas Boguta"},"content":"                      }"},{"lineNumber":130,"author":{"gitId":"Stas Boguta"},"content":"                   ]"},{"lineNumber":131,"author":{"gitId":"Stas Boguta"},"content":"                }"},{"lineNumber":132,"author":{"gitId":"Stas Boguta"},"content":"                \"\"\";"},{"lineNumber":133,"author":{"gitId":"Stas Boguta"},"content":"        return new JSONObject(updateJson);"},{"lineNumber":134,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":135,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":136,"author":{"gitId":"Stas Boguta"},"content":"    private Message message() {"},{"lineNumber":137,"author":{"gitId":"Stas Boguta"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":138,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":139,"author":{"gitId":"Stas Boguta"},"content":"            return mapper.readValue(messageJSON().toString(), Message.class);"},{"lineNumber":140,"author":{"gitId":"Stas Boguta"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":141,"author":{"gitId":"Stas Boguta"},"content":"            return null;"},{"lineNumber":142,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":143,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":144,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":145,"author":{"gitId":"Stas Boguta"},"content":"    private Message withText(String text) {"},{"lineNumber":146,"author":{"gitId":"Stas Boguta"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":147,"author":{"gitId":"Stas Boguta"},"content":"        try {"},{"lineNumber":148,"author":{"gitId":"Stas Boguta"},"content":"            JSONObject json \u003d messageJSON();"},{"lineNumber":149,"author":{"gitId":"Stas Boguta"},"content":"            json.put(\"text\", text);"},{"lineNumber":150,"author":{"gitId":"Stas Boguta"},"content":"            return mapper.readValue(json.toString(), Message.class);"},{"lineNumber":151,"author":{"gitId":"Stas Boguta"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":152,"author":{"gitId":"Stas Boguta"},"content":"            return null;"},{"lineNumber":153,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":154,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":155,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":156,"author":{"gitId":"Stas Boguta"},"content":"    private CallbackQuery callbackQuery(String data) {"},{"lineNumber":157,"author":{"gitId":"Stas Boguta"},"content":"        Message message \u003d message();"},{"lineNumber":158,"author":{"gitId":"Stas Boguta"},"content":"        CallbackQuery callbackQuery \u003d new CallbackQuery();"},{"lineNumber":159,"author":{"gitId":"Stas Boguta"},"content":"        callbackQuery.setData(data);"},{"lineNumber":160,"author":{"gitId":"Stas Boguta"},"content":"        callbackQuery.setMessage(message);"},{"lineNumber":161,"author":{"gitId":"Stas Boguta"},"content":"        return callbackQuery;"},{"lineNumber":162,"author":{"gitId":"Stas Boguta"},"content":"    }"},{"lineNumber":163,"author":{"gitId":"Stas Boguta"},"content":""},{"lineNumber":164,"author":{"gitId":"Stas Boguta"},"content":"    private final State.Group group \u003d new State.Group() {"},{"lineNumber":165,"author":{"gitId":"Stas Boguta"},"content":"        @Override"},{"lineNumber":166,"author":{"gitId":"Stas Boguta"},"content":"        public String group() {"},{"lineNumber":167,"author":{"gitId":"Stas Boguta"},"content":"            return \"key\";"},{"lineNumber":168,"author":{"gitId":"Stas Boguta"},"content":"        }"},{"lineNumber":169,"author":{"gitId":"Stas Boguta"},"content":"    };"},{"lineNumber":170,"author":{"gitId":"Stas Boguta"},"content":"}"},{"lineNumber":171,"author":{"gitId":"Stas Boguta"},"content":""}],"authorContributionMap":{"Stas Boguta":171}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/app/CourseHandlerTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.app;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.app.course.CourseCreate;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.app.course.CourseCreateHandler;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.app.course.CourseDescriptionHandler;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.app.course.CourseTitleHandler;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.dto.CourseDto;"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.service.CourseService;"},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":"import org.mockito.ArgumentCaptor;"},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":"import java.util.Objects;"},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"import java.util.Optional;"},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":"import static org.junit.jupiter.api.Assertions.assertEquals;"},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":"import static org.mockito.ArgumentMatchers.any;"},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":"public class CourseHandlerTest {"},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":"    private final TelegramService telegramService \u003d mock(TelegramService.class);"},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":"    private final StateMachine stateMachine \u003d mock(StateMachine.class);"},{"lineNumber":31,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":"    private final CourseService courseService \u003d mock(CourseService.class);"},{"lineNumber":33,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":34,"author":{"gitId":"VladKozyr"},"content":"    private final CourseCreateHandler courseCreateHandler \u003d new CourseCreateHandler(telegramService);"},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":"    private final CourseTitleHandler courseTitleHandler \u003d new CourseTitleHandler(telegramService);"},{"lineNumber":36,"author":{"gitId":"VladKozyr"},"content":"    private final CourseDescriptionHandler courseDescriptionHandler \u003d new CourseDescriptionHandler(telegramService, courseService);"},{"lineNumber":37,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":38,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":39,"author":{"gitId":"VladKozyr"},"content":"    void shouldUpdateState_onCreateHandler() throws StateMachineException {"},{"lineNumber":40,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":41,"author":{"gitId":"VladKozyr"},"content":"        courseCreateHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":42,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":43,"author":{"gitId":"VladKozyr"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CourseCreate.GET_TITLE);"},{"lineNumber":44,"author":{"gitId":"VladKozyr"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":45,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":46,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":47,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":48,"author":{"gitId":"VladKozyr"},"content":"    void shouldCatchExceptionOnUpdateState_onCreateHandler() throws StateMachineException {"},{"lineNumber":49,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":50,"author":{"gitId":"VladKozyr"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":51,"author":{"gitId":"VladKozyr"},"content":"                .when(stateMachine)"},{"lineNumber":52,"author":{"gitId":"VladKozyr"},"content":"                .setState(anyLong(), any());"},{"lineNumber":53,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":54,"author":{"gitId":"VladKozyr"},"content":"        courseCreateHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":55,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":56,"author":{"gitId":"VladKozyr"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CourseCreate.GET_TITLE);"},{"lineNumber":57,"author":{"gitId":"VladKozyr"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":58,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":59,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":60,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":61,"author":{"gitId":"VladKozyr"},"content":"    void shouldUpdateState_onTitleHandler() throws StateMachineException {"},{"lineNumber":62,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":63,"author":{"gitId":"VladKozyr"},"content":"        courseTitleHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":64,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":65,"author":{"gitId":"VladKozyr"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":66,"author":{"gitId":"VladKozyr"},"content":"                .setState(384859024L, CourseCreate.GET_DESCRIPTION);"},{"lineNumber":67,"author":{"gitId":"VladKozyr"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":68,"author":{"gitId":"VladKozyr"},"content":"                .updateStateData(eq(384859024L), eq(CourseCreate.GROUP), refEq(new CourseDto(\"/course\", null)));"},{"lineNumber":69,"author":{"gitId":"VladKozyr"},"content":"        verify(telegramService, times(1))"},{"lineNumber":70,"author":{"gitId":"VladKozyr"},"content":"                .sendMessage(any(), any());"},{"lineNumber":71,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":72,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":73,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":74,"author":{"gitId":"VladKozyr"},"content":"    void shouldCatchExceptionOnUpdateState_onTitleHandler() throws StateMachineException {"},{"lineNumber":75,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":76,"author":{"gitId":"VladKozyr"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":77,"author":{"gitId":"VladKozyr"},"content":"                .when(stateMachine)"},{"lineNumber":78,"author":{"gitId":"VladKozyr"},"content":"                .setState(anyLong(), any());"},{"lineNumber":79,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":80,"author":{"gitId":"VladKozyr"},"content":"        courseTitleHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":81,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":82,"author":{"gitId":"VladKozyr"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CourseCreate.GET_DESCRIPTION);"},{"lineNumber":83,"author":{"gitId":"VladKozyr"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":84,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":85,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":86,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":87,"author":{"gitId":"VladKozyr"},"content":"    void shouldCatchExceptionOnSaveStatePayload_onTitleHandler() throws StateMachineException {"},{"lineNumber":88,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":89,"author":{"gitId":"VladKozyr"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":90,"author":{"gitId":"VladKozyr"},"content":"                .when(stateMachine)"},{"lineNumber":91,"author":{"gitId":"VladKozyr"},"content":"                .updateStateData(anyLong(), any(), any());"},{"lineNumber":92,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":93,"author":{"gitId":"VladKozyr"},"content":"        courseTitleHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":94,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":95,"author":{"gitId":"VladKozyr"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":96,"author":{"gitId":"VladKozyr"},"content":"                .updateStateData(eq(384859024L), eq(CourseCreate.GROUP), refEq(new CourseDto(\"/course\", null)));"},{"lineNumber":97,"author":{"gitId":"VladKozyr"},"content":"        verify(stateMachine, times(0))"},{"lineNumber":98,"author":{"gitId":"VladKozyr"},"content":"                .setState(anyLong(), any());"},{"lineNumber":99,"author":{"gitId":"VladKozyr"},"content":"        verify(telegramService, times(1))"},{"lineNumber":100,"author":{"gitId":"VladKozyr"},"content":"                .sendMessage(any(), any());"},{"lineNumber":101,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":102,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":103,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":104,"author":{"gitId":"VladKozyr"},"content":"    void shouldSaveCourse_onDescriptionHandler() throws StateMachineException {"},{"lineNumber":105,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":106,"author":{"gitId":"VladKozyr"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":107,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.of(new CourseDto(\"TITLE\", null)));"},{"lineNumber":108,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":109,"author":{"gitId":"VladKozyr"},"content":"        courseDescriptionHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":110,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":111,"author":{"gitId":"VladKozyr"},"content":"        ArgumentCaptor\u003cCourseDto\u003e argument \u003d ArgumentCaptor.forClass(CourseDto.class);"},{"lineNumber":112,"author":{"gitId":"VladKozyr"},"content":"        verify(courseService, times(1))"},{"lineNumber":113,"author":{"gitId":"VladKozyr"},"content":"                .createCourse(argument.capture());"},{"lineNumber":114,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(\"/course\", argument.getValue().getDescription());"},{"lineNumber":115,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":116,"author":{"gitId":"VladKozyr"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":117,"author":{"gitId":"VladKozyr"},"content":"                .setState(384859024L, new State.Any());"},{"lineNumber":118,"author":{"gitId":"VladKozyr"},"content":"        verify(telegramService, times(1))"},{"lineNumber":119,"author":{"gitId":"VladKozyr"},"content":"                .sendMessage(any(), any());"},{"lineNumber":120,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":121,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":122,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":123,"author":{"gitId":"VladKozyr"},"content":"    void shouldThrowExceptionOnGetPayload_onDescriptionHandler() throws StateMachineException {"},{"lineNumber":124,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":125,"author":{"gitId":"VladKozyr"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":126,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.empty());"},{"lineNumber":127,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":128,"author":{"gitId":"VladKozyr"},"content":"        courseDescriptionHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":129,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":130,"author":{"gitId":"VladKozyr"},"content":"        verify(courseService, times(0)).createCourse(any());"},{"lineNumber":131,"author":{"gitId":"VladKozyr"},"content":"        verify(stateMachine, times(0)).setState(any(), any());"},{"lineNumber":132,"author":{"gitId":"VladKozyr"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":133,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":134,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":135,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":136,"author":{"gitId":"VladKozyr"},"content":"    void shouldThrowExceptionOnSaveState_onDescriptionHandler() throws StateMachineException {"},{"lineNumber":137,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":138,"author":{"gitId":"VladKozyr"},"content":"        when(stateMachine.getStatePayload(any(), any(), any()))"},{"lineNumber":139,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.of(new CourseDto(\"TITLE\", null)));"},{"lineNumber":140,"author":{"gitId":"VladKozyr"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":141,"author":{"gitId":"VladKozyr"},"content":"                .when(stateMachine)"},{"lineNumber":142,"author":{"gitId":"VladKozyr"},"content":"                .setState(anyLong(), any());"},{"lineNumber":143,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":144,"author":{"gitId":"VladKozyr"},"content":"        courseDescriptionHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":145,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":146,"author":{"gitId":"VladKozyr"},"content":"        ArgumentCaptor\u003cCourseDto\u003e argument \u003d ArgumentCaptor.forClass(CourseDto.class);"},{"lineNumber":147,"author":{"gitId":"VladKozyr"},"content":"        verify(courseService, times(1))"},{"lineNumber":148,"author":{"gitId":"VladKozyr"},"content":"                .createCourse(argument.capture());"},{"lineNumber":149,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(\"/course\", argument.getValue().getDescription());"},{"lineNumber":150,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":151,"author":{"gitId":"VladKozyr"},"content":"        verify(stateMachine, times(1))"},{"lineNumber":152,"author":{"gitId":"VladKozyr"},"content":"                .setState(384859024L, new State.Any());"},{"lineNumber":153,"author":{"gitId":"VladKozyr"},"content":"        verify(telegramService, times(1))"},{"lineNumber":154,"author":{"gitId":"VladKozyr"},"content":"                .sendMessage(any(), any());"},{"lineNumber":155,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":156,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":157,"author":{"gitId":"VladKozyr"},"content":"    private Message message() {"},{"lineNumber":158,"author":{"gitId":"VladKozyr"},"content":"        String updateJson \u003d \"\"\""},{"lineNumber":159,"author":{"gitId":"VladKozyr"},"content":"                {"},{"lineNumber":160,"author":{"gitId":"VladKozyr"},"content":"                   \"message_id\":207,"},{"lineNumber":161,"author":{"gitId":"VladKozyr"},"content":"                   \"from\":{"},{"lineNumber":162,"author":{"gitId":"VladKozyr"},"content":"                      \"id\":384859024,"},{"lineNumber":163,"author":{"gitId":"VladKozyr"},"content":"                      \"is_bot\":false,"},{"lineNumber":164,"author":{"gitId":"VladKozyr"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":165,"author":{"gitId":"VladKozyr"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":166,"author":{"gitId":"VladKozyr"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":167,"author":{"gitId":"VladKozyr"},"content":"                      \"language_code\":\"en\""},{"lineNumber":168,"author":{"gitId":"VladKozyr"},"content":"                   },"},{"lineNumber":169,"author":{"gitId":"VladKozyr"},"content":"                   \"chat\":{"},{"lineNumber":170,"author":{"gitId":"VladKozyr"},"content":"                      \"id\":384859024,"},{"lineNumber":171,"author":{"gitId":"VladKozyr"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":172,"author":{"gitId":"VladKozyr"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":173,"author":{"gitId":"VladKozyr"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":174,"author":{"gitId":"VladKozyr"},"content":"                      \"type\":\"private\""},{"lineNumber":175,"author":{"gitId":"VladKozyr"},"content":"                   },"},{"lineNumber":176,"author":{"gitId":"VladKozyr"},"content":"                   \"date\":1669839096,"},{"lineNumber":177,"author":{"gitId":"VladKozyr"},"content":"                   \"text\":\"/course\","},{"lineNumber":178,"author":{"gitId":"VladKozyr"},"content":"                   \"entities\":["},{"lineNumber":179,"author":{"gitId":"VladKozyr"},"content":"                      {"},{"lineNumber":180,"author":{"gitId":"VladKozyr"},"content":"                         \"offset\":0,"},{"lineNumber":181,"author":{"gitId":"VladKozyr"},"content":"                         \"length\":7,"},{"lineNumber":182,"author":{"gitId":"VladKozyr"},"content":"                         \"type\":\"bot_command\""},{"lineNumber":183,"author":{"gitId":"VladKozyr"},"content":"                      }"},{"lineNumber":184,"author":{"gitId":"VladKozyr"},"content":"                   ]"},{"lineNumber":185,"author":{"gitId":"VladKozyr"},"content":"                }"},{"lineNumber":186,"author":{"gitId":"VladKozyr"},"content":"                \"\"\";"},{"lineNumber":187,"author":{"gitId":"VladKozyr"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":188,"author":{"gitId":"VladKozyr"},"content":"        try {"},{"lineNumber":189,"author":{"gitId":"VladKozyr"},"content":"            return mapper.readValue(updateJson, Message.class);"},{"lineNumber":190,"author":{"gitId":"VladKozyr"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":191,"author":{"gitId":"VladKozyr"},"content":"            return null;"},{"lineNumber":192,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":193,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":194,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":195,"author":{"gitId":"VladKozyr"},"content":"    private final State.Group group \u003d new State.Group() {"},{"lineNumber":196,"author":{"gitId":"VladKozyr"},"content":"        @Override"},{"lineNumber":197,"author":{"gitId":"VladKozyr"},"content":"        public String group() {"},{"lineNumber":198,"author":{"gitId":"VladKozyr"},"content":"            return \"key\";"},{"lineNumber":199,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":200,"author":{"gitId":"VladKozyr"},"content":"    };"},{"lineNumber":201,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":201}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/app/CourseProjectsImportHandlerTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Danylo Makarenko"},"content":"package edu.kmaooad.app;"},{"lineNumber":2,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":3,"author":{"gitId":"Danylo Makarenko"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":5,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.app.course.bulk_import_projects.CourseProjectsImport;"},{"lineNumber":6,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.app.course.bulk_import_projects.CourseProjectsImportFileHandler;"},{"lineNumber":7,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.app.course.bulk_import_projects.CourseProjectsImportGetCourseIdHandler;"},{"lineNumber":8,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.app.course.bulk_import_projects.CourseProjectsImportHandler;"},{"lineNumber":9,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":10,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":11,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.exception.IncorrectIdException;"},{"lineNumber":12,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.model.CourseEntity;"},{"lineNumber":13,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.service.CourseService;"},{"lineNumber":14,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":15,"author":{"gitId":"Danylo Makarenko"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":16,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.CallbackQuery;"},{"lineNumber":17,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.Document;"},{"lineNumber":18,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.File;"},{"lineNumber":19,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":20,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":21,"author":{"gitId":"Danylo Makarenko"},"content":"import java.util.ArrayList;"},{"lineNumber":22,"author":{"gitId":"Danylo Makarenko"},"content":"import java.util.Objects;"},{"lineNumber":23,"author":{"gitId":"Danylo Makarenko"},"content":"import java.util.Optional;"},{"lineNumber":24,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":25,"author":{"gitId":"Danylo Makarenko"},"content":"import static org.mockito.ArgumentMatchers.any;"},{"lineNumber":26,"author":{"gitId":"Danylo Makarenko"},"content":"import static org.mockito.ArgumentMatchers.anyLong;"},{"lineNumber":27,"author":{"gitId":"Danylo Makarenko"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":28,"author":{"gitId":"Danylo Makarenko"},"content":"import static org.mockito.Mockito.times;"},{"lineNumber":29,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":30,"author":{"gitId":"Danylo Makarenko"},"content":"public class CourseProjectsImportHandlerTest {"},{"lineNumber":31,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":32,"author":{"gitId":"Danylo Makarenko"},"content":"    private final TelegramService telegramService \u003d mock(TelegramService.class);"},{"lineNumber":33,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":34,"author":{"gitId":"Danylo Makarenko"},"content":"    private final StateMachine stateMachine \u003d mock(StateMachine.class);"},{"lineNumber":35,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":36,"author":{"gitId":"Danylo Makarenko"},"content":"    private final CourseService courseService \u003d mock(CourseService.class);"},{"lineNumber":37,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":38,"author":{"gitId":"Danylo Makarenko"},"content":"    private final CourseProjectsImportHandler courseProjectsImportHandler \u003d new CourseProjectsImportHandler(telegramService, courseService);"},{"lineNumber":39,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":40,"author":{"gitId":"Danylo Makarenko"},"content":"    private final CourseProjectsImportGetCourseIdHandler courseProjectsImportGetCourseIdHandler \u003d new CourseProjectsImportGetCourseIdHandler(telegramService, courseService);"},{"lineNumber":41,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":42,"author":{"gitId":"Danylo Makarenko"},"content":"    private final CourseProjectsImportFileHandler courseProjectsImportFileHandler \u003d new CourseProjectsImportFileHandler(telegramService, courseService);"},{"lineNumber":43,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":44,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":45,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldUpdateState_onImportHandler() throws StateMachineException {"},{"lineNumber":46,"author":{"gitId":"Danylo Makarenko"},"content":"        courseProjectsImportHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":47,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":48,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CourseProjectsImport.GET_COURSE_ID);"},{"lineNumber":49,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any(), any());"},{"lineNumber":50,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":51,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":52,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":53,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldThrowException_onImportHandler() throws StateMachineException {"},{"lineNumber":54,"author":{"gitId":"Danylo Makarenko"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":55,"author":{"gitId":"Danylo Makarenko"},"content":"                .when(stateMachine)"},{"lineNumber":56,"author":{"gitId":"Danylo Makarenko"},"content":"                .setState(anyLong(), any());"},{"lineNumber":57,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":58,"author":{"gitId":"Danylo Makarenko"},"content":"        courseProjectsImportHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":59,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":60,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CourseProjectsImport.GET_COURSE_ID);"},{"lineNumber":61,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":62,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":63,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":64,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":65,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldUpdateStateAndPayload_onGetCourseIdHandler() throws StateMachineException, IncorrectIdException {"},{"lineNumber":66,"author":{"gitId":"Danylo Makarenko"},"content":"        when(courseService.getCourse(any()))"},{"lineNumber":67,"author":{"gitId":"Danylo Makarenko"},"content":"                .thenReturn(new CourseEntity(\"1\", \"title\", \"desc\", new ArrayList\u003c\u003e()));"},{"lineNumber":68,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":69,"author":{"gitId":"Danylo Makarenko"},"content":"        courseProjectsImportGetCourseIdHandler.handle(callbackQuery(message(), \"1\"), stateMachine);"},{"lineNumber":70,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":71,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CourseProjectsImport.GET_FILE);"},{"lineNumber":72,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(stateMachine, times(1)).updateStateData(384859024L, CourseProjectsImport.GROUP, \"1\");"},{"lineNumber":73,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":74,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":75,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":76,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":77,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldThrowForIncorrectId_onGetCourseIdHandler() throws StateMachineException, IncorrectIdException {"},{"lineNumber":78,"author":{"gitId":"Danylo Makarenko"},"content":"        doThrow(new IncorrectIdException())"},{"lineNumber":79,"author":{"gitId":"Danylo Makarenko"},"content":"                .when(courseService)"},{"lineNumber":80,"author":{"gitId":"Danylo Makarenko"},"content":"                .getCourse(any());"},{"lineNumber":81,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":82,"author":{"gitId":"Danylo Makarenko"},"content":"        courseProjectsImportGetCourseIdHandler.handle(callbackQuery(message(), \"1\"), stateMachine);"},{"lineNumber":83,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":84,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(stateMachine, times(0)).setState(anyLong(), any());"},{"lineNumber":85,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(stateMachine, times(0)).updateStateData(anyLong(), any(), any());"},{"lineNumber":86,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":87,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":88,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":89,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":90,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldSaveCourseProjectsFromFile() throws IncorrectIdException {"},{"lineNumber":91,"author":{"gitId":"Danylo Makarenko"},"content":"        File file \u003d new File();"},{"lineNumber":92,"author":{"gitId":"Danylo Makarenko"},"content":"        file.setFilePath(\"courses.csv\");"},{"lineNumber":93,"author":{"gitId":"Danylo Makarenko"},"content":"        file.setFileUniqueId(\"\");"},{"lineNumber":94,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":95,"author":{"gitId":"Danylo Makarenko"},"content":"        Document document \u003d new Document();"},{"lineNumber":96,"author":{"gitId":"Danylo Makarenko"},"content":"        document.setFileId(\"\");"},{"lineNumber":97,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":98,"author":{"gitId":"Danylo Makarenko"},"content":"        Message message \u003d message();"},{"lineNumber":99,"author":{"gitId":"Danylo Makarenko"},"content":"        message.setDocument(document);"},{"lineNumber":100,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":101,"author":{"gitId":"Danylo Makarenko"},"content":"        ClassLoader classLoader \u003d getClass().getClassLoader();"},{"lineNumber":102,"author":{"gitId":"Danylo Makarenko"},"content":"        java.io.File csvFile \u003d new java.io.File(classLoader.getResource(\"files/course_projects.csv\").getFile());"},{"lineNumber":103,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":104,"author":{"gitId":"Danylo Makarenko"},"content":"        when(telegramService.getFile(any()))"},{"lineNumber":105,"author":{"gitId":"Danylo Makarenko"},"content":"                .thenReturn(file);"},{"lineNumber":106,"author":{"gitId":"Danylo Makarenko"},"content":"        when(telegramService.downloadFile(any(), any()))"},{"lineNumber":107,"author":{"gitId":"Danylo Makarenko"},"content":"                .thenReturn(csvFile);"},{"lineNumber":108,"author":{"gitId":"Danylo Makarenko"},"content":"        when(stateMachine.getStatePayload(anyLong(), any(), any()))"},{"lineNumber":109,"author":{"gitId":"Danylo Makarenko"},"content":"                .thenReturn(Optional.of(\"1\"));"},{"lineNumber":110,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":111,"author":{"gitId":"Danylo Makarenko"},"content":"        courseProjectsImportFileHandler.handle(message, stateMachine);"},{"lineNumber":112,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":113,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(courseService, times(1)).addCourseProjects(any(), any());"},{"lineNumber":114,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":115,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":116,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":117,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldSendException_onIncorrectFile() throws IncorrectIdException {"},{"lineNumber":118,"author":{"gitId":"Danylo Makarenko"},"content":"        File file \u003d new File();"},{"lineNumber":119,"author":{"gitId":"Danylo Makarenko"},"content":"        file.setFilePath(\"courses.csv\");"},{"lineNumber":120,"author":{"gitId":"Danylo Makarenko"},"content":"        file.setFileUniqueId(\"\");"},{"lineNumber":121,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":122,"author":{"gitId":"Danylo Makarenko"},"content":"        Document document \u003d new Document();"},{"lineNumber":123,"author":{"gitId":"Danylo Makarenko"},"content":"        document.setFileId(\"\");"},{"lineNumber":124,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":125,"author":{"gitId":"Danylo Makarenko"},"content":"        Message message \u003d message();"},{"lineNumber":126,"author":{"gitId":"Danylo Makarenko"},"content":"        message.setDocument(document);"},{"lineNumber":127,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":128,"author":{"gitId":"Danylo Makarenko"},"content":"        ClassLoader classLoader \u003d getClass().getClassLoader();"},{"lineNumber":129,"author":{"gitId":"Danylo Makarenko"},"content":"        java.io.File csvFile \u003d new java.io.File(classLoader.getResource(\"files/courses_incorrect.csv\").getFile());"},{"lineNumber":130,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":131,"author":{"gitId":"Danylo Makarenko"},"content":"        when(telegramService.getFile(any()))"},{"lineNumber":132,"author":{"gitId":"Danylo Makarenko"},"content":"                .thenReturn(file);"},{"lineNumber":133,"author":{"gitId":"Danylo Makarenko"},"content":"        when(telegramService.downloadFile(any(), any()))"},{"lineNumber":134,"author":{"gitId":"Danylo Makarenko"},"content":"                .thenReturn(csvFile);"},{"lineNumber":135,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":136,"author":{"gitId":"Danylo Makarenko"},"content":"        courseProjectsImportFileHandler.handle(message, stateMachine);"},{"lineNumber":137,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":138,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(courseService, times(0)).addCourseProjects(any(), any());"},{"lineNumber":139,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":140,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":141,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":142,"author":{"gitId":"Danylo Makarenko"},"content":"    private Message message() {"},{"lineNumber":143,"author":{"gitId":"Danylo Makarenko"},"content":"        String updateJson \u003d \"\"\""},{"lineNumber":144,"author":{"gitId":"Danylo Makarenko"},"content":"                {"},{"lineNumber":145,"author":{"gitId":"Danylo Makarenko"},"content":"                   \"message_id\":207,"},{"lineNumber":146,"author":{"gitId":"Danylo Makarenko"},"content":"                   \"from\":{"},{"lineNumber":147,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"id\":384859024,"},{"lineNumber":148,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"is_bot\":false,"},{"lineNumber":149,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":150,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":151,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":152,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"language_code\":\"en\""},{"lineNumber":153,"author":{"gitId":"Danylo Makarenko"},"content":"                   },"},{"lineNumber":154,"author":{"gitId":"Danylo Makarenko"},"content":"                   \"chat\":{"},{"lineNumber":155,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"id\":384859024,"},{"lineNumber":156,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":157,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":158,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":159,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"type\":\"private\""},{"lineNumber":160,"author":{"gitId":"Danylo Makarenko"},"content":"                   },"},{"lineNumber":161,"author":{"gitId":"Danylo Makarenko"},"content":"                   \"date\":1669839096,"},{"lineNumber":162,"author":{"gitId":"Danylo Makarenko"},"content":"                   \"text\":\"/course\","},{"lineNumber":163,"author":{"gitId":"Danylo Makarenko"},"content":"                   \"entities\":["},{"lineNumber":164,"author":{"gitId":"Danylo Makarenko"},"content":"                      {"},{"lineNumber":165,"author":{"gitId":"Danylo Makarenko"},"content":"                         \"offset\":0,"},{"lineNumber":166,"author":{"gitId":"Danylo Makarenko"},"content":"                         \"length\":7,"},{"lineNumber":167,"author":{"gitId":"Danylo Makarenko"},"content":"                         \"type\":\"bot_command\""},{"lineNumber":168,"author":{"gitId":"Danylo Makarenko"},"content":"                      }"},{"lineNumber":169,"author":{"gitId":"Danylo Makarenko"},"content":"                   ]"},{"lineNumber":170,"author":{"gitId":"Danylo Makarenko"},"content":"                }"},{"lineNumber":171,"author":{"gitId":"Danylo Makarenko"},"content":"                \"\"\";"},{"lineNumber":172,"author":{"gitId":"Danylo Makarenko"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":173,"author":{"gitId":"Danylo Makarenko"},"content":"        try {"},{"lineNumber":174,"author":{"gitId":"Danylo Makarenko"},"content":"            return mapper.readValue(updateJson, Message.class);"},{"lineNumber":175,"author":{"gitId":"Danylo Makarenko"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":176,"author":{"gitId":"Danylo Makarenko"},"content":"            return null;"},{"lineNumber":177,"author":{"gitId":"Danylo Makarenko"},"content":"        }"},{"lineNumber":178,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":179,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":180,"author":{"gitId":"Danylo Makarenko"},"content":"    private CallbackQuery callbackQuery(Message message, String data) {"},{"lineNumber":181,"author":{"gitId":"Danylo Makarenko"},"content":"        CallbackQuery callbackQuery \u003d new CallbackQuery();"},{"lineNumber":182,"author":{"gitId":"Danylo Makarenko"},"content":"        callbackQuery.setData(data);"},{"lineNumber":183,"author":{"gitId":"Danylo Makarenko"},"content":"        callbackQuery.setMessage(message);"},{"lineNumber":184,"author":{"gitId":"Danylo Makarenko"},"content":"        return callbackQuery;"},{"lineNumber":185,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":186,"author":{"gitId":"Danylo Makarenko"},"content":"}"}],"authorContributionMap":{"Danylo Makarenko":186}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/app/CoursesImportHandlerTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Danylo Makarenko"},"content":"package edu.kmaooad.app;"},{"lineNumber":2,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":3,"author":{"gitId":"Danylo Makarenko"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":"import com.fasterxml.jackson.databind.ObjectMapper;"},{"lineNumber":5,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.app.course.bulk_import.CoursesImport;"},{"lineNumber":6,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.app.course.bulk_import.CoursesImportFileHandler;"},{"lineNumber":7,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.app.course.bulk_import.CoursesImportHandler;"},{"lineNumber":8,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.StateMachineException;"},{"lineNumber":9,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.core.state.StateMachine;"},{"lineNumber":10,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.service.CourseService;"},{"lineNumber":11,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":12,"author":{"gitId":"Danylo Makarenko"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":13,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.Document;"},{"lineNumber":14,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.File;"},{"lineNumber":15,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.Message;"},{"lineNumber":16,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":17,"author":{"gitId":"Danylo Makarenko"},"content":"import java.util.Objects;"},{"lineNumber":18,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":19,"author":{"gitId":"Danylo Makarenko"},"content":"import static org.mockito.ArgumentMatchers.any;"},{"lineNumber":20,"author":{"gitId":"Danylo Makarenko"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":21,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":22,"author":{"gitId":"Danylo Makarenko"},"content":"public class CoursesImportHandlerTest {"},{"lineNumber":23,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":24,"author":{"gitId":"Danylo Makarenko"},"content":"    private final TelegramService telegramService \u003d mock(TelegramService.class);"},{"lineNumber":25,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":26,"author":{"gitId":"Danylo Makarenko"},"content":"    private final StateMachine stateMachine \u003d mock(StateMachine.class);"},{"lineNumber":27,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":28,"author":{"gitId":"Danylo Makarenko"},"content":"    private final CourseService courseService \u003d mock(CourseService.class);"},{"lineNumber":29,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":30,"author":{"gitId":"Danylo Makarenko"},"content":"    private final CoursesImportHandler coursesImportHandler \u003d new CoursesImportHandler(telegramService);"},{"lineNumber":31,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":32,"author":{"gitId":"Danylo Makarenko"},"content":"    private final CoursesImportFileHandler coursesImportFileHandler \u003d new CoursesImportFileHandler(telegramService, courseService);"},{"lineNumber":33,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":34,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":35,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldUpdateState_onImportHandler() throws StateMachineException {"},{"lineNumber":36,"author":{"gitId":"Danylo Makarenko"},"content":"        coursesImportHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":37,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":38,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CoursesImport.GET_FILE);"},{"lineNumber":39,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":40,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":41,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":42,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":43,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldThrowException_onImportHandler() throws StateMachineException {"},{"lineNumber":44,"author":{"gitId":"Danylo Makarenko"},"content":"        doThrow(new StateMachineException(\"\"))"},{"lineNumber":45,"author":{"gitId":"Danylo Makarenko"},"content":"                .when(stateMachine)"},{"lineNumber":46,"author":{"gitId":"Danylo Makarenko"},"content":"                .setState(anyLong(), any());"},{"lineNumber":47,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":48,"author":{"gitId":"Danylo Makarenko"},"content":"        coursesImportHandler.handle(Objects.requireNonNull(message()), stateMachine);"},{"lineNumber":49,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":50,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(stateMachine, times(1)).setState(384859024L, CoursesImport.GET_FILE);"},{"lineNumber":51,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":52,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":53,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":54,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":55,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldSaveCoursesFromFile() {"},{"lineNumber":56,"author":{"gitId":"Danylo Makarenko"},"content":"        File file \u003d new File();"},{"lineNumber":57,"author":{"gitId":"Danylo Makarenko"},"content":"        file.setFilePath(\"courses.csv\");"},{"lineNumber":58,"author":{"gitId":"Danylo Makarenko"},"content":"        file.setFileUniqueId(\"\");"},{"lineNumber":59,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":60,"author":{"gitId":"Danylo Makarenko"},"content":"        Document document \u003d new Document();"},{"lineNumber":61,"author":{"gitId":"Danylo Makarenko"},"content":"        document.setFileId(\"\");"},{"lineNumber":62,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":63,"author":{"gitId":"Danylo Makarenko"},"content":"        Message message \u003d message();"},{"lineNumber":64,"author":{"gitId":"Danylo Makarenko"},"content":"        message.setDocument(document);"},{"lineNumber":65,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":66,"author":{"gitId":"Danylo Makarenko"},"content":"        ClassLoader classLoader \u003d getClass().getClassLoader();"},{"lineNumber":67,"author":{"gitId":"Danylo Makarenko"},"content":"        java.io.File csvFile \u003d new java.io.File(classLoader.getResource(\"files/courses.csv\").getFile());"},{"lineNumber":68,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":69,"author":{"gitId":"Danylo Makarenko"},"content":"        when(telegramService.getFile(any()))"},{"lineNumber":70,"author":{"gitId":"Danylo Makarenko"},"content":"                .thenReturn(file);"},{"lineNumber":71,"author":{"gitId":"Danylo Makarenko"},"content":"        when(telegramService.downloadFile(any(), any()))"},{"lineNumber":72,"author":{"gitId":"Danylo Makarenko"},"content":"                .thenReturn(csvFile);"},{"lineNumber":73,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":74,"author":{"gitId":"Danylo Makarenko"},"content":"        coursesImportFileHandler.handle(message, stateMachine);"},{"lineNumber":75,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":76,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(courseService, times(2)).createCourse(any());"},{"lineNumber":77,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":78,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":79,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":80,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldSendException_onIncorrectFile() {"},{"lineNumber":81,"author":{"gitId":"Danylo Makarenko"},"content":"        File file \u003d new File();"},{"lineNumber":82,"author":{"gitId":"Danylo Makarenko"},"content":"        file.setFilePath(\"courses.csv\");"},{"lineNumber":83,"author":{"gitId":"Danylo Makarenko"},"content":"        file.setFileUniqueId(\"\");"},{"lineNumber":84,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":85,"author":{"gitId":"Danylo Makarenko"},"content":"        Document document \u003d new Document();"},{"lineNumber":86,"author":{"gitId":"Danylo Makarenko"},"content":"        document.setFileId(\"\");"},{"lineNumber":87,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":88,"author":{"gitId":"Danylo Makarenko"},"content":"        Message message \u003d message();"},{"lineNumber":89,"author":{"gitId":"Danylo Makarenko"},"content":"        message.setDocument(document);"},{"lineNumber":90,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":91,"author":{"gitId":"Danylo Makarenko"},"content":"        ClassLoader classLoader \u003d getClass().getClassLoader();"},{"lineNumber":92,"author":{"gitId":"Danylo Makarenko"},"content":"        java.io.File csvFile \u003d new java.io.File(classLoader.getResource(\"files/courses_incorrect.csv\").getFile());"},{"lineNumber":93,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":94,"author":{"gitId":"Danylo Makarenko"},"content":"        when(telegramService.getFile(any()))"},{"lineNumber":95,"author":{"gitId":"Danylo Makarenko"},"content":"                .thenReturn(file);"},{"lineNumber":96,"author":{"gitId":"Danylo Makarenko"},"content":"        when(telegramService.downloadFile(any(), any()))"},{"lineNumber":97,"author":{"gitId":"Danylo Makarenko"},"content":"                .thenReturn(csvFile);"},{"lineNumber":98,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":99,"author":{"gitId":"Danylo Makarenko"},"content":"        coursesImportFileHandler.handle(message, stateMachine);"},{"lineNumber":100,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":101,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(courseService, times(0)).createCourse(any());"},{"lineNumber":102,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(telegramService, times(1)).sendMessage(any(), any());"},{"lineNumber":103,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":104,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":105,"author":{"gitId":"Danylo Makarenko"},"content":"    private Message message() {"},{"lineNumber":106,"author":{"gitId":"Danylo Makarenko"},"content":"        String updateJson \u003d \"\"\""},{"lineNumber":107,"author":{"gitId":"Danylo Makarenko"},"content":"                {"},{"lineNumber":108,"author":{"gitId":"Danylo Makarenko"},"content":"                   \"message_id\":207,"},{"lineNumber":109,"author":{"gitId":"Danylo Makarenko"},"content":"                   \"from\":{"},{"lineNumber":110,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"id\":384859024,"},{"lineNumber":111,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"is_bot\":false,"},{"lineNumber":112,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":113,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":114,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":115,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"language_code\":\"en\""},{"lineNumber":116,"author":{"gitId":"Danylo Makarenko"},"content":"                   },"},{"lineNumber":117,"author":{"gitId":"Danylo Makarenko"},"content":"                   \"chat\":{"},{"lineNumber":118,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"id\":384859024,"},{"lineNumber":119,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"first_name\":\"Vlad\","},{"lineNumber":120,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"last_name\":\"Kozyr\","},{"lineNumber":121,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"username\":\"vladyslav_kozyr\","},{"lineNumber":122,"author":{"gitId":"Danylo Makarenko"},"content":"                      \"type\":\"private\""},{"lineNumber":123,"author":{"gitId":"Danylo Makarenko"},"content":"                   },"},{"lineNumber":124,"author":{"gitId":"Danylo Makarenko"},"content":"                   \"date\":1669839096,"},{"lineNumber":125,"author":{"gitId":"Danylo Makarenko"},"content":"                   \"text\":\"/course\","},{"lineNumber":126,"author":{"gitId":"Danylo Makarenko"},"content":"                   \"entities\":["},{"lineNumber":127,"author":{"gitId":"Danylo Makarenko"},"content":"                      {"},{"lineNumber":128,"author":{"gitId":"Danylo Makarenko"},"content":"                         \"offset\":0,"},{"lineNumber":129,"author":{"gitId":"Danylo Makarenko"},"content":"                         \"length\":7,"},{"lineNumber":130,"author":{"gitId":"Danylo Makarenko"},"content":"                         \"type\":\"bot_command\""},{"lineNumber":131,"author":{"gitId":"Danylo Makarenko"},"content":"                      }"},{"lineNumber":132,"author":{"gitId":"Danylo Makarenko"},"content":"                   ]"},{"lineNumber":133,"author":{"gitId":"Danylo Makarenko"},"content":"                }"},{"lineNumber":134,"author":{"gitId":"Danylo Makarenko"},"content":"                \"\"\";"},{"lineNumber":135,"author":{"gitId":"Danylo Makarenko"},"content":"        ObjectMapper mapper \u003d new ObjectMapper();"},{"lineNumber":136,"author":{"gitId":"Danylo Makarenko"},"content":"        try {"},{"lineNumber":137,"author":{"gitId":"Danylo Makarenko"},"content":"            return mapper.readValue(updateJson, Message.class);"},{"lineNumber":138,"author":{"gitId":"Danylo Makarenko"},"content":"        } catch (JsonProcessingException exception) {"},{"lineNumber":139,"author":{"gitId":"Danylo Makarenko"},"content":"            return null;"},{"lineNumber":140,"author":{"gitId":"Danylo Makarenko"},"content":"        }"},{"lineNumber":141,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":142,"author":{"gitId":"Danylo Makarenko"},"content":"}"}],"authorContributionMap":{"Danylo Makarenko":142}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/service/ActivityServiceTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Dmytro Zhornyk"},"content":"package edu.kmaooad.service;"},{"lineNumber":2,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":3,"author":{"gitId":"Dmytro Zhornyk"},"content":"import com.fasterxml.jackson.core.JsonProcessingException;"},{"lineNumber":4,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.ActivityDto;"},{"lineNumber":5,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.ActivityUpdateDto;"},{"lineNumber":6,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.dto.CourseDto;"},{"lineNumber":7,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.exception.IncorrectIdException;"},{"lineNumber":8,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.model.ActivityEntity;"},{"lineNumber":9,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.model.CourseEntity;"},{"lineNumber":10,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.repository.ActivityRepository;"},{"lineNumber":11,"author":{"gitId":"Dmytro Zhornyk"},"content":"import edu.kmaooad.repository.CourseRepository;"},{"lineNumber":12,"author":{"gitId":"Dmytro Zhornyk"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":13,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":14,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.ArrayList;"},{"lineNumber":15,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.List;"},{"lineNumber":16,"author":{"gitId":"Dmytro Zhornyk"},"content":"import java.util.Optional;"},{"lineNumber":17,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":18,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.junit.jupiter.api.Assertions.*;"},{"lineNumber":19,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.ArgumentMatchers.any;"},{"lineNumber":20,"author":{"gitId":"Dmytro Zhornyk"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":21,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":22,"author":{"gitId":"Dmytro Zhornyk"},"content":"public class ActivityServiceTest {"},{"lineNumber":23,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":24,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityRepository activityRepository \u003d mock(ActivityRepository.class);"},{"lineNumber":25,"author":{"gitId":"Dmytro Zhornyk"},"content":"    private final ActivityService activityService \u003d new ActivityService(activityRepository);"},{"lineNumber":26,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":27,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":28,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldCreateActivity() {"},{"lineNumber":29,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(activityRepository.save(any()))"},{"lineNumber":30,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":31,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":32,"author":{"gitId":"Dmytro Zhornyk"},"content":"        ActivityDto activityDto \u003d new ActivityDto(\"owner_id\", \"title\", \"description\", \"11.11.2222\", \"11:11\", \"foo\");"},{"lineNumber":33,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityService.createActivity(activityDto);"},{"lineNumber":34,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":35,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityRepository, times(1)).save(any());"},{"lineNumber":36,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":37,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":38,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":39,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldDeleteCourse() {"},{"lineNumber":40,"author":{"gitId":"Dmytro Zhornyk"},"content":"        activityService.deleteActivity(\"id\");"},{"lineNumber":41,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityRepository, times(1)).deleteById(any());"},{"lineNumber":42,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":43,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":44,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":45,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldUpdateCourse() throws IncorrectIdException, JsonProcessingException {"},{"lineNumber":46,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(activityRepository.save(any()))"},{"lineNumber":47,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":48,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":49,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(activityRepository.findById(any()))"},{"lineNumber":50,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .then(invocationOnMock -\u003e"},{"lineNumber":51,"author":{"gitId":"Stas Boguta"},"content":"                        Optional.of(new ActivityEntity(invocationOnMock.getArgument(0), \"owner_id\", \"old_title\", \"old_description\", \"11.11.2222\", \"11:11\", \"foo\", new ArrayList\u003cString\u003e()))"},{"lineNumber":52,"author":{"gitId":"Dmytro Zhornyk"},"content":"                );"},{"lineNumber":53,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":54,"author":{"gitId":"Stas Boguta"},"content":"        ActivityUpdateDto activityUpdateDto \u003d new ActivityUpdateDto(\"id\", \"title\", \"new_title\", null);"},{"lineNumber":55,"author":{"gitId":"Dmytro Zhornyk"},"content":"        ActivityEntity result \u003d activityService.updateActivity(activityUpdateDto);"},{"lineNumber":56,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":57,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityRepository, times(1)).save(any());"},{"lineNumber":58,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityRepository, times(1)).findById(any());"},{"lineNumber":59,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":60,"author":{"gitId":"Dmytro Zhornyk"},"content":"        assertEquals(result.getTitle(), activityUpdateDto.getValue());"},{"lineNumber":61,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":62,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":63,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":64,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldThrowIncorrectIdExceptionOnUpdate() {"},{"lineNumber":65,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(activityRepository.save(any()))"},{"lineNumber":66,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":67,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":68,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(activityRepository.findById(any()))"},{"lineNumber":69,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .thenReturn(Optional.empty());"},{"lineNumber":70,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":71,"author":{"gitId":"Stas Boguta"},"content":"        ActivityUpdateDto dto \u003d new ActivityUpdateDto(\"id\", \"field\", \"description\", null);"},{"lineNumber":72,"author":{"gitId":"Dmytro Zhornyk"},"content":"        assertThrows(IncorrectIdException.class, () -\u003e activityService.updateActivity(dto));"},{"lineNumber":73,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":74,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityRepository, times(1)).findById(any());"},{"lineNumber":75,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityRepository, times(0)).save(any());"},{"lineNumber":76,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":77,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":78,"author":{"gitId":"Dmytro Zhornyk"},"content":"    @Test"},{"lineNumber":79,"author":{"gitId":"Dmytro Zhornyk"},"content":"    void shouldReturnAllCourses() {"},{"lineNumber":80,"author":{"gitId":"Dmytro Zhornyk"},"content":"        List\u003cActivityEntity\u003e activities \u003d new ArrayList\u003c\u003e();"},{"lineNumber":81,"author":{"gitId":"Stas Boguta"},"content":"        activities.add(new ActivityEntity(\"1\", \"11\", \"title1\", \"description1\", \"11.11.11\", \"11:11\", \"foo\", new ArrayList\u003cString\u003e()));"},{"lineNumber":82,"author":{"gitId":"Stas Boguta"},"content":"        activities.add(new ActivityEntity(\"2\", \"22\", \"title2\", \"description2\", \"22.22.22\", \"22:22\", \"bar\", new ArrayList\u003cString\u003e()));"},{"lineNumber":83,"author":{"gitId":"Stas Boguta"},"content":"        activities.add(new ActivityEntity(\"3\", \"33\", \"title3\", \"description3\", \"22.22.22\", \"22:22\", \"baz\", new ArrayList\u003cString\u003e()));"},{"lineNumber":84,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":85,"author":{"gitId":"Dmytro Zhornyk"},"content":"        when(activityRepository.findAll())"},{"lineNumber":86,"author":{"gitId":"Dmytro Zhornyk"},"content":"                .thenReturn(activities);"},{"lineNumber":87,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":88,"author":{"gitId":"Dmytro Zhornyk"},"content":"        List\u003cActivityEntity\u003e resultCourses \u003d activityService.getActivities();"},{"lineNumber":89,"author":{"gitId":"Dmytro Zhornyk"},"content":""},{"lineNumber":90,"author":{"gitId":"Dmytro Zhornyk"},"content":"        assertIterableEquals(resultCourses, activities);"},{"lineNumber":91,"author":{"gitId":"Dmytro Zhornyk"},"content":"        verify(activityRepository, times(1)).findAll();"},{"lineNumber":92,"author":{"gitId":"Dmytro Zhornyk"},"content":"    }"},{"lineNumber":93,"author":{"gitId":"Dmytro Zhornyk"},"content":"}"}],"authorContributionMap":{"Stas Boguta":6,"Dmytro Zhornyk":87}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/service/CourseServiceTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.service;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.dto.CourseDto;"},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.dto.CourseProjectDto;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.exception.IncorrectIdException;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.model.CourseEntity;"},{"lineNumber":7,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.model.CourseProjectEntity;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.repository.CourseRepository;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"import java.util.ArrayList;"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"import java.util.List;"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":"import java.util.Optional;"},{"lineNumber":14,"author":{"gitId":"Danylo Makarenko"},"content":"import java.util.stream.IntStream;"},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":"import static org.junit.jupiter.api.Assertions.*;"},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":"import static org.mockito.ArgumentMatchers.any;"},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":"public class CourseServiceTest {"},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":"    private final CourseRepository courseRepository \u003d mock(CourseRepository.class);"},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":"    private final CourseService courseService \u003d new CourseService(courseRepository);"},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":"    void shouldCreateCourse() {"},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":"        when(courseRepository.save(any()))"},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":"        CourseDto course \u003d new CourseDto(\"title\", \"description\");"},{"lineNumber":31,"author":{"gitId":"VladKozyr"},"content":"        CourseEntity result \u003d courseService.createCourse(course);"},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":33,"author":{"gitId":"VladKozyr"},"content":"        verify(courseRepository, times(1)).save(any());"},{"lineNumber":34,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(result.getTitle(), course.getTitle());"},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(result.getDescription(), course.getDescription());"},{"lineNumber":36,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":37,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":38,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":39,"author":{"gitId":"VladKozyr"},"content":"    void shouldDeleteCourse() {"},{"lineNumber":40,"author":{"gitId":"VladKozyr"},"content":"        courseService.deleteCourse(\"if\");"},{"lineNumber":41,"author":{"gitId":"VladKozyr"},"content":"        verify(courseRepository, times(1)).deleteById(any());"},{"lineNumber":42,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":43,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":44,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":45,"author":{"gitId":"VladKozyr"},"content":"    void shouldUpdateCourse() throws IncorrectIdException {"},{"lineNumber":46,"author":{"gitId":"VladKozyr"},"content":"        when(courseRepository.save(any()))"},{"lineNumber":47,"author":{"gitId":"VladKozyr"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":48,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":49,"author":{"gitId":"VladKozyr"},"content":"        when(courseRepository.findById(any()))"},{"lineNumber":50,"author":{"gitId":"VladKozyr"},"content":"                .then(invocationOnMock -\u003e"},{"lineNumber":51,"author":{"gitId":"Danylo Makarenko"},"content":"                        Optional.of(new CourseEntity(invocationOnMock.getArgument(0), \"old_title\", \"old_description\", new ArrayList\u003c\u003e()))"},{"lineNumber":52,"author":{"gitId":"VladKozyr"},"content":"                );"},{"lineNumber":53,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":54,"author":{"gitId":"VladKozyr"},"content":"        CourseDto course \u003d new CourseDto(\"title\", \"description\");"},{"lineNumber":55,"author":{"gitId":"VladKozyr"},"content":"        CourseEntity result \u003d courseService.updateCourse(\"1\", course);"},{"lineNumber":56,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":57,"author":{"gitId":"VladKozyr"},"content":"        verify(courseRepository, times(1)).save(any());"},{"lineNumber":58,"author":{"gitId":"VladKozyr"},"content":"        verify(courseRepository, times(1)).findById(any());"},{"lineNumber":59,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":60,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(result.getTitle(), course.getTitle());"},{"lineNumber":61,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(result.getDescription(), course.getDescription());"},{"lineNumber":62,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":63,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":64,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":65,"author":{"gitId":"VladKozyr"},"content":"    void shouldThrowIncorrectIdExceptionOnUpdate() {"},{"lineNumber":66,"author":{"gitId":"VladKozyr"},"content":"        when(courseRepository.save(any()))"},{"lineNumber":67,"author":{"gitId":"VladKozyr"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":68,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":69,"author":{"gitId":"VladKozyr"},"content":"        when(courseRepository.findById(any()))"},{"lineNumber":70,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.empty());"},{"lineNumber":71,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":72,"author":{"gitId":"VladKozyr"},"content":"        CourseDto course \u003d new CourseDto(\"title\", \"description\");"},{"lineNumber":73,"author":{"gitId":"VladKozyr"},"content":"        assertThrows(IncorrectIdException.class, () -\u003e courseService.updateCourse(\"1\", course));"},{"lineNumber":74,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":75,"author":{"gitId":"VladKozyr"},"content":"        verify(courseRepository, times(1)).findById(any());"},{"lineNumber":76,"author":{"gitId":"VladKozyr"},"content":"        verify(courseRepository, times(0)).save(any());"},{"lineNumber":77,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":78,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":79,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":80,"author":{"gitId":"VladKozyr"},"content":"    void shouldReturnAllCourses() {"},{"lineNumber":81,"author":{"gitId":"VladKozyr"},"content":"        List\u003cCourseEntity\u003e courses \u003d new ArrayList\u003c\u003e();"},{"lineNumber":82,"author":{"gitId":"Danylo Makarenko"},"content":"        courses.add(new CourseEntity(\"1\", \"title\", \"description\", new ArrayList\u003c\u003e()));"},{"lineNumber":83,"author":{"gitId":"Danylo Makarenko"},"content":"        courses.add(new CourseEntity(\"2\", \"title\", \"description\", new ArrayList\u003c\u003e()));"},{"lineNumber":84,"author":{"gitId":"Danylo Makarenko"},"content":"        courses.add(new CourseEntity(\"3\", \"title\", \"description\", new ArrayList\u003c\u003e()));"},{"lineNumber":85,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":86,"author":{"gitId":"VladKozyr"},"content":"        when(courseRepository.findAll())"},{"lineNumber":87,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(courses);"},{"lineNumber":88,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":89,"author":{"gitId":"VladKozyr"},"content":"        List\u003cCourseEntity\u003e resultCourses \u003d courseService.getCourses();"},{"lineNumber":90,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":91,"author":{"gitId":"VladKozyr"},"content":"        assertIterableEquals(resultCourses, courses);"},{"lineNumber":92,"author":{"gitId":"VladKozyr"},"content":"        verify(courseRepository, times(1)).findAll();"},{"lineNumber":93,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":94,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":95,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":96,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldThrowIncorrectIdExceptionOnAddCourseProjects() {"},{"lineNumber":97,"author":{"gitId":"Danylo Makarenko"},"content":"        when(courseRepository.findById(any()))"},{"lineNumber":98,"author":{"gitId":"Danylo Makarenko"},"content":"                .thenReturn(Optional.empty());"},{"lineNumber":99,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":100,"author":{"gitId":"Danylo Makarenko"},"content":"        assertThrows(IncorrectIdException.class, () -\u003e courseService.addCourseProjects(\"1\", new ArrayList\u003c\u003e()));"},{"lineNumber":101,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":102,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(courseRepository, times(1)).findById(any());"},{"lineNumber":103,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(courseRepository, times(0)).save(any());"},{"lineNumber":104,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":105,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":106,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":107,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldAddCourseProjects() throws IncorrectIdException {"},{"lineNumber":108,"author":{"gitId":"Danylo Makarenko"},"content":"        List\u003cCourseProjectDto\u003e courseProjectDtoList \u003d new ArrayList\u003c\u003e();"},{"lineNumber":109,"author":{"gitId":"Danylo Makarenko"},"content":"        courseProjectDtoList.add(new CourseProjectDto(\"1\", \"2\", \"3\", \"12:20\"));"},{"lineNumber":110,"author":{"gitId":"Danylo Makarenko"},"content":"        courseProjectDtoList.add(new CourseProjectDto(\"1\", \"2\", \"3\", \"12:20\"));"},{"lineNumber":111,"author":{"gitId":"Danylo Makarenko"},"content":"        courseProjectDtoList.add(new CourseProjectDto(\"1\", \"2\", \"3\", \"12:20\"));"},{"lineNumber":112,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":113,"author":{"gitId":"Danylo Makarenko"},"content":"        CourseEntity courseEntity \u003d new CourseEntity(\"1\", \"title\", \"description\", new ArrayList\u003c\u003e());"},{"lineNumber":114,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":115,"author":{"gitId":"Danylo Makarenko"},"content":"        when(courseRepository.save(any()))"},{"lineNumber":116,"author":{"gitId":"Danylo Makarenko"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":117,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":118,"author":{"gitId":"Danylo Makarenko"},"content":"        when(courseRepository.findById(any()))"},{"lineNumber":119,"author":{"gitId":"Danylo Makarenko"},"content":"                .thenReturn(Optional.of(courseEntity));"},{"lineNumber":120,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":121,"author":{"gitId":"Danylo Makarenko"},"content":"        CourseEntity resultCourse \u003d courseService.addCourseProjects(\"1\", courseProjectDtoList);"},{"lineNumber":122,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":123,"author":{"gitId":"Danylo Makarenko"},"content":"        IntStream.range(0, courseProjectDtoList.size())"},{"lineNumber":124,"author":{"gitId":"Danylo Makarenko"},"content":"                .forEach(i -\u003e {"},{"lineNumber":125,"author":{"gitId":"Danylo Makarenko"},"content":"                    CourseProjectEntity entity \u003d resultCourse.getProjects().get(i);"},{"lineNumber":126,"author":{"gitId":"Danylo Makarenko"},"content":"                    CourseProjectDto dto \u003d courseProjectDtoList.get(i);"},{"lineNumber":127,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":128,"author":{"gitId":"Danylo Makarenko"},"content":"                    assertTrue(entity.getTitle().equals(dto.getTitle())"},{"lineNumber":129,"author":{"gitId":"Danylo Makarenko"},"content":"                            \u0026\u0026 entity.getDescription().equals(dto.getDescription())"},{"lineNumber":130,"author":{"gitId":"Danylo Makarenko"},"content":"                            \u0026\u0026 entity.getRequirements().equals(dto.getRequirements())"},{"lineNumber":131,"author":{"gitId":"Danylo Makarenko"},"content":"                            \u0026\u0026 entity.getTime().equals(dto.getTime())"},{"lineNumber":132,"author":{"gitId":"Danylo Makarenko"},"content":"                    );"},{"lineNumber":133,"author":{"gitId":"Danylo Makarenko"},"content":"                });"},{"lineNumber":134,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":135,"author":{"gitId":"Danylo Makarenko"},"content":"        assertEquals(resultCourse.getProjects().size(), courseProjectDtoList.size());"},{"lineNumber":136,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(courseRepository, times(1)).findById(any());"},{"lineNumber":137,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":138,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":139,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":140,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldGetCourseById() throws IncorrectIdException {"},{"lineNumber":141,"author":{"gitId":"Danylo Makarenko"},"content":"        when(courseRepository.findById(any()))"},{"lineNumber":142,"author":{"gitId":"Danylo Makarenko"},"content":"                .thenReturn(Optional.of(new CourseEntity(\"id\", \"title\", \"desc\", new ArrayList\u003c\u003e())));"},{"lineNumber":143,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":144,"author":{"gitId":"Danylo Makarenko"},"content":"        courseService.getCourse(\"id\");"},{"lineNumber":145,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":146,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(courseRepository, times(1)).findById(any());"},{"lineNumber":147,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":148,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":149,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":150,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldThrowExceptionOnIncorrectId() {"},{"lineNumber":151,"author":{"gitId":"Danylo Makarenko"},"content":"        when(courseRepository.findById(any()))"},{"lineNumber":152,"author":{"gitId":"Danylo Makarenko"},"content":"                .thenReturn(Optional.empty());"},{"lineNumber":153,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":154,"author":{"gitId":"Danylo Makarenko"},"content":"        assertThrows(IncorrectIdException.class, () -\u003e courseService.getCourse(\"id\"));"},{"lineNumber":155,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":156,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(courseRepository, times(1)).findById(any());"},{"lineNumber":157,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":158,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":87,"Danylo Makarenko":71}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/service/SessionServiceTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"VladKozyr"},"content":"package edu.kmaooad.service;"},{"lineNumber":2,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":3,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.session.UserSession;"},{"lineNumber":4,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.core.state.State;"},{"lineNumber":5,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.exception.IncorrectIdException;"},{"lineNumber":6,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.model.SessionEntity;"},{"lineNumber":7,"author":{"gitId":"VladKozyr"},"content":"import edu.kmaooad.repository.SessionRepository;"},{"lineNumber":8,"author":{"gitId":"VladKozyr"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":9,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":10,"author":{"gitId":"VladKozyr"},"content":"import java.util.HashMap;"},{"lineNumber":11,"author":{"gitId":"VladKozyr"},"content":"import java.util.Map;"},{"lineNumber":12,"author":{"gitId":"VladKozyr"},"content":"import java.util.Optional;"},{"lineNumber":13,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":14,"author":{"gitId":"VladKozyr"},"content":"import static org.junit.jupiter.api.Assertions.*;"},{"lineNumber":15,"author":{"gitId":"VladKozyr"},"content":"import static org.mockito.ArgumentMatchers.any;"},{"lineNumber":16,"author":{"gitId":"VladKozyr"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":17,"author":{"gitId":"VladKozyr"},"content":"import static org.mockito.Mockito.times;"},{"lineNumber":18,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":19,"author":{"gitId":"VladKozyr"},"content":"public class SessionServiceTest {"},{"lineNumber":20,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":21,"author":{"gitId":"VladKozyr"},"content":"    private final SessionRepository sessionRepository \u003d mock(SessionRepository.class);"},{"lineNumber":22,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":23,"author":{"gitId":"VladKozyr"},"content":"    private final SessionService sessionService \u003d new SessionService(sessionRepository);"},{"lineNumber":24,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":25,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":26,"author":{"gitId":"VladKozyr"},"content":"    void shouldGetSessionById() {"},{"lineNumber":27,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity session \u003d new SessionEntity(1L, \"state\", new HashMap\u003c\u003e());"},{"lineNumber":28,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.findById(any()))"},{"lineNumber":29,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.of(session));"},{"lineNumber":30,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":31,"author":{"gitId":"VladKozyr"},"content":"        Optional\u003cUserSession\u003e result \u003d sessionService.getSessionByUserId(1L);"},{"lineNumber":32,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":33,"author":{"gitId":"VladKozyr"},"content":"        assertTrue(result.isPresent());"},{"lineNumber":34,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).findById(any());"},{"lineNumber":35,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(result.get().id(), session.getUserId());"},{"lineNumber":36,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(result.get().currentState(), session.getState());"},{"lineNumber":37,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(result.get().statesPayload(), session.getPayload());"},{"lineNumber":38,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":39,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":40,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":41,"author":{"gitId":"VladKozyr"},"content":"    void shouldReturnEmptyOptionalWhenNoSession() {"},{"lineNumber":42,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.findById(any()))"},{"lineNumber":43,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.empty());"},{"lineNumber":44,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":45,"author":{"gitId":"VladKozyr"},"content":"        Optional\u003cUserSession\u003e result \u003d sessionService.getSessionByUserId(1L);"},{"lineNumber":46,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":47,"author":{"gitId":"VladKozyr"},"content":"        assertTrue(result.isEmpty());"},{"lineNumber":48,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).findById(any());"},{"lineNumber":49,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":50,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":51,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":52,"author":{"gitId":"VladKozyr"},"content":"    void shouldCreateEmptySession() throws IncorrectIdException {"},{"lineNumber":53,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity session \u003d new SessionEntity(1L, \"state\", new HashMap\u003c\u003e());"},{"lineNumber":54,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":55,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.findById(any()))"},{"lineNumber":56,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.empty());"},{"lineNumber":57,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.save(any()))"},{"lineNumber":58,"author":{"gitId":"VladKozyr"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":59,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":60,"author":{"gitId":"VladKozyr"},"content":"        UserSession result \u003d sessionService.createSessionByUserId(1L);"},{"lineNumber":61,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":62,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).findById(any());"},{"lineNumber":63,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).save(any());"},{"lineNumber":64,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":65,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(result.id(), session.getUserId());"},{"lineNumber":66,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(result.currentState(), new State.Any().key());"},{"lineNumber":67,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(result.statesPayload(), new HashMap\u003c\u003e());"},{"lineNumber":68,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":69,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":70,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":71,"author":{"gitId":"VladKozyr"},"content":"    void shouldThrowExceptionForExistingSession() {"},{"lineNumber":72,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.findById(any()))"},{"lineNumber":73,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.of(new SessionEntity(1L, \"state\", new HashMap\u003c\u003e())));"},{"lineNumber":74,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.save(any()))"},{"lineNumber":75,"author":{"gitId":"VladKozyr"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":76,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":77,"author":{"gitId":"VladKozyr"},"content":"        assertThrows(IncorrectIdException.class, () -\u003e sessionService.createSessionByUserId(1L));"},{"lineNumber":78,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":79,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).findById(any());"},{"lineNumber":80,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(0)).save(any());"},{"lineNumber":81,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":82,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":83,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":84,"author":{"gitId":"VladKozyr"},"content":"    void shouldClearExistingSession() throws IncorrectIdException {"},{"lineNumber":85,"author":{"gitId":"VladKozyr"},"content":"        Map\u003cString, String\u003e payloadMap \u003d new HashMap\u003c\u003e();"},{"lineNumber":86,"author":{"gitId":"VladKozyr"},"content":"        payloadMap.put(\"key\", \"value\");"},{"lineNumber":87,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity session \u003d new SessionEntity(1L, \"state\", payloadMap);"},{"lineNumber":88,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":89,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.findById(any()))"},{"lineNumber":90,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.of(session));"},{"lineNumber":91,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.save(any()))"},{"lineNumber":92,"author":{"gitId":"VladKozyr"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":93,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":94,"author":{"gitId":"VladKozyr"},"content":"        UserSession result \u003d sessionService.clearSessionByUserId(1L);"},{"lineNumber":95,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":96,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).findById(any());"},{"lineNumber":97,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).save(any());"},{"lineNumber":98,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":99,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(session.getUserId(), result.id());"},{"lineNumber":100,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(new State.Any().key(), result.currentState());"},{"lineNumber":101,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(new HashMap\u003c\u003e(), result.statesPayload());"},{"lineNumber":102,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":103,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":104,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":105,"author":{"gitId":"VladKozyr"},"content":"    void shouldThrowExceptionOnClearNoSession() {"},{"lineNumber":106,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.findById(any()))"},{"lineNumber":107,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.empty());"},{"lineNumber":108,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.save(any()))"},{"lineNumber":109,"author":{"gitId":"VladKozyr"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":110,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":111,"author":{"gitId":"VladKozyr"},"content":"        assertThrows(IncorrectIdException.class, () -\u003e sessionService.clearSessionByUserId(1L));"},{"lineNumber":112,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":113,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).findById(any());"},{"lineNumber":114,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(0)).save(any());"},{"lineNumber":115,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":116,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":117,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":118,"author":{"gitId":"VladKozyr"},"content":"    void shouldUpdateSessionState() throws IncorrectIdException {"},{"lineNumber":119,"author":{"gitId":"VladKozyr"},"content":"        Map\u003cString, String\u003e payloadMap \u003d new HashMap\u003c\u003e();"},{"lineNumber":120,"author":{"gitId":"VladKozyr"},"content":"        payloadMap.put(\"key\", \"value\");"},{"lineNumber":121,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity session \u003d new SessionEntity(1L, \"state\", payloadMap);"},{"lineNumber":122,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":123,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.findById(any()))"},{"lineNumber":124,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.of(session));"},{"lineNumber":125,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.save(any()))"},{"lineNumber":126,"author":{"gitId":"VladKozyr"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":127,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":128,"author":{"gitId":"VladKozyr"},"content":"        UserSession result \u003d sessionService.updateSessionState(1L, new State.Any());"},{"lineNumber":129,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":130,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).findById(any());"},{"lineNumber":131,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).save(any());"},{"lineNumber":132,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":133,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(session.getUserId(), result.id());"},{"lineNumber":134,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(new State.Any().key(), result.currentState());"},{"lineNumber":135,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(session.getPayload(), result.statesPayload());"},{"lineNumber":136,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":137,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":138,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":139,"author":{"gitId":"VladKozyr"},"content":"    void shouldThrowExceptionOnUpdateSessionState() {"},{"lineNumber":140,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.findById(any()))"},{"lineNumber":141,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.empty());"},{"lineNumber":142,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.save(any()))"},{"lineNumber":143,"author":{"gitId":"VladKozyr"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":144,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":145,"author":{"gitId":"VladKozyr"},"content":"        assertThrows(IncorrectIdException.class, () -\u003e sessionService.updateSessionState(1L, new State.Any()));"},{"lineNumber":146,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":147,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).findById(any());"},{"lineNumber":148,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(0)).save(any());"},{"lineNumber":149,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":150,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":151,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":152,"author":{"gitId":"VladKozyr"},"content":"    void shouldUpdateSessionPayloadForExistingKey() throws IncorrectIdException {"},{"lineNumber":153,"author":{"gitId":"VladKozyr"},"content":"        Map\u003cString, String\u003e payloadMap \u003d new HashMap\u003c\u003e();"},{"lineNumber":154,"author":{"gitId":"VladKozyr"},"content":"        payloadMap.put(\"key\", \"value\");"},{"lineNumber":155,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity session \u003d new SessionEntity(1L, \"state\", payloadMap);"},{"lineNumber":156,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":157,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.findById(any()))"},{"lineNumber":158,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.of(session));"},{"lineNumber":159,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.save(any()))"},{"lineNumber":160,"author":{"gitId":"VladKozyr"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":161,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":162,"author":{"gitId":"VladKozyr"},"content":"        UserSession result \u003d sessionService.updateGroupStatePayload(1L, group, \"new_state\");"},{"lineNumber":163,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":164,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).findById(any());"},{"lineNumber":165,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).save(any());"},{"lineNumber":166,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":167,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(session.getUserId(), result.id());"},{"lineNumber":168,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(session.getState(), result.currentState());"},{"lineNumber":169,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(\"new_state\", result.statesPayload().get(\"key\"));"},{"lineNumber":170,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":171,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":172,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":173,"author":{"gitId":"VladKozyr"},"content":"    void shouldUpdateSessionPayloadForNonExistingKey() throws IncorrectIdException {"},{"lineNumber":174,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity session \u003d new SessionEntity(1L, \"state\", new HashMap\u003c\u003e());"},{"lineNumber":175,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":176,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.findById(any()))"},{"lineNumber":177,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.of(session));"},{"lineNumber":178,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.save(any()))"},{"lineNumber":179,"author":{"gitId":"VladKozyr"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":180,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":181,"author":{"gitId":"VladKozyr"},"content":"        UserSession result \u003d sessionService.updateGroupStatePayload(1L, group, \"new_state\");"},{"lineNumber":182,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":183,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).findById(any());"},{"lineNumber":184,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).save(any());"},{"lineNumber":185,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":186,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(session.getUserId(), result.id());"},{"lineNumber":187,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(session.getState(), result.currentState());"},{"lineNumber":188,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(\"new_state\", result.statesPayload().get(\"key\"));"},{"lineNumber":189,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":190,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":191,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":192,"author":{"gitId":"VladKozyr"},"content":"    void shouldThrowExceptionOnUpdateSessionPayload() {"},{"lineNumber":193,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.findById(any()))"},{"lineNumber":194,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.empty());"},{"lineNumber":195,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.save(any()))"},{"lineNumber":196,"author":{"gitId":"VladKozyr"},"content":"                .then(invocationOnMock -\u003e invocationOnMock.getArgument(0));"},{"lineNumber":197,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":198,"author":{"gitId":"VladKozyr"},"content":"        assertThrows(IncorrectIdException.class, () -\u003e sessionService.updateGroupStatePayload(1L, group, \"new_state\"));"},{"lineNumber":199,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":200,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).findById(any());"},{"lineNumber":201,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(0)).save(any());"},{"lineNumber":202,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":203,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":204,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":205,"author":{"gitId":"VladKozyr"},"content":"    void shouldReturnNullSessionPayload() throws IncorrectIdException {"},{"lineNumber":206,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity session \u003d new SessionEntity(1L, \"state\", new HashMap\u003c\u003e());"},{"lineNumber":207,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":208,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.findById(any()))"},{"lineNumber":209,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.of(session));"},{"lineNumber":210,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":211,"author":{"gitId":"VladKozyr"},"content":"        String result \u003d sessionService.getGroupStatePayload(1L, group);"},{"lineNumber":212,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":213,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).findById(any());"},{"lineNumber":214,"author":{"gitId":"VladKozyr"},"content":"        assertNull(result);"},{"lineNumber":215,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":216,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":217,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":218,"author":{"gitId":"VladKozyr"},"content":"    void shouldReturnSessionPayload() throws IncorrectIdException {"},{"lineNumber":219,"author":{"gitId":"VladKozyr"},"content":"        Map\u003cString, String\u003e payloadMap \u003d new HashMap\u003c\u003e();"},{"lineNumber":220,"author":{"gitId":"VladKozyr"},"content":"        payloadMap.put(\"key\", \"value\");"},{"lineNumber":221,"author":{"gitId":"VladKozyr"},"content":"        SessionEntity session \u003d new SessionEntity(1L, \"state\", payloadMap);"},{"lineNumber":222,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":223,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.findById(any()))"},{"lineNumber":224,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.of(session));"},{"lineNumber":225,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":226,"author":{"gitId":"VladKozyr"},"content":"        String result \u003d sessionService.getGroupStatePayload(1L, group);"},{"lineNumber":227,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":228,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).findById(any());"},{"lineNumber":229,"author":{"gitId":"VladKozyr"},"content":"        assertEquals(\"value\", result);"},{"lineNumber":230,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":231,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":232,"author":{"gitId":"VladKozyr"},"content":"    @Test"},{"lineNumber":233,"author":{"gitId":"VladKozyr"},"content":"    void shouldThrowExceptionOnGetSessionPayload() {"},{"lineNumber":234,"author":{"gitId":"VladKozyr"},"content":"        when(sessionRepository.findById(any()))"},{"lineNumber":235,"author":{"gitId":"VladKozyr"},"content":"                .thenReturn(Optional.empty());"},{"lineNumber":236,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":237,"author":{"gitId":"VladKozyr"},"content":"        assertThrows(IncorrectIdException.class, () -\u003e sessionService.getGroupStatePayload(1L, group));"},{"lineNumber":238,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":239,"author":{"gitId":"VladKozyr"},"content":"        verify(sessionRepository, times(1)).findById(any());"},{"lineNumber":240,"author":{"gitId":"VladKozyr"},"content":"    }"},{"lineNumber":241,"author":{"gitId":"VladKozyr"},"content":""},{"lineNumber":242,"author":{"gitId":"VladKozyr"},"content":"    private final State.Group group \u003d new State.Group() {"},{"lineNumber":243,"author":{"gitId":"VladKozyr"},"content":"        @Override"},{"lineNumber":244,"author":{"gitId":"VladKozyr"},"content":"        public String group() {"},{"lineNumber":245,"author":{"gitId":"VladKozyr"},"content":"            return \"key\";"},{"lineNumber":246,"author":{"gitId":"VladKozyr"},"content":"        }"},{"lineNumber":247,"author":{"gitId":"VladKozyr"},"content":"    };"},{"lineNumber":248,"author":{"gitId":"VladKozyr"},"content":"}"}],"authorContributionMap":{"VladKozyr":248}},{"path":"kmaooad-functions/src/test/java/edu/kmaooad/service/TelegramServiceTest.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"Danylo Makarenko"},"content":"package edu.kmaooad.service;"},{"lineNumber":2,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":3,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.telegram.TelegramApi;"},{"lineNumber":4,"author":{"gitId":"Danylo Makarenko"},"content":"import edu.kmaooad.telegram.TelegramService;"},{"lineNumber":5,"author":{"gitId":"Danylo Makarenko"},"content":"import org.junit.jupiter.api.Test;"},{"lineNumber":6,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.methods.GetFile;"},{"lineNumber":7,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.methods.send.SendMessage;"},{"lineNumber":8,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.File;"},{"lineNumber":9,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.api.objects.replykeyboard.ReplyKeyboardMarkup;"},{"lineNumber":10,"author":{"gitId":"Danylo Makarenko"},"content":"import org.telegram.telegrambots.meta.exceptions.TelegramApiException;"},{"lineNumber":11,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":12,"author":{"gitId":"Danylo Makarenko"},"content":"import static org.junit.jupiter.api.Assertions.assertThrows;"},{"lineNumber":13,"author":{"gitId":"Danylo Makarenko"},"content":"import static org.mockito.Mockito.*;"},{"lineNumber":14,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":15,"author":{"gitId":"Danylo Makarenko"},"content":"public class TelegramServiceTest {"},{"lineNumber":16,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":17,"author":{"gitId":"Danylo Makarenko"},"content":"    private final TelegramApi telegramApi \u003d mock(TelegramApi.class);"},{"lineNumber":18,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":19,"author":{"gitId":"Danylo Makarenko"},"content":"    private final TelegramService telegramService \u003d new TelegramService(telegramApi);"},{"lineNumber":20,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":21,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":22,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldExecuteOnMessageSend() throws TelegramApiException {"},{"lineNumber":23,"author":{"gitId":"Danylo Makarenko"},"content":"        telegramService.sendMessage(1L, \"text\");"},{"lineNumber":24,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(telegramApi, times(1)).execute(any(SendMessage.class));"},{"lineNumber":25,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":26,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":27,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":28,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldThrowExceptionOnDownloadFile() throws TelegramApiException {"},{"lineNumber":29,"author":{"gitId":"Danylo Makarenko"},"content":"        when(telegramApi.getBotToken())"},{"lineNumber":30,"author":{"gitId":"Danylo Makarenko"},"content":"                .thenReturn(\"token\");"},{"lineNumber":31,"author":{"gitId":"Danylo Makarenko"},"content":"        assertThrows(RuntimeException.class, () -\u003e telegramService.downloadFile(new File(), \"text\"));"},{"lineNumber":32,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(telegramApi, times(0)).execute(any(SendMessage.class));"},{"lineNumber":33,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":34,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":35,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":36,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldExecuteOnMessageWithKeyboardSend() throws TelegramApiException {"},{"lineNumber":37,"author":{"gitId":"Danylo Makarenko"},"content":"        telegramService.sendMessage(1L, \"text\", new ReplyKeyboardMarkup());"},{"lineNumber":38,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(telegramApi, times(1)).execute(any(SendMessage.class));"},{"lineNumber":39,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":40,"author":{"gitId":"Danylo Makarenko"},"content":""},{"lineNumber":41,"author":{"gitId":"Danylo Makarenko"},"content":"    @Test"},{"lineNumber":42,"author":{"gitId":"Danylo Makarenko"},"content":"    void shouldExecuteOnGetFile() throws TelegramApiException {"},{"lineNumber":43,"author":{"gitId":"Danylo Makarenko"},"content":"        telegramService.getFile(new GetFile());"},{"lineNumber":44,"author":{"gitId":"Danylo Makarenko"},"content":"        verify(telegramApi, times(1)).execute(any(GetFile.class));"},{"lineNumber":45,"author":{"gitId":"Danylo Makarenko"},"content":"    }"},{"lineNumber":46,"author":{"gitId":"Danylo Makarenko"},"content":"}"}],"authorContributionMap":{"Danylo Makarenko":46}},{"path":"kmaooad-functions/src/test/resources/files/course_projects.csv","fileType":"csv","lines":[{"lineNumber":1,"author":{"gitId":"Danylo Makarenko"},"content":"title,description,requirements,time"},{"lineNumber":2,"author":{"gitId":"Danylo Makarenko"},"content":"\"Telegram bot\",\"Simple telegram bot based on lambda function\",\"Implement several features\",\"12.23.2022 23:59\""}],"authorContributionMap":{"Danylo Makarenko":2}},{"path":"kmaooad-functions/src/test/resources/files/courses.csv","fileType":"csv","lines":[{"lineNumber":1,"author":{"gitId":"Danylo Makarenko"},"content":"title,description"},{"lineNumber":2,"author":{"gitId":"Danylo Makarenko"},"content":"\"Course 1\",\"Description\""},{"lineNumber":3,"author":{"gitId":"Danylo Makarenko"},"content":"\"Course 2\",\"Description2\""}],"authorContributionMap":{"Danylo Makarenko":3}},{"path":"kmaooad-functions/src/test/resources/files/courses_incorrect.csv","fileType":"csv","lines":[{"lineNumber":1,"author":{"gitId":"Danylo Makarenko"},"content":"title1,description_awdawd"},{"lineNumber":2,"author":{"gitId":"Danylo Makarenko"},"content":"Course 1,Description"},{"lineNumber":3,"author":{"gitId":"Danylo Makarenko"},"content":"Course 2,Description2"}],"authorContributionMap":{"Danylo Makarenko":3}}]
